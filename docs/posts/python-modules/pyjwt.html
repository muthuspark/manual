<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Muthukrishnan">

<title>pyjwt - Documentation – Technical Manuals</title>
<style>
html {
  color: #1a1a1a;
  background-color: #fdfdfd;
}
body {
  margin: 0 auto;
  max-width: 36em;
  padding-left: 50px;
  padding-right: 50px;
  padding-top: 50px;
  padding-bottom: 50px;
  hyphens: auto;
  overflow-wrap: break-word;
  text-rendering: optimizeLegibility;
  font-kerning: normal;
}
@media (max-width: 600px) {
  body {
    font-size: 0.9em;
    padding: 12px;
  }
  h1 {
    font-size: 1.8em;
  }
}
@media print {
  html {
    background-color: white;
  }
  body {
    background-color: transparent;
    color: black;
    font-size: 12pt;
  }
  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }
  h2, h3, h4 {
    page-break-after: avoid;
  }
}
p {
  margin: 1em 0;
}
a {
  color: #1a1a1a;
}
a:visited {
  color: #1a1a1a;
}
img {
  max-width: 100%;
}
svg {
  height; auto;
  max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
  margin-top: 1.4em;
}
h5, h6 {
  font-size: 1em;
  font-style: italic;
}
h6 {
  font-weight: normal;
}
ol, ul {
  padding-left: 1.7em;
  margin-top: 1em;
}
li > ol, li > ul {
  margin-top: 0;
}
ul > li:not(:has(> p)) > ul,
ol > li:not(:has(> p)) > ul,
ul > li:not(:has(> p)) > ol,
ol > li:not(:has(> p)) > ol {
  margin-bottom: 0;
}
ul > li:not(:has(> p)) > ul > li:has(> p),
ol > li:not(:has(> p)) > ul > li:has(> p),
ul > li:not(:has(> p)) > ol > li:has(> p),
ol > li:not(:has(> p)) > ol > li:has(> p) {
  margin-top: 1rem;
}
blockquote {
  margin: 1em 0 1em 1.7em;
  padding-left: 1em;
  border-left: 2px solid #e6e6e6;
  color: #606060;
}
code {
  font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
  font-size: 85%;
  margin: 0;
  hyphens: manual;
}
pre {
  margin: 1em 0;
  overflow: auto;
}
pre code {
  padding: 0;
  overflow: visible;
  overflow-wrap: normal;
}
.sourceCode {
 background-color: transparent;
 overflow: visible;
}
hr {
  background-color: #1a1a1a;
  border: none;
  height: 1px;
  margin: 1em 0;
}
table {
  margin: 1em 0;
  border-collapse: collapse;
  width: 100%;
  overflow-x: auto;
  display: block;
  font-variant-numeric: lining-nums tabular-nums;
}
table caption {
  margin-bottom: 0.75em;
}
tbody {
  margin-top: 0.5em;
  border-top: 1px solid #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
}
th {
  border-top: 1px solid #1a1a1a;
  padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
  padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
  margin-bottom: 4em;
  text-align: center;
}
#TOC li {
  list-style: none;
}
#TOC ul {
  padding-left: 1.3em;
}
#TOC > ul {
  padding-left: 0;
}
#TOC a:not(:hover) {
  text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<link href="../../favicon.ico" rel="icon">
<script async="" src="https://www.googletagmanager.com/gtag/js?id="></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '', { 'anonymize_ip': true});
</script>
<link rel="icon" type="image/x-icon" href="../../favicon.ico">
<meta property="og:title" content="pyjwt - Documentation – Technical Manuals">
<meta property="og:site_name" content="Technical Manuals">
</head><body><div class="navigation-header">
    <nav>
        <div>
            <div class="logo">
                <a href="../../" aria-label="Home">
                    <span>Technical Manuals - Home</span>
                </a>
            </div>
            <div class="nav-menu">
                <ul>
                    <li>
                        <a href="../../about.html">
                            <span class="menu-text">About</span>
                        </a>
                    </li>
                    <li> 
                        <a href="https://github.com/muthuspark" target="_blank">
                            <span class="menu-text">Github</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/krimuthu" target="_blank">
                            <span class="menu-text">Linkedin</span>
                        </a>
                    </li>
                    <li>
                        <button onclick="window.print()" class="print-button">
                            <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M6 9V2h12v7"></path>
                              <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
                              <path d="M6 14h12v8H6z"></path>
                            </svg>
                            Print Page
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>


<link rel="stylesheet" href="../../styles.css">





<header id="title-block-header">
<h1 class="title">pyjwt - Documentation</h1>

</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-pyjwt" id="toc-what-is-pyjwt">What is PyJWT?</a></li>
  <li><a href="#why-use-pyjwt" id="toc-why-use-pyjwt">Why use PyJWT?</a></li>
  <li><a href="#installation-and-setup" id="toc-installation-and-setup">Installation and Setup</a></li>
  <li><a href="#basic-usage-example" id="toc-basic-usage-example">Basic Usage Example</a></li>
  <li><a href="#encoding-json-web-tokens-jwts" id="toc-encoding-json-web-tokens-jwts">Encoding JSON Web Tokens (JWTs)</a>
  <ul>
  <li><a href="#understanding-jwt-structure" id="toc-understanding-jwt-structure">Understanding JWT Structure</a></li>
  <li><a href="#header-parameters" id="toc-header-parameters">Header Parameters</a></li>
  <li><a href="#payload-claims" id="toc-payload-claims">Payload Claims</a></li>
  <li><a href="#signature-algorithm-selection" id="toc-signature-algorithm-selection">Signature Algorithm Selection</a></li>
  <li><a href="#example-encoding-a-jwt-with-hs256" id="toc-example-encoding-a-jwt-with-hs256">Example: Encoding a JWT with HS256</a></li>
  <li><a href="#example-encoding-a-jwt-with-rs256" id="toc-example-encoding-a-jwt-with-rs256">Example: Encoding a JWT with RS256</a></li>
  <li><a href="#example-encoding-a-jwt-with-es256" id="toc-example-encoding-a-jwt-with-es256">Example: Encoding a JWT with ES256</a></li>
  </ul></li>
  <li><a href="#decoding-json-web-tokens-jwts" id="toc-decoding-json-web-tokens-jwts">Decoding JSON Web Tokens (JWTs)</a>
  <ul>
  <li><a href="#decoding-process" id="toc-decoding-process">Decoding Process</a></li>
  <li><a href="#verification-of-signature" id="toc-verification-of-signature">Verification of Signature</a></li>
  <li><a href="#handling-signature-verification-errors" id="toc-handling-signature-verification-errors">Handling Signature Verification Errors</a></li>
  <li><a href="#extracting-payload-claims" id="toc-extracting-payload-claims">Extracting Payload Claims</a></li>
  <li><a href="#example-decoding-a-jwt-with-hs256" id="toc-example-decoding-a-jwt-with-hs256">Example: Decoding a JWT with HS256</a></li>
  <li><a href="#example-decoding-a-jwt-with-rs256" id="toc-example-decoding-a-jwt-with-rs256">Example: Decoding a JWT with RS256</a></li>
  <li><a href="#example-decoding-a-jwt-with-es256" id="toc-example-decoding-a-jwt-with-es256">Example: Decoding a JWT with ES256</a></li>
  <li><a href="#dealing-with-expired-tokens" id="toc-dealing-with-expired-tokens">Dealing with Expired Tokens</a></li>
  </ul></li>
  <li><a href="#working-with-keys" id="toc-working-with-keys">Working with Keys</a>
  <ul>
  <li><a href="#symmetric-keys-hs256" id="toc-symmetric-keys-hs256">Symmetric Keys (HS256)</a></li>
  <li><a href="#asymmetric-keys-rs256-es256" id="toc-asymmetric-keys-rs256-es256">Asymmetric Keys (RS256, ES256)</a></li>
  <li><a href="#generating-key-pairs" id="toc-generating-key-pairs">Generating Key Pairs</a></li>
  <li><a href="#storing-and-managing-keys-securely" id="toc-storing-and-managing-keys-securely">Storing and Managing Keys Securely</a></li>
  <li><a href="#key-rotation" id="toc-key-rotation">Key Rotation</a></li>
  </ul></li>
  <li><a href="#advanced-usage" id="toc-advanced-usage">Advanced Usage</a>
  <ul>
  <li><a href="#custom-claims" id="toc-custom-claims">Custom Claims</a></li>
  <li><a href="#algorithm-configuration" id="toc-algorithm-configuration">Algorithm Configuration</a></li>
  <li><a href="#jwt-header-customization" id="toc-jwt-header-customization">JWT Header Customization</a></li>
  <li><a href="#working-with-different-key-formats-pem-jwk" id="toc-working-with-different-key-formats-pem-jwk">Working with Different Key Formats (PEM, JWK)</a></li>
  <li><a href="#using-pyjwt-with-frameworks-e.g.-flask-django" id="toc-using-pyjwt-with-frameworks-e.g.-flask-django">Using PyJWT with Frameworks (e.g., Flask, Django)</a></li>
  <li><a href="#troubleshooting-common-errors" id="toc-troubleshooting-common-errors">Troubleshooting Common Errors</a></li>
  <li><a href="#performance-considerations-and-optimization" id="toc-performance-considerations-and-optimization">Performance Considerations and Optimization</a></li>
  </ul></li>
  <li><a href="#security-best-practices" id="toc-security-best-practices">Security Best Practices</a>
  <ul>
  <li><a href="#secure-key-management" id="toc-secure-key-management">Secure Key Management</a></li>
  <li><a href="#protecting-against-attacks" id="toc-protecting-against-attacks">Protecting Against Attacks</a></li>
  <li><a href="#choosing-appropriate-algorithms" id="toc-choosing-appropriate-algorithms">Choosing Appropriate Algorithms</a></li>
  <li><a href="#regular-updates-and-patches" id="toc-regular-updates-and-patches">Regular Updates and Patches</a></li>
  <li><a href="#input-validation-and-sanitization" id="toc-input-validation-and-sanitization">Input Validation and Sanitization</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix">Appendix</a>
  <ul>
  <li><a href="#supported-algorithms" id="toc-supported-algorithms">Supported Algorithms</a></li>
  <li><a href="#error-codes-and-exceptions" id="toc-error-codes-and-exceptions">Error Codes and Exceptions</a></li>
  <li><a href="#glossary-of-terms" id="toc-glossary-of-terms">Glossary of Terms</a></li>
  <li><a href="#references-and-further-reading" id="toc-references-and-further-reading">References and Further Reading</a></li>
  </ul></li>
  </ul>
</nav>
<h3 id="what-is-pyjwt">What is PyJWT?</h3>
<p>PyJWT is a Python library that implements JSON Web Token (JWT) creation and verification. JWTs are a compact and self-contained way to securely transmit information between parties as a JSON object. PyJWT provides functions for encoding and decoding JWTs, allowing developers to integrate JWT authentication and authorization into their applications. It supports various signing algorithms, ensuring flexibility and security depending on your needs.</p>
<h3 id="why-use-pyjwt">Why use PyJWT?</h3>
<p>PyJWT offers several advantages for handling JWTs in Python applications:</p>
<ul>
<li><strong>Simplicity:</strong> The library provides a clean and straightforward API for both encoding and decoding JWTs, making integration easy.</li>
<li><strong>Security:</strong> PyJWT supports a range of robust signing algorithms, including HMAC and RSA, protecting your data from tampering and unauthorized access. It also provides features to help mitigate vulnerabilities.</li>
<li><strong>Standards Compliance:</strong> PyJWT adheres to the relevant RFC standards for JWT, ensuring interoperability with other systems and libraries.</li>
<li><strong>Flexibility:</strong> It supports various JWT header and payload configurations, allowing you to customize your tokens to suit specific application requirements.</li>
<li><strong>Community Support:</strong> PyJWT is a well-established and widely used library with a supportive community, making it easier to find help and resources.</li>
</ul>
<h3 id="installation-and-setup">Installation and Setup</h3>
<p>PyJWT can be easily installed using pip:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install PyJWT</span></code></pre></div>
<p>No further setup is generally required. However, if you’re using algorithms like RSA, you’ll need to ensure you have the necessary cryptographic libraries installed (usually handled automatically by PyJWT’s dependencies).</p>
<h3 id="basic-usage-example">Basic Usage Example</h3>
<p>This example demonstrates creating and verifying a JWT using the HS256 algorithm:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Secret key – keep this secure!  Never hardcode this in production.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>secret_key <span class="op">=</span> <span class="st">'your-256-bit-secret'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Payload data</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>payload <span class="op">=</span> {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user_id'</span>: <span class="dv">123</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'username'</span>: <span class="st">'johndoe'</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exp'</span>: jwt.time() <span class="op">+</span> <span class="dv">3600</span>  <span class="co"># Token expires in 1 hour</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Encode the JWT</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> jwt.encode(payload, secret_key, algorithm<span class="op">=</span><span class="st">'HS256'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Encoded JWT: </span><span class="sc">{</span>encoded_jwt<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Decode the JWT</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    decoded_payload <span class="op">=</span> jwt.decode(encoded_jwt, secret_key, algorithms<span class="op">=</span>[<span class="st">'HS256'</span>])</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Decoded Payload: </span><span class="sc">{</span>decoded_payload<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.ExpiredSignatureError:</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Signature has expired."</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidTokenError:</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid token."</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"An error occurred: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
<p>Remember to replace <code>"your-256-bit-secret"</code> with a strong, randomly generated secret key. Never commit this key to version control. For production environments, consider using more secure key management practices.</p>
<h2 id="encoding-json-web-tokens-jwts">Encoding JSON Web Tokens (JWTs)</h2>
<h3 id="understanding-jwt-structure">Understanding JWT Structure</h3>
<p>A JSON Web Token (JWT) is a compact, URL-safe method for representing claims to be transferred between parties. It consists of three parts separated by dots (<code>.</code>):</p>
<ol type="1">
<li><strong>Header:</strong> Contains metadata about the token, including the algorithm used for signing.</li>
<li><strong>Payload:</strong> Carries the claims, which are statements about an entity (e.g., user identity).</li>
<li><strong>Signature:</strong> A cryptographically generated string that ensures the token’s integrity and authenticity.</li>
</ol>
<h3 id="header-parameters">Header Parameters</h3>
<p>The JWT header is a JSON object typically containing:</p>
<ul>
<li><code>"alg"</code>: The algorithm used to create the signature (e.g., “HS256”, “RS256”, “ES256”). This is crucial for verification.</li>
<li><code>"typ"</code>: Usually set to <code>"JWT"</code>, indicating the token type. While optional, it’s best practice to include it.</li>
</ul>
<p>Other parameters can be added depending on the specific needs of the application.</p>
<h3 id="payload-claims">Payload Claims</h3>
<p>The JWT payload is a JSON object carrying the claims. These claims can be custom, but some standard claims are commonly used:</p>
<ul>
<li><code>"iss"</code>: Issuer of the token.</li>
<li><code>"sub"</code>: Subject (the entity the token is about).</li>
<li><code>"aud"</code>: Audience(s) the token is intended for.</li>
<li><code>"exp"</code>: Expiration time (Unix timestamp).</li>
<li><code>"nbf"</code>: Not Before (Unix timestamp).</li>
<li><code>"iat"</code>: Issued At (Unix timestamp).</li>
<li><code>"jti"</code>: JWT ID (unique identifier for the token).</li>
</ul>
<h3 id="signature-algorithm-selection">Signature Algorithm Selection</h3>
<p>The choice of signing algorithm significantly impacts the security of your JWTs:</p>
<ul>
<li><strong>HS256 (HMAC SHA256):</strong> Uses a shared secret key. Simpler to implement but requires secure key management. Suitable for less sensitive applications where the client and server share a secret.</li>
<li><strong>RS256 (RSA SHA256):</strong> Uses an RSA private key to sign. More secure as it doesn’t require sharing a secret key. Requires public key infrastructure (PKI). Suitable for situations needing strong security and key separation.</li>
<li><strong>ES256 (ECDSA SHA256):</strong> Uses an Elliptic Curve Digital Signature Algorithm (ECDSA) private key to sign. Offers a good balance of security and performance. Requires PKI.</li>
</ul>
<p>Other algorithms are also supported by PyJWT, but the above are the most common.</p>
<h3 id="example-encoding-a-jwt-with-hs256">Example: Encoding a JWT with HS256</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>secret_key <span class="op">=</span> <span class="st">'your-256-bit-secret'</span>  <span class="co"># MUST be replaced with a strong, randomly generated secret</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>payload <span class="op">=</span> {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user_id'</span>: <span class="dv">123</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'username'</span>: <span class="st">'johndoe'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exp'</span>: jwt.time() <span class="op">+</span> <span class="dv">3600</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> jwt.encode(payload, secret_key, algorithm<span class="op">=</span><span class="st">'HS256'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(encoded_jwt)</span></code></pre></div>
<h3 id="example-encoding-a-jwt-with-rs256">Example: Encoding a JWT with RS256</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.backends <span class="im">import</span> default_backend</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives <span class="im">import</span> serialization</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives.asymmetric <span class="im">import</span> rsa</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an RSA key pair (replace with your existing keys in production!)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>private_key <span class="op">=</span> rsa.generate_private_key(</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    public_exponent<span class="op">=</span><span class="dv">65537</span>, key_size<span class="op">=</span><span class="dv">2048</span>, backend<span class="op">=</span>default_backend()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>private_pem <span class="op">=</span> private_key.private_bytes(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    encoding<span class="op">=</span>serialization.Encoding.PEM,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span>serialization.PrivateFormat.PKCS8,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    encryption_algorithm<span class="op">=</span>serialization.NoEncryption(),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>payload <span class="op">=</span> {</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user_id'</span>: <span class="dv">123</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'username'</span>: <span class="st">'johndoe'</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exp'</span>: jwt.time() <span class="op">+</span> <span class="dv">3600</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> jwt.encode(payload, private_pem, algorithm<span class="op">=</span><span class="st">'RS256'</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(encoded_jwt)</span></code></pre></div>
<h3 id="example-encoding-a-jwt-with-es256">Example: Encoding a JWT with ES256</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.backends <span class="im">import</span> default_backend</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives <span class="im">import</span> serialization</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives.asymmetric <span class="im">import</span> ec</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an EC key pair (replace with your existing keys in production!)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>private_key <span class="op">=</span> ec.generate_private_key(ec.SECP256R1(), default_backend())</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>private_pem <span class="op">=</span> private_key.private_bytes(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    encoding<span class="op">=</span>serialization.Encoding.PEM,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span>serialization.PrivateFormat.PKCS8,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    encryption_algorithm<span class="op">=</span>serialization.NoEncryption(),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>payload <span class="op">=</span> {</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user_id'</span>: <span class="dv">123</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'username'</span>: <span class="st">'johndoe'</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exp'</span>: jwt.time() <span class="op">+</span> <span class="dv">3600</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> jwt.encode(payload, private_pem, algorithm<span class="op">=</span><span class="st">'ES256'</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(encoded_jwt)</span></code></pre></div>
<p><strong>Note:</strong> For RS256 and ES256, replace the key generation with your actual private key loading from a secure location. Never hardcode private keys in your application code. The examples above are for illustrative purposes only. Always use proper key management practices in a production environment.</p>
<h2 id="decoding-json-web-tokens-jwts">Decoding JSON Web Tokens (JWTs)</h2>
<h3 id="decoding-process">Decoding Process</h3>
<p>Decoding a JWT involves three main steps:</p>
<ol type="1">
<li><strong>Splitting the Token:</strong> The JWT string is split into its three parts (header, payload, signature) using the dot (<code>.</code>) as a delimiter.</li>
<li><strong>Verifying the Signature:</strong> The signature is verified using the provided key and algorithm specified in the header. This step ensures the token’s integrity and authenticity; that it hasn’t been tampered with.</li>
<li><strong>Decoding the Payload:</strong> If the signature is valid, the payload (the JSON data) is decoded and returned.</li>
</ol>
<h3 id="verification-of-signature">Verification of Signature</h3>
<p>Signature verification is crucial to ensure the JWT hasn’t been altered. PyJWT uses the provided key and algorithm to check the signature’s validity. If the verification fails, it indicates the token might be compromised. The <code>jwt.decode()</code> function handles this verification automatically.</p>
<h3 id="handling-signature-verification-errors">Handling Signature Verification Errors</h3>
<p>If the signature verification fails, PyJWT raises a <code>jwt.InvalidSignatureError</code> or a <code>jwt.InvalidTokenError</code>. Your application should handle these exceptions gracefully, typically by rejecting the token and taking appropriate action (e.g., logging the error, redirecting the user to a login page). Consider logging suspicious activity for security auditing.</p>
<h3 id="extracting-payload-claims">Extracting Payload Claims</h3>
<p>Once the signature is verified, the payload, a Python dictionary, is accessible and can be used to extract the claims. These claims contain the information carried by the JWT.</p>
<h3 id="example-decoding-a-jwt-with-hs256">Example: Decoding a JWT with HS256</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>secret_key <span class="op">=</span> <span class="st">'your-256-bit-secret'</span>  <span class="co"># MUST be replaced with the SAME secret key used for encoding</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> <span class="st">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxMjMsInVzZXJuYW1lIjoiam9obmRvZSIsImV4cCI6MTY3ODc2NzQ3MX0.e5h3e5f4gS3G-f4f7gF_a5e_e5f4gS3G-f4f7gF_a5e"</span> <span class="co">#Example JWT, replace with your encoded JWT</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    decoded_payload <span class="op">=</span> jwt.decode(encoded_jwt, secret_key, algorithms<span class="op">=</span>[<span class="st">'HS256'</span>])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(decoded_payload)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.ExpiredSignatureError:</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Signature has expired."</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidTokenError:</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid token."</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidSignatureError:</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid signature."</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"An error occurred: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
<h3 id="example-decoding-a-jwt-with-rs256">Example: Decoding a JWT with RS256</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.backends <span class="im">import</span> default_backend</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives <span class="im">import</span> serialization</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives.asymmetric <span class="im">import</span> rsa</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load your public key (replace with your actual public key loading)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"public_key.pem"</span>, <span class="st">"rb"</span>) <span class="im">as</span> key_file:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    public_key <span class="op">=</span> serialization.load_pem_public_key(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        key_file.read(), backend<span class="op">=</span>default_backend()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> <span class="st">"your_rs256_encoded_jwt"</span> <span class="co">#replace with your RS256 encoded JWT</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    decoded_payload <span class="op">=</span> jwt.decode(encoded_jwt, public_key, algorithms<span class="op">=</span>[<span class="st">'RS256'</span>])</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(decoded_payload)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.ExpiredSignatureError:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Signature has expired."</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidTokenError:</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid token."</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidSignatureError:</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid signature."</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"An error occurred: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
<h3 id="example-decoding-a-jwt-with-es256">Example: Decoding a JWT with ES256</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.backends <span class="im">import</span> default_backend</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives <span class="im">import</span> serialization</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives.asymmetric <span class="im">import</span> ec</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load your public key (replace with your actual public key loading)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"public_key.pem"</span>, <span class="st">"rb"</span>) <span class="im">as</span> key_file:</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    public_key <span class="op">=</span> serialization.load_pem_public_key(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        key_file.read(), backend<span class="op">=</span>default_backend()</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> <span class="st">"your_es256_encoded_jwt"</span> <span class="co">#replace with your ES256 encoded JWT</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    decoded_payload <span class="op">=</span> jwt.decode(encoded_jwt, public_key, algorithms<span class="op">=</span>[<span class="st">'ES256'</span>])</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(decoded_payload)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.ExpiredSignatureError:</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Signature has expired."</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidTokenError:</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid token."</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> jwt.InvalidSignatureError:</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Invalid signature."</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"An error occurred: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
<p>Remember to replace placeholder JWTs and keys with your actual values. For RS256 and ES256, you’ll need the <em>public</em> key corresponding to the private key used for encoding.</p>
<h3 id="dealing-with-expired-tokens">Dealing with Expired Tokens</h3>
<p>JWTs often include an expiration time (<code>exp</code> claim). PyJWT automatically checks this claim during decoding. If the token is expired, it raises a <code>jwt.ExpiredSignatureError</code>. Your application should handle this exception appropriately, typically by rejecting the token and prompting the user to re-authenticate.</p>
<h2 id="working-with-keys">Working with Keys</h2>
<h3 id="symmetric-keys-hs256">Symmetric Keys (HS256)</h3>
<p>For algorithms like HS256 (HMAC SHA256), a <em>symmetric</em> key is used. This means the same secret key is used for both signing (encoding) and verifying (decoding) the JWT. This key <strong>must</strong> be kept absolutely secret and secure. Compromising this key compromises the security of all JWTs signed with it.</p>
<p><strong>Key Requirements:</strong> For HS256, the key should be a 256-bit (or longer) randomly generated string. Never use a weak or predictable key.</p>
<p><strong>Example (Insecure for demonstration only - NEVER use this in production):</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>secret_key <span class="op">=</span> <span class="st">"your-256-bit-secret"</span> <span class="co">#This is INSECURE! Replace with a proper key generation method.</span></span></code></pre></div>
<p><strong>Secure Key Generation:</strong> Use a cryptographically secure random number generator to create your keys. Libraries like <code>secrets</code> (Python 3.6+) are recommended:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> secrets</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>secret_key <span class="op">=</span> secrets.token_hex(<span class="dv">32</span>) <span class="co"># 32 bytes = 256 bits</span></span></code></pre></div>
<p><strong>Important:</strong> Never hardcode keys directly into your application code. Use environment variables, configuration files, or dedicated secret management services.</p>
<h3 id="asymmetric-keys-rs256-es256">Asymmetric Keys (RS256, ES256)</h3>
<p>Algorithms like RS256 (RSA SHA256) and ES256 (ECDSA SHA256) use <em>asymmetric</em> key cryptography. This involves a pair of keys: a <em>private key</em> for signing and a <em>public key</em> for verification. The private key must be kept extremely secure; the public key can be distributed widely.</p>
<p><strong>Key Requirements:</strong> The key pair should be generated using a cryptographically secure method, with appropriate key sizes (e.g., 2048 bits for RSA, SECP256R1 for ECDSA).</p>
<p><strong>Example (Insecure for demonstration only):</strong></p>
<p>The following shows key generation; in a real application, you would load these from secure storage.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.backends <span class="im">import</span> default_backend</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives <span class="im">import</span> serialization</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> cryptography.hazmat.primitives.asymmetric <span class="im">import</span> rsa, ec</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># RSA key pair generation</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>private_key <span class="op">=</span> rsa.generate_private_key(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    public_exponent<span class="op">=</span><span class="dv">65537</span>, key_size<span class="op">=</span><span class="dv">2048</span>, backend<span class="op">=</span>default_backend()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>public_key <span class="op">=</span> private_key.public_key()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ECDSA key pair generation</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>private_key_ec <span class="op">=</span> ec.generate_private_key(ec.SECP256R1(), default_backend())</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>public_key_ec <span class="op">=</span> private_key_ec.public_key()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Serializing keys to PEM format for storage.</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Always use appropriate encryption for private key storage in production</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>private_pem <span class="op">=</span> private_key.private_bytes(</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    encoding<span class="op">=</span>serialization.Encoding.PEM,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span>serialization.PrivateFormat.PKCS8,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    encryption_algorithm<span class="op">=</span>serialization.NoEncryption(),  <span class="co">#INSECURE - Use a proper encryption algorithm!</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>public_pem <span class="op">=</span> public_key.public_bytes(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    encoding<span class="op">=</span>serialization.Encoding.PEM,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">format</span><span class="op">=</span>serialization.PublicFormat.SubjectPublicKeyInfo,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 id="generating-key-pairs">Generating Key Pairs</h3>
<p>The examples above demonstrate key generation using the <code>cryptography</code> library. Other libraries might offer similar functionality. Always ensure you are using a cryptographically secure method for key generation.</p>
<h3 id="storing-and-managing-keys-securely">Storing and Managing Keys Securely</h3>
<p>Never store keys directly in your source code or easily accessible files. Use secure methods like:</p>
<ul>
<li><strong>Hardware Security Modules (HSMs):</strong> Provide the highest level of security for storing and managing cryptographic keys.</li>
<li><strong>Key Management Systems (KMS):</strong> Cloud-based services that handle key generation, storage, and rotation.</li>
<li><strong>Secure Encrypted Files:</strong> Store keys in encrypted files protected by strong passwords or key encryption keys.</li>
<li><strong>Environment Variables:</strong> Can be used for development or testing, but not recommended for production.</li>
</ul>
<p>When storing private keys, <strong>always</strong> use strong encryption to protect them from unauthorized access. <code>serialization.NoEncryption()</code> shown above is <strong>highly insecure</strong> and only for illustrative purposes.</p>
<h3 id="key-rotation">Key Rotation</h3>
<p>Regularly rotating your keys is a crucial security practice. This limits the impact of a potential key compromise. The frequency of rotation depends on your risk tolerance and security requirements. Consider factors like:</p>
<ul>
<li><strong>Key type:</strong> Symmetric keys need more frequent rotation than asymmetric keys.</li>
<li><strong>Sensitivity of data:</strong> If the data is highly sensitive, more frequent rotation is necessary.</li>
<li><strong>Regulatory requirements:</strong> Compliance standards may dictate specific key rotation policies.</li>
</ul>
<p>When rotating keys, plan a transition period to ensure backward compatibility. You might need to handle both old and new keys for a certain time.</p>
<h2 id="advanced-usage">Advanced Usage</h2>
<h3 id="custom-claims">Custom Claims</h3>
<p>Beyond the standard claims, you can add any custom claims to the JWT payload to carry application-specific information. These claims are defined by your application and are not standardized.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>payload <span class="op">=</span> {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user_id'</span>: <span class="dv">123</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'username'</span>: <span class="st">'johndoe'</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exp'</span>: jwt.time() <span class="op">+</span> <span class="dv">3600</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'role'</span>: <span class="st">'administrator'</span>,  <span class="co"># Custom claim</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'department'</span>: <span class="st">'engineering'</span> <span class="co">#Custom claim</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (encoding and decoding as before)</span></span></code></pre></div>
<h3 id="algorithm-configuration">Algorithm Configuration</h3>
<p>PyJWT supports various algorithms. You can explicitly specify the algorithm during encoding and decoding to ensure compatibility. The <code>algorithms</code> parameter in <code>jwt.decode()</code> is crucial for security; it verifies that the token was signed with an expected algorithm. Only specifying algorithms you trust prevents algorithm switching attacks.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> jwt.encode(payload, key, algorithm<span class="op">=</span><span class="st">'RS256'</span>)  <span class="co">#Explicit algorithm specification</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>decoded_payload <span class="op">=</span> jwt.decode(encoded_jwt, key, algorithms<span class="op">=</span>[<span class="st">'RS256'</span>]) <span class="co">#Explicit algorithm verification</span></span></code></pre></div>
<h3 id="jwt-header-customization">JWT Header Customization</h3>
<p>While less common, you can add custom parameters to the JWT header beyond <code>alg</code> and <code>typ</code>. These parameters are included in the encoded token but are typically not directly used for verification.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>header <span class="op">=</span> {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"alg"</span>: <span class="st">"HS256"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"typ"</span>: <span class="st">"JWT"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kid"</span>: <span class="st">"my-key-id"</span> <span class="co">#Custom header parameter</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>encoded_jwt <span class="op">=</span> jwt.encode(payload, key, algorithm<span class="op">=</span><span class="st">'HS256'</span>, headers<span class="op">=</span>header)</span></code></pre></div>
<h3 id="working-with-different-key-formats-pem-jwk">Working with Different Key Formats (PEM, JWK)</h3>
<p>PyJWT can work with keys in various formats:</p>
<ul>
<li><p><strong>PEM (Privacy Enhanced Mail):</strong> A common format for storing public and private keys, often used with RSA and ECDSA. The examples in previous sections used PEM format.</p></li>
<li><p><strong>JWK (JSON Web Key):</strong> A JSON-based format for representing cryptographic keys. PyJWT provides support for loading keys from JWK dictionaries.</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example JWK for RSA</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>jwk <span class="op">=</span> {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kty"</span>: <span class="st">"RSA"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kid"</span>: <span class="st">"my-key-id"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"use"</span>: <span class="st">"sig"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n"</span>: <span class="st">"your_modulus"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"e"</span>: <span class="st">"your_exponent"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... other JWK parameters</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>decoded_payload <span class="op">=</span> jwt.decode(encoded_jwt, jwk, algorithms<span class="op">=</span>[<span class="st">'RS256'</span>])</span></code></pre></div>
<h3 id="using-pyjwt-with-frameworks-e.g.-flask-django">Using PyJWT with Frameworks (e.g., Flask, Django)</h3>
<p>PyJWT integrates easily into various web frameworks. You can use it as a part of your authentication and authorization logic. Here’s a simplified example using Flask:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jwt</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>app.config[<span class="st">'SECRET_KEY'</span>] <span class="op">=</span> <span class="st">'your-secret-key'</span>  <span class="co">#Store key securely in production</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">'/protected'</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> protected():</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        token <span class="op">=</span> request.headers[<span class="st">'Authorization'</span>].split()[<span class="dv">1</span>]  <span class="co">#Extract token from header</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        decoded <span class="op">=</span> jwt.decode(token, app.config[<span class="st">'SECRET_KEY'</span>], algorithms<span class="op">=</span>[<span class="st">'HS256'</span>])</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">'message'</span>: <span class="st">'Protected resource accessed'</span>}), <span class="dv">200</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> jwt.ExpiredSignatureError:</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">'message'</span>: <span class="st">'Token expired'</span>}), <span class="dv">401</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> jwt.InvalidTokenError:</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">'message'</span>: <span class="st">'Invalid token'</span>}), <span class="dv">401</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> jsonify({<span class="st">'message'</span>: <span class="st">'An error occurred'</span>}), <span class="dv">500</span></span></code></pre></div>
<p>Adapt this example to your framework’s authentication mechanisms. Remember to securely manage your secret key.</p>
<h3 id="troubleshooting-common-errors">Troubleshooting Common Errors</h3>
<p>Common PyJWT errors and solutions:</p>
<ul>
<li><strong><code>jwt.ExpiredSignatureError</code>:</strong> The token’s expiration time (<code>exp</code> claim) has passed. Check the token’s expiry and ensure your system clock is synchronized.</li>
<li><strong><code>jwt.InvalidSignatureError</code>:</strong> The signature is invalid. Verify that you’re using the correct key and algorithm. Ensure that the key hasn’t been compromised.</li>
<li><strong><code>jwt.InvalidTokenError</code>:</strong> The token is malformed or otherwise invalid. Check for any structural problems in the token string.</li>
<li><strong><code>jwt.DecodeError</code>:</strong> The token cannot be decoded. Verify the token is correctly formatted.</li>
</ul>
<h3 id="performance-considerations-and-optimization">Performance Considerations and Optimization</h3>
<p>For high-throughput applications, consider these optimizations:</p>
<ul>
<li><strong>Caching:</strong> Cache frequently accessed keys to reduce the overhead of key retrieval.</li>
<li><strong>Asynchronous operations:</strong> Use asynchronous functions for decoding if possible to avoid blocking operations.</li>
<li><strong>Algorithm selection:</strong> Choose algorithms that balance security and performance needs. HS256 is generally faster than RS256 or ES256.</li>
<li><strong>Key size:</strong> Use appropriate key sizes for the selected algorithm, balancing security and performance. Larger keys generally offer better security but may slow down encoding and decoding.</li>
</ul>
<h2 id="security-best-practices">Security Best Practices</h2>
<h3 id="secure-key-management">Secure Key Management</h3>
<p>The security of your JWTs hinges on the security of your keys. Follow these practices:</p>
<ul>
<li><strong>Generate Strong Keys:</strong> Use cryptographically secure random number generators (like <code>secrets.token_hex()</code> in Python) to generate keys of sufficient length.</li>
<li><strong>Store Keys Securely:</strong> Never hardcode keys directly into your application code. Use environment variables, secure configuration files, or dedicated secrets management systems (like HashiCorp Vault, AWS Secrets Manager, etc.). For private keys, always encrypt them before storage.</li>
<li><strong>Protect Private Keys:</strong> For asymmetric algorithms, treat your private keys with extreme care. Their compromise completely undermines the security of your JWTs.</li>
<li><strong>Regular Key Rotation:</strong> Periodically rotate your keys to limit the impact of a potential compromise. The frequency depends on your risk tolerance and security requirements.</li>
<li><strong>Avoid Key Reuse:</strong> Never reuse keys across different applications or environments.</li>
</ul>
<h3 id="protecting-against-attacks">Protecting Against Attacks</h3>
<p>JWTs are relatively secure when used correctly, but be aware of potential attacks:</p>
<ul>
<li><strong>Algorithm Switching Attacks:</strong> Ensure that the <code>algorithms</code> parameter in <code>jwt.decode()</code> is correctly configured to only allow the algorithms you expect and trust. Never allow a token to specify the algorithm itself.</li>
<li><strong>Replay Attacks:</strong> Use mechanisms like <code>jti</code> (JWT ID) claims to prevent replay attacks where an attacker reuses a valid token. Also, ensure your system handles token expiration and revocation effectively.</li>
<li><strong>Cross-Site Request Forgery (CSRF):</strong> Implement proper CSRF protection measures in your application, as JWTs alone don’t protect against CSRF.</li>
<li><strong>Timing Attacks:</strong> Be mindful of potential timing attacks when verifying signatures. Some implementations might leak information through timing variations. Use constant-time comparison functions if necessary.</li>
<li><strong>Key Compromise:</strong> The most significant risk. Strong key management practices are paramount.</li>
</ul>
<h3 id="choosing-appropriate-algorithms">Choosing Appropriate Algorithms</h3>
<p>Select algorithms based on your security requirements and performance needs:</p>
<ul>
<li><strong>HS256 (HMAC SHA256):</strong> Suitable for applications where the client and server share a secret key. Simpler to implement but requires careful key management.</li>
<li><strong>RS256 (RSA SHA256) or ES256 (ECDSA SHA256):</strong> Better suited for situations demanding stronger security and key separation (as they use asymmetric cryptography). More complex to implement, requiring PKI management.</li>
</ul>
<p>Avoid weak or deprecated algorithms.</p>
<h3 id="regular-updates-and-patches">Regular Updates and Patches</h3>
<p>Keep PyJWT and its dependencies up to date to benefit from bug fixes and security patches. Regular updates mitigate vulnerabilities that might be exploited by attackers.</p>
<h3 id="input-validation-and-sanitization">Input Validation and Sanitization</h3>
<p>Always validate and sanitize any input data before using it to generate or decode JWTs. This prevents injection attacks and other vulnerabilities. Never trust user-provided data without proper validation:</p>
<ul>
<li><strong>Algorithm Validation:</strong> As mentioned before, explicitly specify allowed algorithms.</li>
<li><strong>Payload Validation:</strong> Validate the structure and content of the JWT payload to ensure it matches your expectations. Don’t blindly trust the data within the token.</li>
<li><strong>Header Validation:</strong> Validate any custom headers if used. Don’t rely solely on PyJWT’s default header parsing without verification.</li>
<li><strong>Token Format:</strong> Ensure the token string itself is correctly formatted before attempting to decode it. Handle potential errors gracefully.</li>
</ul>
<h2 id="appendix">Appendix</h2>
<h3 id="supported-algorithms">Supported Algorithms</h3>
<p>PyJWT supports a range of JSON Web Signature (JWS) and JSON Web Encryption (JWE) algorithms. The exact set of supported algorithms may vary slightly depending on the installed dependencies (specifically cryptographic libraries). However, commonly supported algorithms include:</p>
<ul>
<li><strong>HMAC-based:</strong> HS256, HS384, HS512</li>
<li><strong>RSA-based:</strong> RS256, RS384, RS512</li>
<li><strong>ECDSA-based:</strong> ES256, ES384, ES512</li>
<li><strong>EdDSA-based:</strong> EdDSA (Ed25519)</li>
<li><strong>PS-based:</strong> PS256, PS384, PS512</li>
</ul>
<p>For JWE algorithms, PyJWT supports various key management and encryption methods (e.g., A128CBC-HS256, A256GCM). Refer to the PyJWT documentation and the relevant RFCs for a complete and up-to-date list of supported algorithms.</p>
<h3 id="error-codes-and-exceptions">Error Codes and Exceptions</h3>
<p>PyJWT raises exceptions to signal errors during JWT encoding and decoding. Key exceptions include:</p>
<ul>
<li><strong><code>jwt.DecodeError</code>:</strong> A general error during token decoding, often indicating a malformed token.</li>
<li><strong><code>jwt.ExpiredSignatureError</code>:</strong> The token’s <code>exp</code> (expiration) claim has passed.</li>
<li><strong><code>jwt.InvalidAudienceError</code>:</strong> The token’s <code>aud</code> (audience) claim doesn’t match the expected audience.</li>
<li><strong><code>jwt.InvalidIssuedAtError</code>:</strong> The token’s <code>iat</code> (issued at) claim is invalid.</li>
<li><strong><code>jwt.InvalidIssuedAtError</code>:</strong> The token’s <code>nbf</code> (not before) claim is invalid.</li>
<li><strong><code>jwt.InvalidSignatureError</code>:</strong> The token’s signature is invalid.</li>
<li><strong><code>jwt.InvalidTokenError</code>:</strong> A general error indicating an invalid token structure or format.</li>
</ul>
<p>Consult the PyJWT documentation for a more complete list and details on specific error conditions. Appropriate error handling is crucial for robust application design.</p>
<h3 id="glossary-of-terms">Glossary of Terms</h3>
<ul>
<li><strong>JWT (JSON Web Token):</strong> A compact, URL-safe means of representing claims to be transferred between parties as a JSON object.</li>
<li><strong>Claim:</strong> A statement about an entity (e.g., user identity).</li>
<li><strong>Payload:</strong> The JSON object containing claims in a JWT.</li>
<li><strong>Header:</strong> The JSON object containing metadata about the JWT, including the signing algorithm.</li>
<li><strong>Signature:</strong> A cryptographically generated string that ensures the integrity and authenticity of the JWT.</li>
<li><strong>Symmetric Key:</strong> A secret key used for both encryption and decryption.</li>
<li><strong>Asymmetric Key:</strong> A pair of keys (public and private) where one key encrypts and the other decrypts.</li>
<li><strong>Algorithm:</strong> The cryptographic algorithm used to sign (and verify) the JWT.</li>
<li><strong>HMAC (Hash-based Message Authentication Code):</strong> A type of message authentication code (MAC) involving a cryptographic hash function and a secret cryptographic key.</li>
<li><strong>RSA (Rivest-Shamir-Adleman):</strong> A public-key cryptosystem.</li>
<li><strong>ECDSA (Elliptic Curve Digital Signature Algorithm):</strong> A variant of the Digital Signature Algorithm (DSA) that uses elliptic curve cryptography.</li>
<li><strong>JWK (JSON Web Key):</strong> A JSON-based format for representing cryptographic keys.</li>
<li><strong>PEM (Privacy Enhanced Mail):</strong> A common format for storing cryptographic keys.</li>
</ul>
<h3 id="references-and-further-reading">References and Further Reading</h3>
<ul>
<li><strong>RFC 7519: JSON Web Token (JWT):</strong> <a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a> The primary specification for JWTs.</li>
<li><strong>PyJWT Documentation:</strong> The official PyJWT documentation provides detailed information on usage, algorithms, and security considerations.</li>
<li><strong>Cryptography Libraries:</strong> Familiarize yourself with the documentation for the underlying cryptographic libraries used by PyJWT (e.g., <code>cryptography</code>).</li>
</ul>
<p>This appendix provides a concise overview. Refer to the linked resources for more comprehensive information.</p>


<footer>Copyright 2025 - Muthukrishnan</footer>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3609399560636561" crossorigin="anonymous"></script>




</body></html>