<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Muthukrishnan">

<title>openpyxl - Documentation – Technical Manuals</title>
<style>
html {
  color: #1a1a1a;
  background-color: #fdfdfd;
}
body {
  margin: 0 auto;
  max-width: 36em;
  padding-left: 50px;
  padding-right: 50px;
  padding-top: 50px;
  padding-bottom: 50px;
  hyphens: auto;
  overflow-wrap: break-word;
  text-rendering: optimizeLegibility;
  font-kerning: normal;
}
@media (max-width: 600px) {
  body {
    font-size: 0.9em;
    padding: 12px;
  }
  h1 {
    font-size: 1.8em;
  }
}
@media print {
  html {
    background-color: white;
  }
  body {
    background-color: transparent;
    color: black;
    font-size: 12pt;
  }
  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }
  h2, h3, h4 {
    page-break-after: avoid;
  }
}
p {
  margin: 1em 0;
}
a {
  color: #1a1a1a;
}
a:visited {
  color: #1a1a1a;
}
img {
  max-width: 100%;
}
svg {
  height; auto;
  max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
  margin-top: 1.4em;
}
h5, h6 {
  font-size: 1em;
  font-style: italic;
}
h6 {
  font-weight: normal;
}
ol, ul {
  padding-left: 1.7em;
  margin-top: 1em;
}
li > ol, li > ul {
  margin-top: 0;
}
ul > li:not(:has(> p)) > ul,
ol > li:not(:has(> p)) > ul,
ul > li:not(:has(> p)) > ol,
ol > li:not(:has(> p)) > ol {
  margin-bottom: 0;
}
ul > li:not(:has(> p)) > ul > li:has(> p),
ol > li:not(:has(> p)) > ul > li:has(> p),
ul > li:not(:has(> p)) > ol > li:has(> p),
ol > li:not(:has(> p)) > ol > li:has(> p) {
  margin-top: 1rem;
}
blockquote {
  margin: 1em 0 1em 1.7em;
  padding-left: 1em;
  border-left: 2px solid #e6e6e6;
  color: #606060;
}
code {
  font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
  font-size: 85%;
  margin: 0;
  hyphens: manual;
}
pre {
  margin: 1em 0;
  overflow: auto;
}
pre code {
  padding: 0;
  overflow: visible;
  overflow-wrap: normal;
}
.sourceCode {
 background-color: transparent;
 overflow: visible;
}
hr {
  background-color: #1a1a1a;
  border: none;
  height: 1px;
  margin: 1em 0;
}
table {
  margin: 1em 0;
  border-collapse: collapse;
  width: 100%;
  overflow-x: auto;
  display: block;
  font-variant-numeric: lining-nums tabular-nums;
}
table caption {
  margin-bottom: 0.75em;
}
tbody {
  margin-top: 0.5em;
  border-top: 1px solid #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
}
th {
  border-top: 1px solid #1a1a1a;
  padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
  padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
  margin-bottom: 4em;
  text-align: center;
}
#TOC li {
  list-style: none;
}
#TOC ul {
  padding-left: 1.3em;
}
#TOC > ul {
  padding-left: 0;
}
#TOC a:not(:hover) {
  text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<link href="../../favicon.ico" rel="icon">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MXDPF6L5TL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-MXDPF6L5TL', { 'anonymize_ip': true});
</script>
<link rel="icon" type="image/x-icon" href="favicon.ico">
<meta property="og:title" content="openpyxl - Documentation – Technical Manuals">
<meta property="og:site_name" content="Technical Manuals">
</head><body><div class="navigation-header">
    <nav>
        <div>
            <div class="logo">
                <a href="../../" aria-label="Home">
                    <span>Technical Manuals - Home</span>
                </a>
            </div>
            <div class="nav-menu">
                <ul>
                    <li>
                        <a href="../../about.html">
                            <span class="menu-text">About</span>
                        </a>
                    </li>
                    <li> 
                        <a href="https://github.com/muthuspark" target="_blank">
                            <span class="menu-text">Github</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/krimuthu" target="_blank">
                            <span class="menu-text">Linkedin</span>
                        </a>
                    </li>
                    <li>
                        <button onclick="window.print()" class="print-button">
                            <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M6 9V2h12v7"></path>
                              <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
                              <path d="M6 14h12v8H6z"></path>
                            </svg>
                            Print Page
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>


<link rel="stylesheet" href="../../styles.css">





<header id="title-block-header">
<h1 class="title">openpyxl - Documentation</h1>

</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-openpyxl" id="toc-what-is-openpyxl">What is openpyxl?</a></li>
  <li><a href="#installation-and-setup" id="toc-installation-and-setup">Installation and Setup</a></li>
  <li><a href="#basic-concepts-and-terminology" id="toc-basic-concepts-and-terminology">Basic Concepts and Terminology</a></li>
  <li><a href="#example-reading-and-writing-a-simple-spreadsheet" id="toc-example-reading-and-writing-a-simple-spreadsheet">Example: Reading and Writing a Simple Spreadsheet</a></li>
  <li><a href="#workbook-and-worksheet-objects" id="toc-workbook-and-worksheet-objects">Workbook and Worksheet Objects</a>
  <ul>
  <li><a href="#creating-workbooks" id="toc-creating-workbooks">Creating Workbooks</a></li>
  <li><a href="#accessing-worksheets" id="toc-accessing-worksheets">Accessing Worksheets</a></li>
  <li><a href="#creating-worksheets" id="toc-creating-worksheets">Creating Worksheets</a></li>
  <li><a href="#deleting-worksheets" id="toc-deleting-worksheets">Deleting Worksheets</a></li>
  <li><a href="#renaming-worksheets" id="toc-renaming-worksheets">Renaming Worksheets</a></li>
  <li><a href="#working-with-multiple-workbooks" id="toc-working-with-multiple-workbooks">Working with Multiple Workbooks</a></li>
  <li><a href="#workbook-properties" id="toc-workbook-properties">Workbook Properties</a></li>
  </ul></li>
  <li><a href="#cells-and-cell-values" id="toc-cells-and-cell-values">Cells and Cell Values</a>
  <ul>
  <li><a href="#accessing-cell-values" id="toc-accessing-cell-values">Accessing Cell Values</a></li>
  <li><a href="#setting-cell-values" id="toc-setting-cell-values">Setting Cell Values</a></li>
  <li><a href="#data-types" id="toc-data-types">Data Types</a></li>
  <li><a href="#formulas-and-calculations" id="toc-formulas-and-calculations">Formulas and Calculations</a></li>
  <li><a href="#number-formatting" id="toc-number-formatting">Number Formatting</a></li>
  <li><a href="#dates-and-times" id="toc-dates-and-times">Dates and Times</a></li>
  <li><a href="#working-with-cell-ranges" id="toc-working-with-cell-ranges">Working with Cell Ranges</a></li>
  </ul></li>
  <li><a href="#styles-and-formatting" id="toc-styles-and-formatting">Styles and Formatting</a>
  <ul>
  <li><a href="#fonts" id="toc-fonts">Fonts</a></li>
  <li><a href="#fill-colors" id="toc-fill-colors">Fill Colors</a></li>
  <li><a href="#borders" id="toc-borders">Borders</a></li>
  <li><a href="#alignment" id="toc-alignment">Alignment</a></li>
  <li><a href="#number-formats" id="toc-number-formats">Number Formats</a></li>
  <li><a href="#conditional-formatting" id="toc-conditional-formatting">Conditional Formatting</a></li>
  <li><a href="#styles-and-themes" id="toc-styles-and-themes">Styles and Themes</a></li>
  <li><a href="#applying-styles-to-cells-and-ranges" id="toc-applying-styles-to-cells-and-ranges">Applying Styles to Cells and Ranges</a></li>
  </ul></li>
  <li><a href="#charts-and-graphs" id="toc-charts-and-graphs">Charts and Graphs</a>
  <ul>
  <li><a href="#creating-charts" id="toc-creating-charts">Creating Charts</a></li>
  <li><a href="#chart-types" id="toc-chart-types">Chart Types</a></li>
  <li><a href="#customizing-charts" id="toc-customizing-charts">Customizing Charts</a></li>
  <li><a href="#adding-charts-to-worksheets" id="toc-adding-charts-to-worksheets">Adding Charts to Worksheets</a></li>
  </ul></li>
  <li><a href="#images-and-drawings" id="toc-images-and-drawings">Images and Drawings</a>
  <ul>
  <li><a href="#adding-images-to-worksheets" id="toc-adding-images-to-worksheets">Adding Images to Worksheets</a></li>
  <li><a href="#working-with-drawing-objects" id="toc-working-with-drawing-objects">Working with Drawing Objects</a></li>
  <li><a href="#resizing-and-positioning-images" id="toc-resizing-and-positioning-images">Resizing and Positioning Images</a></li>
  <li><a href="#image-formats" id="toc-image-formats">Image Formats</a></li>
  </ul></li>
  <li><a href="#working-with-tables" id="toc-working-with-tables">Working with Tables</a>
  <ul>
  <li><a href="#creating-tables" id="toc-creating-tables">Creating Tables</a></li>
  <li><a href="#formatting-tables" id="toc-formatting-tables">Formatting Tables</a></li>
  <li><a href="#working-with-table-data" id="toc-working-with-table-data">Working with Table Data</a></li>
  <li><a href="#filtering-and-sorting" id="toc-filtering-and-sorting">Filtering and Sorting</a></li>
  </ul></li>
  <li><a href="#advanced-features" id="toc-advanced-features">Advanced Features</a>
  <ul>
  <li><a href="#working-with-pivot-tables" id="toc-working-with-pivot-tables">Working with Pivot Tables</a></li>
  <li><a href="#data-validation" id="toc-data-validation">Data Validation</a></li>
  <li><a href="#macros-and-vba-if-applicable" id="toc-macros-and-vba-if-applicable">Macros and VBA (if applicable)</a></li>
  <li><a href="#external-links" id="toc-external-links">External Links</a></li>
  <li><a href="#protecting-worksheets-and-workbooks" id="toc-protecting-worksheets-and-workbooks">Protecting Worksheets and Workbooks</a></li>
  </ul></li>
  <li><a href="#error-handling-and-best-practices" id="toc-error-handling-and-best-practices">Error Handling and Best Practices</a>
  <ul>
  <li><a href="#common-errors-and-troubleshooting" id="toc-common-errors-and-troubleshooting">Common Errors and Troubleshooting</a></li>
  <li><a href="#performance-optimization" id="toc-performance-optimization">Performance Optimization</a></li>
  <li><a href="#memory-management" id="toc-memory-management">Memory Management</a></li>
  <li><a href="#large-files-and-efficient-processing" id="toc-large-files-and-efficient-processing">Large Files and Efficient Processing</a></li>
  <li><a href="#security-considerations" id="toc-security-considerations">Security Considerations</a></li>
  </ul></li>
  <li><a href="#appendix-reference-tables-and-apis" id="toc-appendix-reference-tables-and-apis">Appendix: Reference Tables and APIs</a>
  <ul>
  <li><a href="#list-of-functions-and-methods" id="toc-list-of-functions-and-methods">List of Functions and Methods</a></li>
  <li><a href="#data-structures" id="toc-data-structures">Data Structures</a></li>
  <li><a href="#constants-and-enumerations" id="toc-constants-and-enumerations">Constants and Enumerations</a></li>
  <li><a href="#api-reference" id="toc-api-reference">API Reference</a></li>
  </ul></li>
  </ul>
</nav>
<h3 id="what-is-openpyxl">What is openpyxl?</h3>
<p>openpyxl is a Python library for reading and writing Excel 2010 xlsx/xlsm/xltx/xltm files. It provides a robust and efficient way to interact with Excel spreadsheets programmatically, allowing developers to create, modify, and analyze data within Python applications. Unlike older libraries that only support older .xls file formats, openpyxl fully supports the more modern and feature-rich .xlsx format, including features like charts, images, styles, and formulas. It’s a powerful tool for automating tasks involving spreadsheet data, integrating Excel functionalities into larger applications, and building data-driven tools.</p>
<h3 id="installation-and-setup">Installation and Setup</h3>
<p>The easiest way to install openpyxl is using pip, the Python package installer:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install openpyxl</span></code></pre></div>
<p>This command will download and install the latest stable version of openpyxl and its dependencies. You’ll need Python 3.7 or higher. If you encounter issues, ensure your pip is up-to-date using <code>pip install --upgrade pip</code>. For specific versions, consult the openpyxl documentation for compatibility information and alternative installation methods. After successful installation, you can verify it by importing the library in a Python interpreter:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openpyxl</span></code></pre></div>
<p>If no errors occur, openpyxl is correctly installed.</p>
<h3 id="basic-concepts-and-terminology">Basic Concepts and Terminology</h3>
<p>openpyxl represents an Excel file as a workbook, which contains one or more worksheets. A worksheet is a grid of cells organized into rows and columns. Each cell can contain different data types: numbers, text, formulas, dates, booleans, etc. Key terminology includes:</p>
<ul>
<li><strong>Workbook:</strong> The entire Excel file. It’s represented by the <code>Workbook</code> class.</li>
<li><strong>Worksheet:</strong> A single sheet within the workbook. Represented by the <code>Worksheet</code> class.</li>
<li><strong>Cell:</strong> An individual entry in the worksheet, identified by its column and row coordinates (e.g., “A1”, “B2”). Accessed using <code>worksheet["A1"]</code> or <code>worksheet.cell(row=1, column=1)</code>.</li>
<li><strong>Row:</strong> A horizontal sequence of cells.</li>
<li><strong>Column:</strong> A vertical sequence of cells.</li>
<li><strong>Cell Value:</strong> The content of a cell (string, number, formula, etc.).</li>
<li><strong>Cell Style:</strong> Formatting applied to a cell (font, alignment, number format, etc.).</li>
</ul>
<h3 id="example-reading-and-writing-a-simple-spreadsheet">Example: Reading and Writing a Simple Spreadsheet</h3>
<p>This example demonstrates reading data from an existing Excel file and writing new data to a new file:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook, Workbook</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading from an existing file</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">'example.xlsx'</span>) <span class="co"># Replace 'example.xlsx' with your file</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active  <span class="co"># Get the active worksheet</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing cell values</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>cell_value <span class="op">=</span> sheet[<span class="st">'A1'</span>].value</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Value of A1: </span><span class="sc">{</span>cell_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterating through rows</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> sheet.iter_rows(min_row<span class="op">=</span><span class="dv">1</span>, max_row<span class="op">=</span><span class="dv">5</span>, min_col<span class="op">=</span><span class="dv">1</span>, max_col<span class="op">=</span><span class="dv">2</span>): <span class="co"># Adjust ranges as needed</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Cell value: </span><span class="sc">{</span>cell<span class="sc">.</span>value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Writing to a new file</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>new_workbook <span class="op">=</span> Workbook()</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>new_sheet <span class="op">=</span> new_workbook.active</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>new_sheet[<span class="st">'A1'</span>] <span class="op">=</span> <span class="st">"Hello, openpyxl!"</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>new_sheet[<span class="st">'B1'</span>] <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the new workbook</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>new_workbook.save(<span class="st">"new_example.xlsx"</span>)</span></code></pre></div>
<p>Remember to replace <code>'example.xlsx'</code> with the actual path to your Excel file. This example showcases basic read and write operations. For more advanced features (charts, formulas, styles), refer to the comprehensive openpyxl documentation.</p>
<h2 id="workbook-and-worksheet-objects">Workbook and Worksheet Objects</h2>
<h3 id="creating-workbooks">Creating Workbooks</h3>
<p>To create a new Excel workbook, use the <code>Workbook()</code> class constructor:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()  <span class="co"># Creates a new workbook with a single, empty worksheet</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the active worksheet (the first one by default)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ... add data to the worksheet ...</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"my_new_workbook.xlsx"</span>) <span class="co"># Save the workbook to a file.</span></span></code></pre></div>
<p>By default, a new workbook is created with a single, empty worksheet. You can add more worksheets as needed (see below).</p>
<h3 id="accessing-worksheets">Accessing Worksheets</h3>
<p>Several methods provide access to worksheets within a workbook. The most common is accessing the active worksheet (the one currently selected in Excel), using <code>workbook.active</code>. You can also access worksheets by name or index:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">"my_workbook.xlsx"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing the active worksheet:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>active_sheet <span class="op">=</span> workbook.active</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing a worksheet by name:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>sheet_by_name <span class="op">=</span> workbook[<span class="st">"Sheet1"</span>]  <span class="co"># Replace "Sheet1" with the actual sheet name</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing a worksheet by index (index starts from 0):</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>sheet_by_index <span class="op">=</span> workbook.worksheets[<span class="dv">0</span>] <span class="co"># Accesses the first worksheet</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if a worksheet exists before accessing it (avoid errors)</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"Sheet2"</span> <span class="kw">in</span> workbook.sheetnames:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  sheet2 <span class="op">=</span> workbook[<span class="st">"Sheet2"</span>]</span></code></pre></div>
<h3 id="creating-worksheets">Creating Worksheets</h3>
<p>Adding new worksheets is straightforward using the <code>create_sheet()</code> method. This method takes the sheet name as the first argument, and optional arguments for <code>index</code> (position within the workbook) and <code>before</code> (insert before another sheet):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new worksheet named "Data" at the end</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>new_sheet <span class="op">=</span> workbook.create_sheet(<span class="st">"Data"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new worksheet named "Summary" before the sheet named "Data"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>summary_sheet <span class="op">=</span> workbook.create_sheet(<span class="st">"Summary"</span>, index<span class="op">=</span><span class="dv">1</span>, before<span class="op">=</span>new_sheet)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"workbook_with_sheets.xlsx"</span>)</span></code></pre></div>
<h3 id="deleting-worksheets">Deleting Worksheets</h3>
<p>To remove a worksheet, use the <code>remove()</code> method:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">"my_workbook.xlsx"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete a worksheet by name</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>sheet_to_delete <span class="op">=</span> workbook[<span class="st">"Sheet3"</span>]  <span class="co"># Replace "Sheet3" with the sheet to delete</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>workbook.remove(sheet_to_delete)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Delete a worksheet by index</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>workbook.remove(workbook.worksheets[<span class="dv">1</span>]) <span class="co">#Deletes the second sheet</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"my_workbook_modified.xlsx"</span>)</span></code></pre></div>
<p>Remember to save the workbook after deleting a sheet.</p>
<h3 id="renaming-worksheets">Renaming Worksheets</h3>
<p>Change a worksheet’s name using the <code>title</code> attribute:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">"my_workbook.xlsx"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook[<span class="st">"Sheet1"</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sheet.title <span class="op">=</span> <span class="st">"New Sheet Name"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"my_workbook_renamed.xlsx"</span>)</span></code></pre></div>
<h3 id="working-with-multiple-workbooks">Working with Multiple Workbooks</h3>
<p>openpyxl allows you to work with multiple workbooks simultaneously. Just load or create multiple <code>Workbook</code> objects:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook, Workbook</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>workbook1 <span class="op">=</span> load_workbook(<span class="st">"file1.xlsx"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>workbook2 <span class="op">=</span> Workbook()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ... process both workbooks ...</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>workbook1.save(<span class="st">"file1_modified.xlsx"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>workbook2.save(<span class="st">"file2.xlsx"</span>)</span></code></pre></div>
<h3 id="workbook-properties">Workbook Properties</h3>
<p>Workbooks have several properties, including:</p>
<ul>
<li><code>active</code>: The currently active worksheet.</li>
<li><code>worksheets</code>: A list of all worksheets in the workbook.</li>
<li><code>sheetnames</code>: A list of the names of all worksheets.</li>
<li><code>properties</code>: Access to file properties using the <code>Workbook.properties</code> attribute, allowing setting things like author, last modified by, etc. See the openpyxl documentation for details.</li>
</ul>
<p>Remember to always save your changes using <code>workbook.save("filename.xlsx")</code> to persist modifications to the Excel file. Handle potential <code>FileNotFoundError</code> exceptions if the specified file doesn’t exist when loading a workbook. Also, it’s good practice to close the workbook using <code>workbook.close()</code> after you’re finished working with it to release resources, though this is automatically handled by Python’s garbage collection.</p>
<h2 id="cells-and-cell-values">Cells and Cell Values</h2>
<h3 id="accessing-cell-values">Accessing Cell Values</h3>
<p>Cell values are accessed using several methods. The most common is indexing using the cell’s coordinates as a string (e.g., “A1”) or using the <code>cell()</code> method, which takes row and column numbers:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">"my_workbook.xlsx"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing using string index</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>cell_value <span class="op">=</span> sheet[<span class="st">"A1"</span>].value</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Value of A1: </span><span class="sc">{</span>cell_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing using cell() method (row, column) - 1-based indexing</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>cell_value <span class="op">=</span> sheet.cell(row<span class="op">=</span><span class="dv">2</span>, column<span class="op">=</span><span class="dv">3</span>).value <span class="co"># Accesses cell C2</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Value of C2: </span><span class="sc">{</span>cell_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking for a None value (empty cell)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> sheet[<span class="st">"B5"</span>].value <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Cell B5 is empty"</span>)</span></code></pre></div>
<p>Remember that cell coordinates are 1-based (the top-left cell is A1). An empty cell will have a <code>value</code> of <code>None</code>.</p>
<h3 id="setting-cell-values">Setting Cell Values</h3>
<p>Setting a cell’s value is equally simple:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>] <span class="op">=</span> <span class="st">"Hello"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"B1"</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"C1"</span>] <span class="op">=</span> <span class="fl">3.14159</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>sheet.cell(row<span class="op">=</span><span class="dv">2</span>, column<span class="op">=</span><span class="dv">1</span>).value <span class="op">=</span> <span class="va">True</span> <span class="co"># Setting a boolean value</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"output.xlsx"</span>)</span></code></pre></div>
<p>You can assign various data types to cells (see below for more details).</p>
<h3 id="data-types">Data Types</h3>
<p>openpyxl handles several data types:</p>
<ul>
<li><strong>Numbers:</strong> Integers, floats, etc. are stored as numbers.</li>
<li><strong>Strings:</strong> Text values are stored as strings.</li>
<li><strong>Booleans:</strong> <code>True</code> and <code>False</code> are supported.</li>
<li><strong>Dates and Times:</strong> These are stored as Python <code>datetime</code> objects.</li>
<li><strong>Formulas:</strong> Formulas are stored as strings, but openpyxl can evaluate some simple formulas (see below).</li>
<li><strong>None:</strong> Represents an empty cell.</li>
</ul>
<h3 id="formulas-and-calculations">Formulas and Calculations</h3>
<p>openpyxl can handle formulas in cells:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A2"</span>] <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A3"</span>] <span class="op">=</span> <span class="st">"=SUM(A1:A2)"</span> <span class="co"># Formula to sum A1 and A2</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"formula_example.xlsx"</span>)</span></code></pre></div>
<p>While openpyxl doesn’t inherently <em>calculate</em> formulas (that’s Excel’s job), it stores and saves them correctly, allowing Excel to perform the calculation upon opening. More complex formula evaluation might require external libraries or using Excel’s calculation engine through COM (for Windows).</p>
<h3 id="number-formatting">Number Formatting</h3>
<p>To format numbers, use the <code>number_format</code> property of the cell:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.styles <span class="im">import</span> numbers</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>] <span class="op">=</span> <span class="fl">1234.56</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply different number formats</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>].number_format <span class="op">=</span> numbers.FORMAT_PERCENTAGE <span class="co">#Percentage</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A2"</span>].number_format <span class="op">=</span> numbers.FORMAT_CURRENCY_USD <span class="co">#US Dollar</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A3"</span>].number_format <span class="op">=</span> <span class="st">'0.00'</span> <span class="co">#Two decimal places</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A4"</span>].number_format <span class="op">=</span> <span class="st">'#,##0'</span> <span class="co">#Comma separated thousands</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"number_formats.xlsx"</span>)</span></code></pre></div>
<p>Consult the openpyxl documentation for a complete list of number formats. You can use custom number formats as well.</p>
<h3 id="dates-and-times">Dates and Times</h3>
<p>Dates and times are represented using Python’s <code>datetime</code> objects:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>] <span class="op">=</span> datetime(<span class="dv">2024</span>, <span class="dv">3</span>, <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">0</span>) <span class="co"># Date and Time</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"date_example.xlsx"</span>)</span></code></pre></div>
<p>openpyxl handles the conversion between Python’s <code>datetime</code> objects and Excel’s date system automatically.</p>
<h3 id="working-with-cell-ranges">Working with Cell Ranges</h3>
<p>You can efficiently work with ranges of cells using <code>sheet.iter_rows()</code> and <code>sheet.iter_cols()</code>. These methods provide iterators to traverse ranges efficiently:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">"my_workbook.xlsx"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through rows 1 to 5 and columns A to C</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> sheet.iter_rows(min_row<span class="op">=</span><span class="dv">1</span>, max_row<span class="op">=</span><span class="dv">5</span>, min_col<span class="op">=</span><span class="dv">1</span>, max_col<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(cell.value)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Iterate through columns 1 to 3</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> sheet.iter_cols(min_row<span class="op">=</span><span class="dv">1</span>, max_row<span class="op">=</span><span class="dv">5</span>, min_col<span class="op">=</span><span class="dv">1</span>, max_col<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> col:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(cell.value)</span></code></pre></div>
<p>These iterators are significantly more memory-efficient than retrieving all cells at once when dealing with large spreadsheets. Remember that <code>min_row</code>, <code>max_row</code>, <code>min_col</code>, and <code>max_col</code> use 1-based indexing.</p>
<h2 id="styles-and-formatting">Styles and Formatting</h2>
<h3 id="fonts">Fonts</h3>
<p>You can control font attributes like name, size, bold, italic, color, etc., using the <code>Font</code> class from <code>openpyxl.styles</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.styles <span class="im">import</span> Font</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>font <span class="op">=</span> Font(name<span class="op">=</span><span class="st">'Arial'</span>, size<span class="op">=</span><span class="dv">14</span>, bold<span class="op">=</span><span class="va">True</span>, italic<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"FF0000"</span>) <span class="co">#Red color using hex code</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>].font <span class="op">=</span> font</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"A1"</span>] <span class="op">=</span> <span class="st">"Styled Text"</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"font_styles.xlsx"</span>)</span></code></pre></div>
<p>Remember that color can be specified using RGB hex codes (e.g., “FF0000” for red) or named colors (check the openpyxl documentation for available named colors).</p>
<h3 id="fill-colors">Fill Colors</h3>
<p>Cell background colors are controlled with the <code>PatternFill</code> class:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.styles <span class="im">import</span> PatternFill</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Solid Fill</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>fill <span class="op">=</span> PatternFill(start_color<span class="op">=</span><span class="st">"FFFF00"</span>, end_color<span class="op">=</span><span class="st">"FFFF00"</span>, fill_type<span class="op">=</span><span class="st">"solid"</span>) <span class="co">#Yellow</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"B1"</span>].fill <span class="op">=</span> fill</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"B1"</span>] <span class="op">=</span> <span class="st">"Yellow Fill"</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Other fill types are available such as:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="0000FF", end_color="FFFFFF", fill_type="lightUp") #Light up blue</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="00FF00", end_color="FFFFFF", fill_type="lightDown") #Light down green</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="FF0000", end_color="00FF00", fill_type="lightGrid") #Light grid red-green</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="FFFF00", end_color="0000FF", fill_type="darkDown") #Dark down yellow-blue</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="00FFFF", end_color="FF0000", fill_type="darkGrid") #Dark grid cyan-red</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="FF00FF", end_color="FFFF00", fill_type="darkUp") #Dark up magenta-yellow</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#fill = PatternFill(start_color="000000", end_color="FFFFFF", fill_type="gray125") #Gray 125</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"C1"</span>].fill <span class="op">=</span> PatternFill(start_color<span class="op">=</span><span class="st">"0000FF"</span>, end_color<span class="op">=</span><span class="st">"FFFFFF"</span>, fill_type<span class="op">=</span><span class="st">"lightUp"</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"C1"</span>] <span class="op">=</span> <span class="st">"LightUp Fill"</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"fill_styles.xlsx"</span>)</span></code></pre></div>
<p><code>fill_type</code> can be “solid”, “darkDown”, “darkGrid”, “darkUp”, “gray0625”, “gray125”, “lightDown”, “lightGrid”, “lightUp”, “lightGray”, “mediumGray”, or “patterned”. Start and end colors are specified using hex codes.</p>
<h3 id="borders">Borders</h3>
<p>Borders are defined using the <code>Border</code>, <code>Side</code> classes:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.styles <span class="im">import</span> Border, Side</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>thin_border <span class="op">=</span> Border(left<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                     right<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                     top<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                     bottom<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"D1"</span>].border <span class="op">=</span> thin_border</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"D1"</span>] <span class="op">=</span> <span class="st">"Thin Border"</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Other border styles: dashDot, dashDotDot, dashed, dotted, double, hair, medium, mediumDashDot, mediumDashDotDot, mediumDashed, slantDashDot</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>thick_border <span class="op">=</span> Border(left<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thick'</span>, color<span class="op">=</span><span class="st">"FF0000"</span>), right<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thick'</span>), top<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thick'</span>), bottom<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thick'</span>))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"E1"</span>].border <span class="op">=</span> thick_border</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"E1"</span>] <span class="op">=</span> <span class="st">"Thick Border"</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"border_styles.xlsx"</span>)</span></code></pre></div>
<p><code>Side</code> styles include ‘thin’, ‘medium’, ‘thick’, ‘double’, ‘dotted’, ‘dashed’, ‘dashDot’, ‘dashDotDot’, ‘slantDashDot’, and ‘hair’. You can specify border colors as well.</p>
<h3 id="alignment">Alignment</h3>
<p>Cell content alignment (horizontal, vertical, text wrapping, etc.) is controlled with the <code>Alignment</code> class:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.styles <span class="im">import</span> Alignment</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>alignment <span class="op">=</span> Alignment(horizontal<span class="op">=</span><span class="st">'center'</span>, vertical<span class="op">=</span><span class="st">'center'</span>, wrap_text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"F1"</span>].alignment <span class="op">=</span> alignment</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>sheet[<span class="st">"F1"</span>] <span class="op">=</span> <span class="st">"Center Aligned Text"</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"alignment_styles.xlsx"</span>)</span></code></pre></div>
<p><code>horizontal</code> can be ‘general’, ‘left’, ‘center’, ‘right’, ‘fill’, ‘justify’, ‘centerContinuous’, ‘distributed’. <code>vertical</code> can be ‘top’, ‘center’, ‘bottom’, ‘justify’, ‘distributed’.</p>
<h3 id="number-formats">Number Formats</h3>
<p>Number formats were covered in the previous section (“Cells and Cell Values”). Refer to that section for details on formatting numbers, dates, and currency.</p>
<h3 id="conditional-formatting">Conditional Formatting</h3>
<p>Conditional formatting involves applying styles based on cell values or formulas. openpyxl provides support for this, but it’s more complex; refer to the openpyxl documentation for detailed examples and API usage. It involves using the <code>DifferentialStyle</code> and <code>Rule</code> classes and working with the <code>conditional_formatting</code> feature of the worksheet.</p>
<h3 id="styles-and-themes">Styles and Themes</h3>
<p>openpyxl allows working with styles and themes, but the specifics are advanced and are best explored in the library’s documentation. Themes govern the overall look and feel, while styles provide more fine-grained control over individual elements.</p>
<h3 id="applying-styles-to-cells-and-ranges">Applying Styles to Cells and Ranges</h3>
<p>Styles are applied to cells using the appropriate style properties (e.g., <code>cell.font</code>, <code>cell.fill</code>, <code>cell.alignment</code>, <code>cell.number_format</code>, <code>cell.border</code>). To apply styles to ranges, iterate through the cells in the range and apply the styles to each cell individually, or explore using <code>Conditional Formatting</code> which can apply styles to ranges based on conditions. Creating and applying a custom <code>Style</code> object can also be helpful for consistently applying multiple formatting elements.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.styles <span class="im">import</span> Font, PatternFill, Border, Side, Alignment</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define styles once</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>bold_red_font <span class="op">=</span> Font(bold<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"FF0000"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>yellow_fill <span class="op">=</span> PatternFill(start_color<span class="op">=</span><span class="st">"FFFF00"</span>, end_color<span class="op">=</span><span class="st">"FFFF00"</span>, fill_type<span class="op">=</span><span class="st">"solid"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>thin_border <span class="op">=</span> Border(left<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>), right<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>), top<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>), bottom<span class="op">=</span>Side(style<span class="op">=</span><span class="st">'thin'</span>))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>center_alignment <span class="op">=</span> Alignment(horizontal<span class="op">=</span><span class="st">"center"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply styles to a range</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> sheet.iter_rows(min_row<span class="op">=</span><span class="dv">1</span>, max_row<span class="op">=</span><span class="dv">3</span>, min_col<span class="op">=</span><span class="dv">1</span>, max_col<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        cell.font <span class="op">=</span> bold_red_font</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        cell.fill <span class="op">=</span> yellow_fill</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        cell.border <span class="op">=</span> thin_border</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        cell.alignment <span class="op">=</span> center_alignment</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"range_styles.xlsx"</span>)</span></code></pre></div>
<h2 id="charts-and-graphs">Charts and Graphs</h2>
<h3 id="creating-charts">Creating Charts</h3>
<p>Creating charts in openpyxl involves several steps: first, define the chart data, then create a chart object specifying the chart type, and finally add the chart to a worksheet. The process uses classes from the <code>openpyxl.chart</code> module.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.chart <span class="im">import</span> BarChart, Reference</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Category'</span>, <span class="st">'Value'</span>],</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'A'</span>, <span class="dv">10</span>],</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'B'</span>, <span class="dv">15</span>],</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'C'</span>, <span class="dv">20</span>],</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> data:</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    sheet.append(row)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create chart data reference</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>chart_data <span class="op">=</span> Reference(sheet, min_col<span class="op">=</span><span class="dv">2</span>, min_row<span class="op">=</span><span class="dv">1</span>, max_col<span class="op">=</span><span class="dv">2</span>, max_row<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar chart</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>chart <span class="op">=</span> BarChart()</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>chart.add_data(chart_data)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize chart (optional - see below)</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add chart to worksheet</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>sheet.add_chart(chart, <span class="st">"E1"</span>) <span class="co"># Add chart at cell E1</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"chart_example.xlsx"</span>)</span></code></pre></div>
<p>This creates a simple bar chart from the data. Remember that the <code>Reference</code> object specifies the cell range containing your chart data. The <code>add_chart()</code> method adds the chart to the worksheet at a given cell location.</p>
<h3 id="chart-types">Chart Types</h3>
<p>openpyxl supports various chart types, including:</p>
<ul>
<li><code>BarChart</code> (bar chart)</li>
<li><code>LineChart</code> (line chart)</li>
<li><code>PieChart</code> (pie chart)</li>
<li><code>ScatterChart</code> (scatter chart)</li>
<li><code>AreaChart</code> (area chart)</li>
<li><code>RadarChart</code> (radar chart)</li>
<li><code>DoughnutChart</code> (doughnut chart)</li>
<li><code>StockChart</code> (stock chart)</li>
</ul>
<p>To create a different chart type, simply replace <code>BarChart</code> with the desired chart class in the code above. Each chart type has specific configuration options; refer to the openpyxl documentation.</p>
<h3 id="customizing-charts">Customizing Charts</h3>
<p>Charts can be customized extensively:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.chart <span class="im">import</span> BarChart, Reference, Series</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.chart.axis <span class="im">import</span> CategoryAxis, ValueAxis</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (data and chart creation as above) ...</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize chart title</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>chart.title <span class="op">=</span> <span class="st">"Sales Data"</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize axes</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>chart.x_axis <span class="op">=</span> CategoryAxis(title<span class="op">=</span><span class="st">'Categories'</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>chart.y_axis <span class="op">=</span> ValueAxis(title<span class="op">=</span><span class="st">'Sales'</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add series labels (for multiple data series)</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>chart.series[<span class="dv">0</span>].name <span class="op">=</span> <span class="st">'Sales Figures'</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>chart.legend <span class="op">=</span> <span class="va">None</span> <span class="co"># Remove legend (default is shown)</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust chart layout</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>chart.width <span class="op">=</span> <span class="dv">20</span> <span class="co">#Adjust Width</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>chart.height <span class="op">=</span> <span class="dv">10</span> <span class="co">#Adjust Height</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (add chart to worksheet) ...</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"chart_custom.xlsx"</span>)</span></code></pre></div>
<p>This adds a title, labels to the axes, and removes the chart legend. Numerous other customization options exist, including data label formatting, styling the chart elements, changing colors, adding gridlines, and much more (consult the openpyxl documentation for a complete overview). Consider the use of <code>Series</code> objects to add additional series to a chart.</p>
<h3 id="adding-charts-to-worksheets">Adding Charts to Worksheets</h3>
<p>Charts are added using the <code>sheet.add_chart()</code> method. The first argument is the chart object, and the second is the top-left cell location where the chart will be placed on the worksheet. For example:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sheet.add_chart(chart, <span class="st">"A10"</span>)  <span class="co"># Places the chart starting at cell A10</span></span></code></pre></div>
<p>The chart will automatically adjust its size to fit the data it represents, but you can manually adjust chart size using its <code>width</code> and <code>height</code> attributes before adding it to the worksheet. Avoid placing charts over data that you intend to use; they will overlap.</p>
<h2 id="images-and-drawings">Images and Drawings</h2>
<h3 id="adding-images-to-worksheets">Adding Images to Worksheets</h3>
<p>Adding images to worksheets involves using the <code>openpyxl.drawing.image</code> module. You’ll need the path to your image file.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.drawing.image <span class="im">import</span> Image</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image(<span class="st">"my_image.png"</span>) <span class="co"># Replace "my_image.png" with your image path</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>sheet.add_image(img, <span class="st">"A1"</span>) <span class="co"># Add image starting at cell A1</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"image_example.xlsx"</span>)</span></code></pre></div>
<p>This adds the image to the worksheet, anchored at cell A1. The image will be scaled to fit within the cell’s bounds. Ensure that the image file exists in a location accessible to your Python script.</p>
<h3 id="working-with-drawing-objects">Working with Drawing Objects</h3>
<p>Images and other drawing objects in openpyxl are represented as <code>Drawing</code> objects. You can get a reference to these objects to manipulate their properties after adding them to the worksheet. For complex scenarios involving multiple images or other drawing objects in precise locations and with fine-grained control over their positioning and overlay, you will need to work directly with the <code>Drawing</code> object and its contained elements. This requires a deeper understanding of how openpyxl handles drawings which is best explored through detailed examples in the official documentation.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.drawing.image <span class="im">import</span> Image</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image(<span class="st">"my_image.png"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>drawing <span class="op">=</span> sheet.add_image(img, <span class="st">"A1"</span>) <span class="co"># drawing now holds reference to the added image</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing and modifying drawing properties (see below for details)</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"drawing_example.xlsx"</span>)</span></code></pre></div>
<p>The specific properties and methods of the <code>drawing</code> object for detailed manipulation are best consulted in the openpyxl documentation.</p>
<h3 id="resizing-and-positioning-images">Resizing and Positioning Images</h3>
<p>While <code>add_image</code> initially places and sizes the image based on the cell, you can manually adjust the size and position using the <code>width</code>, <code>height</code>, <code>anchor</code>, and <code>left</code>, <code>top</code> attributes of the underlying <code>Drawing</code> object. Note: Directly changing cell anchors might lead to unexpected layout issues. For precise control, work directly with the pixel coordinates (<code>left</code>, <code>top</code>) and dimensions (<code>width</code>, <code>height</code>) of the <code>Drawing</code> object.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.drawing.image <span class="im">import</span> Image</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.utils.units <span class="im">import</span> pixels_to_EMU</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> Image(<span class="st">"my_image.png"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>drawing <span class="op">=</span> sheet.add_image(img, <span class="st">"A1"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Resize the image (in EMUs - English Metric Units)</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>drawing.width <span class="op">=</span> pixels_to_EMU(<span class="dv">200</span>)  <span class="co"># Width in pixels, converted to EMUs</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>drawing.height <span class="op">=</span> pixels_to_EMU(<span class="dv">150</span>) <span class="co"># Height in pixels, converted to EMUs</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Reposition the image (in EMUs) - Top-left corner</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>drawing.left <span class="op">=</span> pixels_to_EMU(<span class="dv">100</span>)  <span class="co"># Left offset in pixels, converted to EMUs</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>drawing.top <span class="op">=</span> pixels_to_EMU(<span class="dv">50</span>)  <span class="co"># Top offset in pixels, converted to EMUs</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"resized_image.xlsx"</span>)</span></code></pre></div>
<p>The <code>pixels_to_EMU</code> function from <code>openpyxl.utils.units</code> is crucial for correct conversion from pixel units to EMUs, which are the units used by openpyxl for drawing objects.</p>
<h3 id="image-formats">Image Formats</h3>
<p>openpyxl supports various image formats, including PNG, JPEG, GIF, and others. The specific formats supported depend on the underlying libraries used by openpyxl (usually Pillow). If you encounter issues with a specific format, check your Pillow installation and ensure it supports that format. PNG is generally recommended for lossless image quality.</p>
<h2 id="working-with-tables">Working with Tables</h2>
<h3 id="creating-tables">Creating Tables</h3>
<p>openpyxl provides functionality to work with Excel tables (also known as ListObjects). Creating a table involves specifying a range of cells and optionally providing a table name.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.worksheet.table <span class="im">import</span> Table, TableStyleInfo</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Name'</span>, <span class="st">'Age'</span>, <span class="st">'City'</span>],</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Alice'</span>, <span class="dv">30</span>, <span class="st">'New York'</span>],</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Bob'</span>, <span class="dv">25</span>, <span class="st">'London'</span>],</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Charlie'</span>, <span class="dv">35</span>, <span class="st">'Paris'</span>],</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> data:</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    sheet.append(row)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table from cells A1 to C4</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> Table(displayName<span class="op">=</span><span class="st">"MyTable"</span>, ref<span class="op">=</span><span class="st">"A1:C4"</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a table style (optional)</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>style <span class="op">=</span> TableStyleInfo(name<span class="op">=</span><span class="st">"TableStyleMedium9"</span>, showFirstColumn<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                       showLastColumn<span class="op">=</span><span class="va">False</span>, showRowStripes<span class="op">=</span><span class="va">True</span>, showColumnStripes<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>table.tableStyleInfo <span class="op">=</span> style</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the table to the worksheet</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>sheet.add_table(table)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"table_example.xlsx"</span>)</span></code></pre></div>
<p>This creates a table named “MyTable” encompassing the data from A1 to C4, applying a predefined style. You can find a list of available table styles in the openpyxl documentation.</p>
<h3 id="formatting-tables">Formatting Tables</h3>
<p>Table formatting involves applying styles to the table’s appearance, such as header row styles, banded rows, total row, etc. This is done by modifying the <code>tableStyleInfo</code> attribute of the <code>Table</code> object. You can choose from predefined styles or create custom styles.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.worksheet.table <span class="im">import</span> Table, TableStyleInfo</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (table creation as above) ...</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Custom Style Example</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>custom_style <span class="op">=</span> TableStyleInfo(name<span class="op">=</span><span class="st">"CustomTableStyle"</span>, showFirstColumn<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                             showLastColumn<span class="op">=</span><span class="va">False</span>, showRowStripes<span class="op">=</span><span class="va">True</span>, showColumnStripes<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                             pivotButton<span class="op">=</span><span class="va">True</span>) <span class="co"># Enables Pivot Button.</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>custom_style.font <span class="op">=</span> <span class="st">"Arial,12"</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>custom_style.fill <span class="op">=</span> {<span class="st">"type"</span>: <span class="st">"solid"</span>, <span class="st">"fgColor"</span>: <span class="st">"FFFFCC"</span>}</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>table.tableStyleInfo <span class="op">=</span> custom_style</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (add table and save workbook) ...</span></span></code></pre></div>
<p>Refer to the openpyxl documentation for details on customizing table styles. Note that not all style elements are fully customizable, and some properties might not be reflected in all Excel versions.</p>
<h3 id="working-with-table-data">Working with Table Data</h3>
<p>Accessing and modifying data within a table is similar to working with regular cells. You can directly access cells using their coordinates or iterate through rows and columns.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> load_workbook</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> load_workbook(<span class="st">"table_example.xlsx"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> sheet[<span class="st">"MyTable"</span>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing a specific cell</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>cell_value <span class="op">=</span> table[<span class="st">"A2"</span>].value</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Value of A2: </span><span class="sc">{</span>cell_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterating through rows</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> table.rows:</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cell <span class="kw">in</span> row:</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(cell.value)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a new row to the table</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>table.add_row([<span class="st">'David'</span>, <span class="dv">40</span>, <span class="st">'Tokyo'</span>])</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"updated_table.xlsx"</span>)</span></code></pre></div>
<p>Adding rows usually appends to the end of the table. Deleting rows or columns requires careful handling of the table’s structure and might need updating the table’s reference range using <code>table.ref</code>.</p>
<h3 id="filtering-and-sorting">Filtering and Sorting</h3>
<p>openpyxl’s support for directly manipulating Excel filters and sorts is limited. You can set filter criteria through manual manipulation of the XML structure, which is highly advanced and not recommended unless you’re dealing with low-level XML manipulation of the <code>.xlsx</code> file. If you need robust filtering and sorting capabilities, it’s generally better to leverage Excel’s built-in functionality or use other libraries designed specifically for data manipulation and analysis. These external tools (e.g., Pandas) may be better suited for filtering and sorting before writing data back to the spreadsheet using openpyxl.</p>
<h2 id="advanced-features">Advanced Features</h2>
<h3 id="working-with-pivot-tables">Working with Pivot Tables</h3>
<p>Creating and modifying pivot tables directly within openpyxl is currently not fully supported. The structure of pivot tables in the <code>.xlsx</code> file is complex, requiring detailed manipulation of the underlying XML. While you can technically access and potentially modify some aspects of existing pivot tables through low-level XML manipulation, this approach is highly discouraged due to its complexity, fragility, and lack of robustness. The official openpyxl documentation explicitly cautions against this. For creating and managing pivot tables, it’s generally far more practical and reliable to use Excel’s built-in pivot table functionality or to process the data externally using libraries like Pandas before writing the results back to the spreadsheet using openpyxl.</p>
<h3 id="data-validation">Data Validation</h3>
<p>Data validation rules in Excel can be added and modified using openpyxl, but it’s an advanced feature that involves manipulating the XML structure representing the validation rules. Direct programmatic creation and modification of data validation rules is not explicitly straightforward. The process often involves creating <code>DataValidation</code> objects with properties that specify the validation type (e.g., whole number, list, date), criteria, input message, and error message. These objects are then added to the worksheet using methods associated with the <code>worksheet</code> object. Consult the openpyxl documentation for detailed examples and API information on the <code>DataValidation</code> class and its various properties and options, as the process is complex and requires careful attention to the XML structure of the validation rules.</p>
<h3 id="macros-and-vba-if-applicable">Macros and VBA (if applicable)</h3>
<p>openpyxl’s core functionality focuses on spreadsheet data and structure; it doesn’t directly support creating or manipulating VBA macros. You cannot create or edit VBA macros using openpyxl. If your workflow involves macros, you’ll likely need to use external tools or libraries specialized in handling VBA code within Excel files.</p>
<h3 id="external-links">External Links</h3>
<p>openpyxl can handle external links within spreadsheets. When loading a workbook, openpyxl will detect and retain information about external links, even if it doesn’t actively resolve them. Modifying or adding external links usually involves low-level XML manipulation of the workbook’s relationships, which is a complex task best left to advanced users well-versed in the XML structure of <code>.xlsx</code> files. The openpyxl documentation provides limited guidance on this, typically suggesting the use of external tools or libraries for tasks heavily involving linked workbooks.</p>
<h3 id="protecting-worksheets-and-workbooks">Protecting Worksheets and Workbooks</h3>
<p>openpyxl supports protecting worksheets and workbooks to restrict access and modifications. This is done by setting appropriate properties on the worksheet or workbook object.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl <span class="im">import</span> Workbook</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.worksheet.protection <span class="im">import</span> WorksheetProtection</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> openpyxl.workbook.protection <span class="im">import</span> WorkbookProtection</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> Workbook()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>sheet <span class="op">=</span> workbook.active</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Worksheet protection</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>sheet_protection <span class="op">=</span> WorksheetProtection()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>sheet_protection.sheet <span class="op">=</span> <span class="va">True</span>  <span class="co"># Protect the entire sheet</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>sheet_protection.objects <span class="op">=</span> <span class="va">True</span>  <span class="co"># Prevent modification of objects</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>sheet.protection <span class="op">=</span> sheet_protection</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Workbook protection (password protected)</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>workbook_protection <span class="op">=</span> WorkbookProtection()</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>workbook_protection.set_password(<span class="st">'mypassword'</span>) <span class="co">#Set a password (Note: security limitations exist)</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>workbook.protection <span class="op">=</span> workbook_protection</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>workbook.save(<span class="st">"protected_workbook.xlsx"</span>)</span></code></pre></div>
<p>Remember that the password protection provided by openpyxl is relatively basic and may not be sufficient for high-security applications. Advanced protection mechanisms are best handled by Excel’s built-in security features or through external encryption methods. The password used here is not cryptographically secure.</p>
<h2 id="error-handling-and-best-practices">Error Handling and Best Practices</h2>
<h3 id="common-errors-and-troubleshooting">Common Errors and Troubleshooting</h3>
<p>Several common errors arise when using openpyxl:</p>
<ul>
<li><p><strong><code>FileNotFoundError</code>:</strong> Occurs when trying to load a workbook that doesn’t exist. Always check file existence before loading.</p></li>
<li><p><strong><code>KeyError</code>:</strong> Happens when accessing a worksheet or cell that doesn’t exist. Verify worksheet names and cell coordinates.</p></li>
<li><p><strong><code>ValueError</code>:</strong> Can be caused by incorrect data types, invalid cell references, or other data inconsistencies. Carefully check your input data and indexing.</p></li>
<li><p><strong><code>TypeError</code>:</strong> Arises from using incorrect data types or calling methods inappropriately. Ensure data types match expected types and review method signatures.</p></li>
</ul>
<p>Troubleshooting involves carefully examining error messages, checking input data, and using debugging tools to step through your code and identify the source of the problem. The openpyxl documentation and online forums often contain solutions to common issues.</p>
<h3 id="performance-optimization">Performance Optimization</h3>
<p>For optimal performance:</p>
<ul>
<li><p><strong>Iterators:</strong> Use iterators (<code>iter_rows</code>, <code>iter_cols</code>) to process large worksheets efficiently instead of loading the entire worksheet into memory at once.</p></li>
<li><p><strong>Data Chunking:</strong> If dealing with extremely large files, consider processing data in smaller chunks to reduce memory consumption.</p></li>
<li><p><strong>Avoid Unnecessary Operations:</strong> Minimize repeated accesses to cells or unnecessary calculations.</p></li>
<li><p><strong>Profiling:</strong> Use profiling tools to identify performance bottlenecks in your code.</p></li>
</ul>
<h3 id="memory-management">Memory Management</h3>
<p>Memory management is crucial when working with large Excel files. Openpyxl uses generators and iterators where possible to minimize memory usage, but for very large files, additional strategies are necessary:</p>
<ul>
<li><p><strong>Iterators (again!):</strong> Emphasize the use of iterators to process data incrementally instead of loading everything at once.</p></li>
<li><p><strong>Garbage Collection:</strong> Python’s garbage collection will automatically reclaim memory, but you can occasionally force garbage collection using <code>gc.collect()</code> (though this is usually unnecessary).</p></li>
<li><p><strong>Context Managers:</strong> Use context managers (<code>with openpyxl.load_workbook(...) as wb: ...</code>) to ensure files are properly closed and resources released.</p></li>
<li><p><strong>Chunking (again!):</strong> Process data in logical chunks, saving intermediate results if needed to reduce memory demands for any single operation.</p></li>
</ul>
<h3 id="large-files-and-efficient-processing">Large Files and Efficient Processing</h3>
<p>For very large Excel files (&gt;100MB), efficient processing is vital. Employ these techniques:</p>
<ul>
<li><p><strong>Memory Mapping:</strong> Consider using memory-mapped files to reduce memory overhead (though this adds complexity).</p></li>
<li><p><strong>Incremental Processing:</strong> Process data in stages, saving progress to avoid restarting from the beginning if an error occurs or if processing needs to be interrupted.</p></li>
<li><p><strong>Parallel Processing:</strong> If appropriate, explore using multiprocessing to distribute the workload across multiple CPU cores.</p></li>
<li><p><strong>External Libraries:</strong> For extensive data manipulation, consider using optimized libraries like Pandas which are designed for handling large datasets efficiently. Use openpyxl to read/write the data to the Excel file, using Pandas for in-memory processing.</p></li>
</ul>
<h3 id="security-considerations">Security Considerations</h3>
<ul>
<li><p><strong>Input Validation:</strong> Always validate user inputs to prevent malicious code injection or data corruption.</p></li>
<li><p><strong>Password Protection (Limitations):</strong> Be aware that the password protection provided by openpyxl is relatively weak; it’s not suitable for highly sensitive data.</p></li>
<li><p><strong>External Links:</strong> Exercise caution when working with workbooks containing external links to prevent unintended access to external resources.</p></li>
<li><p><strong>File Permissions:</strong> Control file permissions to restrict access to your Excel files.</p></li>
<li><p><strong>Sanitize Data:</strong> Sanitize any data read from an Excel file before using it in other parts of your application to avoid unexpected issues or security risks. This includes checking for unexpected data types or values.</p></li>
<li><p><strong>Do not use openpyxl to handle untrusted files</strong>: Always verify the integrity and source of any Excel files you work with before opening them or processing their contents. Untrusted files can easily introduce security vulnerabilities into your application.</p></li>
</ul>
<h2 id="appendix-reference-tables-and-apis">Appendix: Reference Tables and APIs</h2>
<p>This appendix provides a concise overview of openpyxl’s key components. For detailed and comprehensive information, always refer to the official openpyxl documentation. This section offers a starting point and highlights key areas.</p>
<h3 id="list-of-functions-and-methods">List of Functions and Methods</h3>
<p>openpyxl offers a wide range of functions and methods. A complete list is beyond the scope of this manual, but key examples include:</p>
<ul>
<li><strong><code>load_workbook(filename)</code>:</strong> Loads an existing Excel workbook.</li>
<li><strong><code>Workbook()</code>:</strong> Creates a new workbook.</li>
<li><strong><code>workbook.active</code>:</strong> Returns the active worksheet.</li>
<li><strong><code>workbook.create_sheet(title, index=None, before=None)</code>:</strong> Creates a new worksheet.</li>
<li><strong><code>workbook.save(filename)</code>:</strong> Saves the workbook to a file.</li>
<li><strong><code>worksheet['A1']</code>:</strong> Accesses a cell by its coordinates.</li>
<li><strong><code>worksheet.cell(row, column)</code>:</strong> Accesses a cell using row and column numbers.</li>
<li><strong><code>worksheet.iter_rows()</code>:</strong> Iterates through rows in a range.</li>
<li><strong><code>worksheet.iter_cols()</code>:</strong> Iterates through columns in a range.</li>
<li><strong><code>cell.value</code>:</strong> Gets or sets the cell’s value.</li>
<li><strong><code>cell.font</code>:</strong> Gets or sets the cell’s font style.</li>
<li><strong><code>cell.fill</code>:</strong> Gets or sets the cell’s fill color.</li>
<li><strong><code>cell.alignment</code>:</strong> Gets or sets the cell’s alignment.</li>
<li><strong><code>cell.number_format</code>:</strong> Gets or sets the cell’s number format.</li>
<li><strong><code>chart.add_data()</code>:</strong> Adds data to a chart.</li>
<li><strong><code>sheet.add_chart()</code>:</strong> Adds a chart to a worksheet.</li>
<li><strong><code>Image(filename)</code>:</strong> Creates an image object.</li>
<li><strong><code>sheet.add_image()</code>:</strong> Adds an image to a worksheet.</li>
<li><strong><code>Table(displayName, ref)</code>:</strong> Creates an Excel table.</li>
<li><strong><code>sheet.add_table()</code>:</strong> Adds a table to a worksheet.</li>
</ul>
<p>This is not exhaustive; explore the official API documentation for the complete list.</p>
<h3 id="data-structures">Data Structures</h3>
<p>Key data structures in openpyxl include:</p>
<ul>
<li><strong><code>Workbook</code>:</strong> Represents the entire Excel file.</li>
<li><strong><code>Worksheet</code>:</strong> Represents a single sheet within a workbook.</li>
<li><strong><code>Cell</code>:</strong> Represents an individual cell in a worksheet.</li>
<li><strong><code>Reference</code>:</strong> Defines a range of cells.</li>
<li><strong><code>Table</code>:</strong> Represents an Excel table (ListObject).</li>
<li><strong><code>Chart</code>:</strong> Base class for various chart types. Specific chart types (like <code>BarChart</code>, <code>LineChart</code>) inherit from this.</li>
<li><strong><code>Font</code>, <code>PatternFill</code>, <code>Alignment</code>, <code>Border</code>, <code>Side</code>:</strong> Style classes for formatting cells.</li>
<li><strong><code>Image</code>:</strong> Represents an image to be added to a worksheet.</li>
<li><strong><code>Drawing</code>:</strong> A container for drawings and images within the worksheet.</li>
</ul>
<p>Understanding these core structures is fundamental to effectively using openpyxl.</p>
<h3 id="constants-and-enumerations">Constants and Enumerations</h3>
<p>openpyxl uses constants and enumerations to represent various options and settings (e.g., alignment types, fill types, border styles, chart types). Consult the official documentation for a comprehensive list. Examples include constants representing different alignment types within the <code>Alignment</code> class or constants specifying different fill types in <code>PatternFill</code>.</p>
<h3 id="api-reference">API Reference</h3>
<p>The most complete API reference is always found in the official openpyxl documentation. This documentation provides detailed descriptions of all classes, methods, functions, and attributes within the library. It’s the definitive source for understanding the capabilities and usage of openpyxl. The API reference typically includes examples, parameters, return values, and explanations of each component. This allows developers to quickly look up the specifics of functions and classes to help them write efficient and correct code.</p>


<footer>Copyright 2025 - Muthukrishnan</footer>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3609399560636561" crossorigin="anonymous"></script>




</body></html>