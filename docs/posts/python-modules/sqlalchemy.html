<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Muthukrishnan">

<title>sqlalchemy - Documentation – Technical Manuals</title>
<style>
html {
  color: #1a1a1a;
  background-color: #fdfdfd;
}
body {
  margin: 0 auto;
  max-width: 36em;
  padding-left: 50px;
  padding-right: 50px;
  padding-top: 50px;
  padding-bottom: 50px;
  hyphens: auto;
  overflow-wrap: break-word;
  text-rendering: optimizeLegibility;
  font-kerning: normal;
}
@media (max-width: 600px) {
  body {
    font-size: 0.9em;
    padding: 12px;
  }
  h1 {
    font-size: 1.8em;
  }
}
@media print {
  html {
    background-color: white;
  }
  body {
    background-color: transparent;
    color: black;
    font-size: 12pt;
  }
  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }
  h2, h3, h4 {
    page-break-after: avoid;
  }
}
p {
  margin: 1em 0;
}
a {
  color: #1a1a1a;
}
a:visited {
  color: #1a1a1a;
}
img {
  max-width: 100%;
}
svg {
  height; auto;
  max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
  margin-top: 1.4em;
}
h5, h6 {
  font-size: 1em;
  font-style: italic;
}
h6 {
  font-weight: normal;
}
ol, ul {
  padding-left: 1.7em;
  margin-top: 1em;
}
li > ol, li > ul {
  margin-top: 0;
}
ul > li:not(:has(> p)) > ul,
ol > li:not(:has(> p)) > ul,
ul > li:not(:has(> p)) > ol,
ol > li:not(:has(> p)) > ol {
  margin-bottom: 0;
}
ul > li:not(:has(> p)) > ul > li:has(> p),
ol > li:not(:has(> p)) > ul > li:has(> p),
ul > li:not(:has(> p)) > ol > li:has(> p),
ol > li:not(:has(> p)) > ol > li:has(> p) {
  margin-top: 1rem;
}
blockquote {
  margin: 1em 0 1em 1.7em;
  padding-left: 1em;
  border-left: 2px solid #e6e6e6;
  color: #606060;
}
code {
  font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
  font-size: 85%;
  margin: 0;
  hyphens: manual;
}
pre {
  margin: 1em 0;
  overflow: auto;
}
pre code {
  padding: 0;
  overflow: visible;
  overflow-wrap: normal;
}
.sourceCode {
 background-color: transparent;
 overflow: visible;
}
hr {
  background-color: #1a1a1a;
  border: none;
  height: 1px;
  margin: 1em 0;
}
table {
  margin: 1em 0;
  border-collapse: collapse;
  width: 100%;
  overflow-x: auto;
  display: block;
  font-variant-numeric: lining-nums tabular-nums;
}
table caption {
  margin-bottom: 0.75em;
}
tbody {
  margin-top: 0.5em;
  border-top: 1px solid #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
}
th {
  border-top: 1px solid #1a1a1a;
  padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
  padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
  margin-bottom: 4em;
  text-align: center;
}
#TOC li {
  list-style: none;
}
#TOC ul {
  padding-left: 1.3em;
}
#TOC > ul {
  padding-left: 0;
}
#TOC a:not(:hover) {
  text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<link href="../../favicon.ico" rel="icon">
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MXDPF6L5TL"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-MXDPF6L5TL', { 'anonymize_ip': true});
</script>
<link rel="icon" type="image/x-icon" href="favicon.ico">
<meta property="og:title" content="sqlalchemy - Documentation – Technical Manuals">
<meta property="og:site_name" content="Technical Manuals">
</head><body><div class="navigation-header">
    <nav>
        <div>
            <div class="logo">
                <a href="../../" aria-label="Home">
                    <span>Technical Manuals - Home</span>
                </a>
            </div>
            <div class="nav-menu">
                <ul>
                    <li>
                        <a href="../../about.html">
                            <span class="menu-text">About</span>
                        </a>
                    </li>
                    <li> 
                        <a href="https://github.com/muthuspark" target="_blank">
                            <span class="menu-text">Github</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/krimuthu" target="_blank">
                            <span class="menu-text">Linkedin</span>
                        </a>
                    </li>
                    <li>
                        <button onclick="window.print()" class="print-button">
                            <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M6 9V2h12v7"></path>
                              <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
                              <path d="M6 14h12v8H6z"></path>
                            </svg>
                            Print Page
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>


<link rel="stylesheet" href="../../styles.css">





<header id="title-block-header">
<h1 class="title">sqlalchemy - Documentation</h1>

</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#core-concepts" id="toc-core-concepts">Core Concepts</a>
  <ul>
  <li><a href="#object-relational-mapper-orm" id="toc-object-relational-mapper-orm">Object Relational Mapper (ORM)</a></li>
  <li><a href="#declarative-mapping" id="toc-declarative-mapping">Declarative Mapping</a></li>
  <li><a href="#session-management" id="toc-session-management">Session Management</a></li>
  <li><a href="#data-modeling" id="toc-data-modeling">Data Modeling</a></li>
  <li><a href="#querying" id="toc-querying">Querying</a></li>
  <li><a href="#relationships" id="toc-relationships">Relationships</a></li>
  </ul></li>
  <li><a href="#installation-and-setup" id="toc-installation-and-setup">Installation and Setup</a>
  <ul>
  <li><a href="#installing-sqlalchemy" id="toc-installing-sqlalchemy">Installing SQLAlchemy</a></li>
  <li><a href="#database-drivers" id="toc-database-drivers">Database Drivers</a></li>
  <li><a href="#connecting-to-a-database" id="toc-connecting-to-a-database">Connecting to a Database</a></li>
  <li><a href="#configuring-connection-pools" id="toc-configuring-connection-pools">Configuring Connection Pools</a></li>
  <li><a href="#setting-up-an-engine" id="toc-setting-up-an-engine">Setting up an Engine</a></li>
  </ul></li>
  <li><a href="#declarative-mapping-1" id="toc-declarative-mapping-1">Declarative Mapping</a>
  <ul>
  <li><a href="#defining-models" id="toc-defining-models">Defining Models</a></li>
  <li><a href="#table-definitions" id="toc-table-definitions">Table Definitions</a></li>
  <li><a href="#data-types" id="toc-data-types">Data Types</a></li>
  <li><a href="#relationships-one-to-one-one-to-many-many-to-many" id="toc-relationships-one-to-one-one-to-many-many-to-many">Relationships (One-to-one, One-to-many, Many-to-many)</a></li>
  <li><a href="#inheritance-mappings" id="toc-inheritance-mappings">Inheritance Mappings</a></li>
  <li><a href="#attributes-and-properties" id="toc-attributes-and-properties">Attributes and Properties</a></li>
  <li><a href="#backrefs" id="toc-backrefs">Backrefs</a></li>
  </ul></li>
  <li><a href="#session-management-1" id="toc-session-management-1">Session Management</a>
  <ul>
  <li><a href="#creating-sessions" id="toc-creating-sessions">Creating Sessions</a></li>
  <li><a href="#adding-updating-and-deleting-objects" id="toc-adding-updating-and-deleting-objects">Adding, Updating, and Deleting Objects</a></li>
  <li><a href="#committing-transactions" id="toc-committing-transactions">Committing Transactions</a></li>
  <li><a href="#rolling-back-transactions" id="toc-rolling-back-transactions">Rolling Back Transactions</a></li>
  <li><a href="#session-scoping" id="toc-session-scoping">Session Scoping</a></li>
  <li><a href="#unit-of-work-pattern" id="toc-unit-of-work-pattern">Unit of Work Pattern</a></li>
  <li><a href="#managing-session-identity" id="toc-managing-session-identity">Managing Session Identity</a></li>
  </ul></li>
  <li><a href="#querying-1" id="toc-querying-1">Querying</a>
  <ul>
  <li><a href="#core-querying-techniques" id="toc-core-querying-techniques">Core Querying Techniques</a></li>
  <li><a href="#filtering-data-where-clause" id="toc-filtering-data-where-clause">Filtering Data (WHERE clause)</a></li>
  <li><a href="#sorting-data-order-by-clause" id="toc-sorting-data-order-by-clause">Sorting Data (ORDER BY clause)</a></li>
  <li><a href="#pagination-limit-offset" id="toc-pagination-limit-offset">Pagination (LIMIT, OFFSET)</a></li>
  <li><a href="#joining-tables" id="toc-joining-tables">Joining Tables</a></li>
  <li><a href="#aggregations-count-sum-avg-etc." id="toc-aggregations-count-sum-avg-etc.">Aggregations (COUNT, SUM, AVG, etc.)</a></li>
  <li><a href="#subqueries" id="toc-subqueries">Subqueries</a></li>
  <li><a href="#using-expressions" id="toc-using-expressions">Using Expressions</a></li>
  <li><a href="#functional-querying" id="toc-functional-querying">Functional Querying</a></li>
  </ul></li>
  <li><a href="#relationships-1" id="toc-relationships-1">Relationships</a>
  <ul>
  <li><a href="#one-to-one-relationships" id="toc-one-to-one-relationships">One-to-one Relationships</a></li>
  <li><a href="#one-to-many-relationships" id="toc-one-to-many-relationships">One-to-many Relationships</a></li>
  <li><a href="#many-to-many-relationships" id="toc-many-to-many-relationships">Many-to-many Relationships</a></li>
  <li><a href="#self-referential-relationships" id="toc-self-referential-relationships">Self-referential Relationships</a></li>
  <li><a href="#backrefs-and-lazy-loading" id="toc-backrefs-and-lazy-loading">Backrefs and Lazy Loading</a></li>
  <li><a href="#relationship-attributes" id="toc-relationship-attributes">Relationship Attributes</a></li>
  </ul></li>
  <li><a href="#advanced-topics" id="toc-advanced-topics">Advanced Topics</a>
  <ul>
  <li><a href="#hybrid-properties" id="toc-hybrid-properties">Hybrid Properties</a></li>
  <li><a href="#events-and-listeners" id="toc-events-and-listeners">Events and Listeners</a></li>
  <li><a href="#custom-types" id="toc-custom-types">Custom Types</a></li>
  <li><a href="#schema-generation" id="toc-schema-generation">Schema Generation</a></li>
  <li><a href="#migrations" id="toc-migrations">Migrations</a></li>
  <li><a href="#testing-with-sqlalchemy" id="toc-testing-with-sqlalchemy">Testing with SQLAlchemy</a></li>
  <li><a href="#performance-tuning" id="toc-performance-tuning">Performance Tuning</a></li>
  <li><a href="#connection-pooling" id="toc-connection-pooling">Connection Pooling</a></li>
  <li><a href="#transactions" id="toc-transactions">Transactions</a></li>
  </ul></li>
  <li><a href="#orm-specific-features" id="toc-orm-specific-features">ORM-Specific Features</a>
  <ul>
  <li><a href="#querying-techniques-for-orms" id="toc-querying-techniques-for-orms">Querying Techniques for ORMs</a></li>
  <li><a href="#object-relational-mapping-details" id="toc-object-relational-mapping-details">Object-Relational Mapping Details</a></li>
  <li><a href="#orm-relationship-mapping-specifics" id="toc-orm-relationship-mapping-specifics">ORM Relationship Mapping Specifics</a></li>
  <li><a href="#orm-transactions" id="toc-orm-transactions">ORM Transactions</a></li>
  </ul></li>
  <li><a href="#examples-and-use-cases" id="toc-examples-and-use-cases">Examples and Use Cases</a>
  <ul>
  <li><a href="#simple-crud-operations" id="toc-simple-crud-operations">Simple CRUD Operations</a></li>
  <li><a href="#complex-queries" id="toc-complex-queries">Complex Queries</a></li>
  <li><a href="#working-with-multiple-tables" id="toc-working-with-multiple-tables">Working with Multiple Tables</a></li>
  <li><a href="#building-a-web-application-with-sqlalchemy" id="toc-building-a-web-application-with-sqlalchemy">Building a Web Application with SQLAlchemy</a></li>
  <li><a href="#real-world-application-examples" id="toc-real-world-application-examples">Real-World Application Examples</a></li>
  </ul></li>
  <li><a href="#appendix-reference" id="toc-appendix-reference">Appendix: Reference</a>
  <ul>
  <li><a href="#glossary-of-terms" id="toc-glossary-of-terms">Glossary of Terms</a></li>
  <li><a href="#api-documentation-links" id="toc-api-documentation-links">API Documentation Links</a></li>
  <li><a href="#error-messages" id="toc-error-messages">Error Messages</a></li>
  </ul></li>
  </ul>
</nav>
<h2 id="core-concepts">Core Concepts</h2>
<h3 id="object-relational-mapper-orm">Object Relational Mapper (ORM)</h3>
<p>SQLAlchemy’s Object Relational Mapper (ORM) provides a high-level abstraction over database interactions. Instead of writing raw SQL queries, developers work with Python objects that represent database tables and rows. The ORM handles the translation between Python objects and database structures, greatly simplifying database access and reducing the amount of boilerplate code. Key benefits include improved code readability, maintainability, and database portability. The ORM layer sits atop SQLAlchemy’s Core, offering a flexible and powerful way to interact with databases. Understanding the Core concepts, however, will help to troubleshoot complex scenarios and optimize performance.</p>
<h3 id="declarative-mapping">Declarative Mapping</h3>
<p>Declarative mapping is a powerful feature within SQLAlchemy’s ORM that allows developers to define database tables and their mappings using Python classes and decorators. This approach eliminates much of the configuration needed in traditional ORM setups. By leveraging Python’s class structure and attributes, developers declaratively specify table names, column types, relationships, and other metadata. This declarative style results in more concise and readable code, especially for complex database schemas. The <code>declarative_base()</code> function is central to this approach, providing a base class from which all mapped classes inherit.</p>
<h3 id="session-management">Session Management</h3>
<p>The SQLAlchemy <code>Session</code> object is the central point of interaction between the application and the database. It manages the lifecycle of persistent objects, including adding, updating, deleting, and querying data. Sessions act as a transactional boundary, ensuring data consistency. Proper session management is critical for application stability and data integrity. Key aspects include creating sessions, managing transactions (using <code>begin()</code>, <code>commit()</code>, <code>rollback()</code>), and closing sessions. Understanding the difference between different session strategies (e.g., scoped session, thread-local session) is crucial for building scalable applications.</p>
<h3 id="data-modeling">Data Modeling</h3>
<p>Data modeling in SQLAlchemy involves defining the structure of the data that will be stored in the database. This is accomplished through the use of mapped classes, which represent database tables. Each attribute of a mapped class corresponds to a column in the database table. Data types are specified using SQLAlchemy’s type system, allowing for precise control over how data is stored. The design of your data model significantly influences the performance and maintainability of your application, so careful consideration should be given to database normalization and efficient data structures.</p>
<h3 id="querying">Querying</h3>
<p>SQLAlchemy’s ORM provides a flexible and powerful query system. The <code>Query</code> object allows developers to construct complex queries using a Pythonic API. Common operations such as filtering (<code>filter()</code>), sorting (<code>order_by()</code>), joining (<code>join()</code>), pagination (<code>limit()</code>, <code>offset()</code>), and aggregation (<code>func.*</code>) can be performed easily. The ORM translates these queries into efficient SQL statements, abstracting away the underlying database details. Understanding the <code>Query</code> object’s capabilities is essential for effectively retrieving and manipulating data from the database.</p>
<h3 id="relationships">Relationships</h3>
<p>Relationships define how different tables in a database relate to each other (one-to-one, one-to-many, many-to-many). SQLAlchemy’s ORM supports these relationships through declarative mappings. By defining relationships, developers can easily navigate between related objects in Python code. Understanding the different types of relationships and how to define them correctly is crucial for building data models that accurately reflect the real-world relationships between entities. The ORM handles the underlying SQL joins and ensures data consistency. Backrefs allow for easy access to related objects from both sides of the relationship.</p>
<h2 id="installation-and-setup">Installation and Setup</h2>
<h3 id="installing-sqlalchemy">Installing SQLAlchemy</h3>
<p>SQLAlchemy is primarily installed via <code>pip</code>, the Python package installer. Open your terminal or command prompt and execute the following command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install sqlalchemy</span></code></pre></div>
<p>This installs the core SQLAlchemy library. Additional packages might be needed depending on the specific database you intend to use (see the section on Database Drivers below). For more advanced features or specific needs, you may wish to explore extra packages available via PyPI, such as <code>sqlalchemy-utils</code>. Always consult the latest SQLAlchemy documentation for the most up-to-date installation instructions and recommendations.</p>
<h3 id="database-drivers">Database Drivers</h3>
<p>SQLAlchemy itself doesn’t include database drivers. You’ll need to install a driver specific to your chosen database system. These drivers provide the low-level connection and communication capabilities. Here are some examples:</p>
<ul>
<li><strong>PostgreSQL:</strong> <code>psycopg2-binary</code></li>
<li><strong>MySQL:</strong> <code>mysqlclient</code> or <code>PyMySQL</code></li>
<li><strong>SQLite:</strong> Usually included with Python, but may need <code>pysqlite3</code> for better performance.</li>
<li><strong>Oracle:</strong> <code>cx_Oracle</code></li>
<li><strong>Microsoft SQL Server:</strong> <code>pyodbc</code></li>
</ul>
<p>Install the appropriate driver using <code>pip</code> before attempting to connect to your database. For instance, to install the <code>psycopg2-binary</code> driver for PostgreSQL:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install psycopg2-binary</span></code></pre></div>
<h3 id="connecting-to-a-database">Connecting to a Database</h3>
<p>Connecting to a database involves creating a connection URL which specifies the database type, host, port, database name, username, and password. SQLAlchemy uses this URL to establish a connection. The general format is:</p>
<pre><code>dialect+driver://username:password@host:port/database</code></pre>
<p>For example, a PostgreSQL connection URL might look like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">"postgresql://user:password@host:5432/mydatabase"</span>)</span></code></pre></div>
<p>Replace placeholders like <code>user</code>, <code>password</code>, <code>host</code>, <code>5432</code>, and <code>mydatabase</code> with your actual database credentials and settings. Different database dialects have slightly different URL formats; refer to the SQLAlchemy documentation for details on your specific database system.</p>
<h3 id="configuring-connection-pools">Configuring Connection Pools</h3>
<p>SQLAlchemy uses connection pools to manage database connections efficiently. Connection pooling prevents the overhead of repeatedly creating and closing connections, improving performance, especially in multi-threaded or multi-process applications. Connection pool settings can be configured when creating the engine. For example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">"postgresql://user:password@host:5432/mydatabase"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                       pool_size<span class="op">=</span><span class="dv">5</span>, max_overflow<span class="op">=</span><span class="dv">10</span>, pool_recycle<span class="op">=</span><span class="dv">3600</span>)</span></code></pre></div>
<p>This example sets the pool size to 5 (5 persistent connections), allows up to 10 overflow connections (created when all 5 are in use), and recycles connections every 3600 seconds (1 hour). Adjust these parameters based on your application’s needs and the database server’s capabilities.</p>
<h3 id="setting-up-an-engine">Setting up an Engine</h3>
<p>The <code>Engine</code> is the central object in SQLAlchemy, representing the database connection. It’s created using the <code>create_engine()</code> function, providing the database URL (as shown in “Connecting to a Database”) and optionally connection pool parameters. The engine is used to create connections, execute SQL statements (directly or via the ORM), and manage transactions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">"postgresql://user:password@host:5432/mydatabase"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ... later, use the engine to connect and interact with the database ...</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>engine.dispose()  <span class="co"># important: close the engine when finished</span></span></code></pre></div>
<p>Remember to dispose of the engine when you’re finished with it to release resources. The engine is typically created once and reused throughout the application’s lifetime.</p>
<h2 id="declarative-mapping-1">Declarative Mapping</h2>
<h3 id="defining-models">Defining Models</h3>
<p>Declarative mapping in SQLAlchemy uses Python classes to represent database tables. You define a base class using <code>declarative_base()</code> and then create subclasses to represent your tables. Each class attribute corresponds to a table column. For example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.declarative <span class="im">import</span> declarative_base</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> Column, Integer, String</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'users'</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    fullname <span class="op">=</span> Column(String)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    nickname <span class="op">=</span> Column(String)</span></code></pre></div>
<p>This defines a <code>User</code> model with an <code>id</code> (primary key), <code>name</code>, <code>fullname</code>, and <code>nickname</code> columns. The <code>__tablename__</code> attribute specifies the database table name.</p>
<h3 id="table-definitions">Table Definitions</h3>
<p>The <code>__tablename__</code> attribute in a declarative class defines the name of the database table that the class maps to. If omitted, SQLAlchemy will infer the table name from the class name (converting camel case to underscore). Other table-level metadata, such as indexes or unique constraints, can be added using the <code>__table_args__</code> attribute:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Address(Base):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'addresses'</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    email_address <span class="op">=</span> Column(String, unique<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    __table_args__ <span class="op">=</span> (UniqueConstraint(<span class="st">'email_address'</span>, name<span class="op">=</span><span class="st">'email_unique_constraint'</span>),)</span></code></pre></div>
<h3 id="data-types">Data Types</h3>
<p>SQLAlchemy provides a rich set of data types that correspond to various database column types. These types are used when defining the columns in your declarative classes. Examples include:</p>
<ul>
<li><code>Integer</code>: Integer values.</li>
<li><code>String</code>: String values (with optional length).</li>
<li><code>Boolean</code>: Boolean values.</li>
<li><code>Date</code>, <code>DateTime</code>: Date and DateTime values.</li>
<li><code>Float</code>, <code>Numeric</code>: Floating-point and numeric values.</li>
<li><code>Text</code>: Large text fields.</li>
<li><code>LargeBinary</code>: Binary data.</li>
</ul>
<h3 id="relationships-one-to-one-one-to-many-many-to-many">Relationships (One-to-one, One-to-many, Many-to-many)</h3>
<p>Relationships between tables are defined using SQLAlchemy’s relationship mechanism.</p>
<ul>
<li><strong>One-to-one:</strong> Use <code>relationship()</code> with <code>uselist=False</code>:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    address <span class="op">=</span> relationship(<span class="st">"Address"</span>, uselist<span class="op">=</span><span class="va">False</span>, backref<span class="op">=</span><span class="st">"user"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Address(Base):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span></code></pre></div>
<ul>
<li><strong>One-to-many:</strong> <code>relationship()</code> is used on the “one” side, automatically creating a foreign key on the “many” side:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    addresses <span class="op">=</span> relationship(<span class="st">"Address"</span>, backref<span class="op">=</span><span class="st">"user"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Address(Base):</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    user_id <span class="op">=</span> Column(Integer, ForeignKey(<span class="st">'users.id'</span>))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span></code></pre></div>
<ul>
<li><strong>Many-to-many:</strong> Requires a separate association table:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    addresses <span class="op">=</span> relationship(<span class="st">"Address"</span>, secondary<span class="op">=</span>user_address_table, backref<span class="op">=</span><span class="st">"users"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Address(Base):</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>user_address_table <span class="op">=</span> Table(<span class="st">'user_address'</span>, Base.metadata,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    Column(<span class="st">'user_id'</span>, Integer, ForeignKey(<span class="st">'users.id'</span>)),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    Column(<span class="st">'address_id'</span>, Integer, ForeignKey(<span class="st">'addresses.id'</span>))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<h3 id="inheritance-mappings">Inheritance Mappings</h3>
<p>SQLAlchemy supports several inheritance mapping strategies:</p>
<ul>
<li><strong>Single Table Inheritance:</strong> All classes inherit from a single base table.</li>
<li><strong>Joined Table Inheritance:</strong> Each class gets its own table, with a foreign key linking to the base table.</li>
<li><strong>Concrete Table Inheritance:</strong> Each class gets its own table, without any explicit linking to a base table.</li>
</ul>
<p>The choice depends on your application’s requirements and how you want to represent the data in your database.</p>
<h3 id="attributes-and-properties">Attributes and Properties</h3>
<p>Attributes in declarative classes are mapped to database columns. You can add custom properties or methods to your models as needed. Properties can be used to compute values or provide convenient access to related data:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> full_address(<span class="va">self</span>):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>address<span class="sc">.</span>street<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>address<span class="sc">.</span>city<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>address<span class="sc">.</span>state<span class="sc">}</span><span class="ss">"</span></span></code></pre></div>
<h3 id="backrefs">Backrefs</h3>
<p>Backrefs are a convenience feature provided by <code>relationship()</code> that allows you to access the related objects from the “many” side of a relationship. They automatically create an attribute on the “many” side class that points back to the “one” side. This simplifies navigation between related objects. As shown in the relationship examples above, the <code>backref</code> argument in <code>relationship()</code> is used to define the name of the backref attribute.</p>
<h2 id="session-management-1">Session Management</h2>
<h3 id="creating-sessions">Creating Sessions</h3>
<p>A SQLAlchemy <code>Session</code> object is the interface through which persistent objects are managed. You create a session using a <code>sessionmaker</code> factory object, which is typically configured with an <code>Engine</code> instance:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker, declarative_base</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">"sqlite:///mydatabase.db"</span>)  <span class="co"># Example using SQLite</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ... define your models (declarative classes) ...</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Session <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>session <span class="op">=</span> Session() </span></code></pre></div>
<p>The <code>bind</code> argument connects the <code>sessionmaker</code> to the database <code>engine</code>. Each call to <code>Session()</code> creates a new session instance.</p>
<h3 id="adding-updating-and-deleting-objects">Adding, Updating, and Deleting Objects</h3>
<p>The session tracks changes to objects. To add a new object, simply add it to the session:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>new_user <span class="op">=</span> User(name<span class="op">=</span><span class="st">"New User"</span>, fullname<span class="op">=</span><span class="st">"New Full Name"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>session.add(new_user) </span></code></pre></div>
<p>Updates are tracked automatically. Modify an existing object’s attributes, and the session will detect the changes:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>existing_user <span class="op">=</span> session.query(User).<span class="bu">filter</span>(User.name <span class="op">==</span> <span class="st">"Existing User"</span>).first()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>existing_user.fullname <span class="op">=</span> <span class="st">"Updated Full Name"</span></span></code></pre></div>
<p>To delete an object:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>session.delete(existing_user)</span></code></pre></div>
<h3 id="committing-transactions">Committing Transactions</h3>
<p>Changes made to objects in a session are not written to the database until the session’s transaction is committed using <code>commit()</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>session.commit()</span></code></pre></div>
<p>This persists the changes to the database. If <code>commit()</code> raises an exception, the changes are rolled back (see below).</p>
<h3 id="rolling-back-transactions">Rolling Back Transactions</h3>
<p>If an error occurs or you need to undo changes made in the current transaction, use <code>rollback()</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... database operations ...</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    session.commit()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    session.rollback()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"An error occurred: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div>
<p><code>rollback()</code> discards all changes made since the last <code>commit()</code> or the beginning of the session.</p>
<h3 id="session-scoping">Session Scoping</h3>
<p>Managing session lifecycles is critical. Simple applications might create and close a session for each request. More complex applications often use techniques like scoped sessions or thread-local sessions to manage sessions efficiently within a context. <code>scoped_session</code> provides a thread-safe way to share a session across multiple parts of your application within a given scope.</p>
<h3 id="unit-of-work-pattern">Unit of Work Pattern</h3>
<p>The unit of work pattern involves grouping multiple database operations within a single transaction. This ensures that either all operations succeed, or none do, maintaining data consistency. SQLAlchemy’s session provides this functionality naturally: all operations within a session are part of the same transaction until <code>commit()</code> is called.</p>
<h3 id="managing-session-identity">Managing Session Identity</h3>
<p>SQLAlchemy uses identity maps to track which objects are loaded in a session. This avoids redundant database queries. When an object is loaded, it’s added to the session’s identity map. Subsequent queries for the same object will return the same instance from the identity map, not requiring a new database fetch. Understanding how this works will help optimize the performance of database interactions, especially for applications handling a large volume of data.</p>
<h2 id="querying-1">Querying</h2>
<h3 id="core-querying-techniques">Core Querying Techniques</h3>
<p>SQLAlchemy’s ORM provides a powerful and flexible querying API built around the <code>Query</code> object. Queries are constructed using methods that build upon each other in a chainable fashion. The basic pattern involves using <code>session.query()</code> to initiate a query, followed by methods to filter, sort, and limit the results. The <code>all()</code>, <code>first()</code>, <code>one()</code>, and <code>scalar()</code> methods retrieve the query results in different ways.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, text</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker, declarative_base</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ... define models ...</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">"sqlite:///:memory:"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>Session <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>session <span class="op">=</span> Session()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ... populate database ...</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> session.query(User).<span class="bu">all</span>()  <span class="co"># Returns a list of all User objects</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>first_user <span class="op">=</span> session.query(User).first() <span class="co"># Returns the first User object or None</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>single_result <span class="op">=</span> session.query(User).<span class="bu">filter</span>(User.<span class="bu">id</span> <span class="op">==</span> <span class="dv">1</span>).one() <span class="co"># Returns single object or raises exception</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>single_value <span class="op">=</span> session.query(User.name).<span class="bu">filter</span>(User.<span class="bu">id</span> <span class="op">==</span> <span class="dv">1</span>).scalar() <span class="co"># Returns single value or None</span></span></code></pre></div>
<h3 id="filtering-data-where-clause">Filtering Data (WHERE clause)</h3>
<p>Filtering data is done using the <code>filter()</code> method, which accepts SQLAlchemy expressions or Python predicates:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).<span class="bu">filter</span>(User.name <span class="op">==</span> <span class="st">"John Doe"</span>).<span class="bu">all</span>()  <span class="co"># Direct comparison</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).<span class="bu">filter</span>(User.<span class="bu">id</span> <span class="op">&gt;</span> <span class="dv">10</span>).<span class="bu">all</span>()  <span class="co"># Greater than comparison</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).<span class="bu">filter</span>(User.name.like(<span class="st">"%Doe%"</span>)).<span class="bu">all</span>() <span class="co"># using like operator for pattern matching</span></span></code></pre></div>
<p>Multiple filters can be combined using <code>and_</code>, <code>or_</code>, <code>not_</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> and_, or_</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).<span class="bu">filter</span>(and_(User.name <span class="op">==</span> <span class="st">"John"</span>, User.age <span class="op">&gt;</span> <span class="dv">30</span>)).<span class="bu">all</span>()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).<span class="bu">filter</span>(or_(User.name <span class="op">==</span> <span class="st">"John"</span>, User.name <span class="op">==</span> <span class="st">"Jane"</span>)).<span class="bu">all</span>()</span></code></pre></div>
<h3 id="sorting-data-order-by-clause">Sorting Data (ORDER BY clause)</h3>
<p>Sorting is achieved using the <code>order_by()</code> method:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).order_by(User.name).<span class="bu">all</span>()  <span class="co"># Ascending order</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).order_by(User.name.desc()).<span class="bu">all</span>()  <span class="co"># Descending order</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).order_by(User.age, User.name).<span class="bu">all</span>() <span class="co"># Multiple sorting criteria.</span></span></code></pre></div>
<h3 id="pagination-limit-offset">Pagination (LIMIT, OFFSET)</h3>
<p>Pagination limits the number of results returned and allows skipping a certain number of results. <code>limit()</code> and <code>offset()</code> methods control this:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).limit(<span class="dv">10</span>).offset(<span class="dv">20</span>).<span class="bu">all</span>()  <span class="co"># Returns 10 users, starting from the 21st</span></span></code></pre></div>
<h3 id="joining-tables">Joining Tables</h3>
<p>Joins are performed using the <code>join()</code> method, specifying the related model and optional join conditions:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> inspect</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> joinedload</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming a relationship between User and Address models</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>addresses <span class="op">=</span> session.query(Address).join(User).<span class="bu">filter</span>(User.name <span class="op">==</span> <span class="st">"John Doe"</span>).<span class="bu">all</span>()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using joinedload for eager loading</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>addresses <span class="op">=</span> session.query(User).options(joinedload(User.addresses)).<span class="bu">filter</span>(User.name <span class="op">==</span> <span class="st">"John Doe"</span>).<span class="bu">all</span>()</span></code></pre></div>
<p><code>joinedload</code> is an example of an eager loading option, which helps to optimize queries involving relationships, avoiding the N+1 problem. Other eager loading options include <code>subqueryload</code> and <code>selectinload</code>. Lazy loading is also an option. Consult the SQLAlchemy documentation for more information on eager vs lazy loading and the appropriate option for your use case.</p>
<h3 id="aggregations-count-sum-avg-etc.">Aggregations (COUNT, SUM, AVG, etc.)</h3>
<p>SQLAlchemy’s <code>func</code> module provides aggregation functions:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> func</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>total_users <span class="op">=</span> session.query(func.count(User.<span class="bu">id</span>)).scalar()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>average_age <span class="op">=</span> session.query(func.avg(User.age)).scalar()</span></code></pre></div>
<h3 id="subqueries">Subqueries</h3>
<p>Subqueries can be used within filter criteria for more complex queries:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>subquery <span class="op">=</span> session.query(Address.<span class="bu">id</span>).<span class="bu">filter</span>(Address.city <span class="op">==</span> <span class="st">"New York"</span>).subquery()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).join(Address, User.<span class="bu">id</span> <span class="op">==</span> Address.user_id).<span class="bu">filter</span>(Address.<span class="bu">id</span>.in_(subquery)).<span class="bu">all</span>()</span></code></pre></div>
<h3 id="using-expressions">Using Expressions</h3>
<p>SQLAlchemy’s expression language allows for constructing complex queries programmatically:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> text, cast, Integer</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).<span class="bu">filter</span>(cast(User.age, Integer) <span class="op">&gt;</span> <span class="dv">25</span>).<span class="bu">all</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using text() for raw SQL snippets (use with caution!)</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> session.query(User).from_statement(text(<span class="st">"SELECT * FROM users WHERE age &gt; 25"</span>)).<span class="bu">all</span>()</span></code></pre></div>
<p>Use <code>text()</code> sparingly and only when absolutely necessary, as it bypasses the ORM’s safety and optimization features.</p>
<h3 id="functional-querying">Functional Querying</h3>
<p>Functional querying uses functions like <code>func.count()</code> directly within <code>query</code> operations to achieve more concise expressions. Many examples provided previously already used this approach. The key is to directly leverage SQLAlchemy’s function objects from the <code>func</code> module within the query construction. This style often leads to highly efficient and readable code.</p>
<h2 id="relationships-1">Relationships</h2>
<h3 id="one-to-one-relationships">One-to-one Relationships</h3>
<p>One-to-one relationships indicate that one record in a table is associated with at most one record in another table. In SQLAlchemy, this is typically implemented using the <code>relationship()</code> function with <code>uselist=False</code> on the “one” side of the relationship. A foreign key is usually placed on one of the tables to enforce the relationship.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> Column, Integer, String, ForeignKey</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> relationship, declarative_base</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'users'</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    address_id <span class="op">=</span> Column(Integer, ForeignKey(<span class="st">'addresses.id'</span>))  <span class="co"># Foreign key on User</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    address <span class="op">=</span> relationship(<span class="st">"Address"</span>, uselist<span class="op">=</span><span class="va">False</span>, backref<span class="op">=</span><span class="st">"user"</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Address(Base):</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'addresses'</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    street <span class="op">=</span> Column(String)</span></code></pre></div>
<p>In this example, a user can have at most one address, and an address belongs to at most one user. The foreign key <code>address_id</code> is on the <code>User</code> table. The <code>backref</code> argument creates a convenient <code>user</code> attribute on the <code>Address</code> model to access the associated user.</p>
<h3 id="one-to-many-relationships">One-to-many Relationships</h3>
<p>One-to-many relationships represent a single record in one table associated with multiple records in another. The “one” side often contains a primary key, while the “many” side contains a foreign key referencing the primary key on the “one” side.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'users'</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    addresses <span class="op">=</span> relationship(<span class="st">"Address"</span>, backref<span class="op">=</span><span class="st">"user"</span>)  <span class="co"># One-to-many</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Address(Base):</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'addresses'</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    street <span class="op">=</span> Column(String)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    user_id <span class="op">=</span> Column(Integer, ForeignKey(<span class="st">'users.id'</span>))  <span class="co"># Foreign key on Address</span></span></code></pre></div>
<p>Here, one user can have multiple addresses. The foreign key <code>user_id</code> is on the <code>Address</code> table. The backref creates a <code>user</code> attribute on <code>Address</code>.</p>
<h3 id="many-to-many-relationships">Many-to-many Relationships</h3>
<p>Many-to-many relationships involve multiple records in one table associated with multiple records in another. This requires an association table to track the relationship.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> Table, Column, Integer, ForeignKey, MetaData</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> relationship, declarative_base</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>metadata <span class="op">=</span> MetaData()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>user_tag_table <span class="op">=</span> Table(<span class="st">'user_tags'</span>, metadata,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    Column(<span class="st">'user_id'</span>, Integer, ForeignKey(<span class="st">'users.id'</span>)),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    Column(<span class="st">'tag_id'</span>, Integer, ForeignKey(<span class="st">'tags.id'</span>))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'users'</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    tags <span class="op">=</span> relationship(<span class="st">"Tag"</span>, secondary<span class="op">=</span>user_tag_table, backref<span class="op">=</span><span class="st">"users"</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Tag(Base):</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'tags'</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span></code></pre></div>
<p>Users can have multiple tags, and tags can be associated with multiple users. <code>user_tag_table</code> is the association table.</p>
<h3 id="self-referential-relationships">Self-referential Relationships</h3>
<p>Self-referential relationships occur when a table relates to itself. This is common for hierarchical data structures like organizational charts or threaded comments.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Employee(Base):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'employees'</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    manager_id <span class="op">=</span> Column(Integer, ForeignKey(<span class="st">'employees.id'</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    manager <span class="op">=</span> relationship(<span class="st">"Employee"</span>, remote_side<span class="op">=</span>[<span class="bu">id</span>], backref<span class="op">=</span><span class="st">"subordinates"</span>)</span></code></pre></div>
<p>An employee can have a manager (who is also an employee). <code>remote_side=[id]</code> specifies the column on the other side of the relationship to join on.</p>
<h3 id="backrefs-and-lazy-loading">Backrefs and Lazy Loading</h3>
<p>Backrefs provide easy access to related objects from the opposite side of a relationship. Lazy loading means that related objects are not loaded until they are accessed. This improves performance by only loading related data when needed. Eager loading (using options like <code>joinedload</code> as described in the querying section) loads related data immediately which can also improve performance depending on application behavior. SQLAlchemy’s default behavior with respect to lazy loading or eager loading is dependent upon several factors including the underlying database engine and whether explicit relationship loading options have been set.</p>
<h3 id="relationship-attributes">Relationship Attributes</h3>
<p>The <code>relationship()</code> function accepts various attributes to customize relationship behavior:</p>
<ul>
<li><code>backref</code>: Creates an attribute on the related class to access the parent object.</li>
<li><code>uselist</code>: Specifies whether the relationship returns a single object (<code>False</code>) or a list of objects (<code>True</code>, default).</li>
<li><code>primaryjoin</code>: Allows specifying the join condition explicitly.</li>
<li><code>secondary</code>: Required for many-to-many relationships.</li>
<li><code>cascade</code>: Defines which operations (add, delete, merge, refresh, etc.) should cascade to related objects. The <code>cascade</code> parameter is a crucial aspect of maintaining referential integrity across your database. Carefully consider the cascading behavior to avoid unintended deletions or updates to related records.</li>
<li><code>lazy</code>: Controls the loading strategy (“select”, “joined”, “subquery”, “dynamic”). “select” is the most common approach for lazy loading. Other approaches are more appropriate under specific circumstances and can significantly improve performance. “joined” is an eager loading technique. Consult the SQLAlchemy documentation for more information on choosing the appropriate lazy loading strategy for your application.</li>
</ul>
<h2 id="advanced-topics">Advanced Topics</h2>
<h3 id="hybrid-properties">Hybrid Properties</h3>
<p>Hybrid properties allow defining properties that combine database column values with computed or dynamically generated values. They are particularly useful when you need to derive a value from multiple columns or incorporate application logic into your data model.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.ext.hybrid <span class="im">import</span> hybrid_property</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Product(Base):</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'products'</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    price <span class="op">=</span> Column(Float)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    tax_rate <span class="op">=</span> Column(Float)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">@hybrid_property</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> total_price(<span class="va">self</span>):</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.price <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="va">self</span>.tax_rate)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">@total_price.setter</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> total_price(<span class="va">self</span>, value):</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.price <span class="op">=</span> value <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> <span class="va">self</span>.tax_rate)</span></code></pre></div>
<p>This example shows a <code>total_price</code> property calculated from <code>price</code> and <code>tax_rate</code>; both getter and setter methods are defined for complete control.</p>
<h3 id="events-and-listeners">Events and Listeners</h3>
<p>SQLAlchemy allows attaching event listeners to various lifecycle events (before_insert, after_insert, before_update, etc.). These listeners provide hooks to execute custom code during these events.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> event</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="at">@event.listens_for</span>(User, <span class="st">'before_insert'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> receive_before_insert(mapper, connection, target):</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    target.creation_timestamp <span class="op">=</span> datetime.datetime.now()</span></code></pre></div>
<p>This listener sets a <code>creation_timestamp</code> attribute before each user insertion.</p>
<h3 id="custom-types">Custom Types</h3>
<p>For data types not directly supported by SQLAlchemy, you can define custom types.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.types <span class="im">import</span> TypeDecorator, VARCHAR</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyCustomType(TypeDecorator):</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    impl <span class="op">=</span> VARCHAR(<span class="dv">255</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_bind_param(<span class="va">self</span>, value, dialect):</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Preprocessing logic before value is sent to database.</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="bu">str</span>(value).upper()</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_result_value(<span class="va">self</span>, value, dialect):</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Postprocessing logic after value retrieved from database.</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> value.lower()</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Item(Base):</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    description <span class="op">=</span> Column(MyCustomType)</span></code></pre></div>
<p>This custom type processes values before database insertion and after retrieval.</p>
<h3 id="schema-generation">Schema Generation</h3>
<p>SQLAlchemy can automatically generate database schemas from your models.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Base.metadata.create_all(engine)</span></code></pre></div>
<p>This creates the tables defined in your declarative models in the database. You can customize schema generation using options such as <code>checkfirst=True</code> (to avoid errors if tables already exist).</p>
<h3 id="migrations">Migrations</h3>
<p>Tools like Alembic are commonly used with SQLAlchemy to manage database migrations. Alembic helps track schema changes over time and generate scripts to upgrade and downgrade the database schema.</p>
<h3 id="testing-with-sqlalchemy">Testing with SQLAlchemy</h3>
<p>Testing SQLAlchemy applications involves using an in-memory database (like SQLite) for testing to avoid reliance on a persistent database during test runs. Testing frameworks like pytest can be integrated easily with SQLAlchemy for robust test suites. Mocking or stubbing of database connections might also be useful in testing specific aspects of your application logic, decoupling it from actual database interactions.</p>
<h3 id="performance-tuning">Performance Tuning</h3>
<p>Optimizing SQLAlchemy applications involves understanding query performance and using appropriate techniques to improve efficiency. Profiling tools can help identify performance bottlenecks. Strategies include using eager loading (to avoid N+1 queries), optimizing joins, and using indexes appropriately. Careful selection of lazy vs.&nbsp;eager loading strategies as well as judicious use of database connection pooling and transaction management can further improve performance.</p>
<h3 id="connection-pooling">Connection Pooling</h3>
<p>Connection pooling manages a pool of database connections to reuse connections, improving performance and reducing connection overhead. Connection pool settings are configured during <code>create_engine()</code> call as already discussed previously.</p>
<h3 id="transactions">Transactions</h3>
<p>Transactions ensure that multiple database operations either all succeed or all fail as a unit. SQLAlchemy transactions are managed using the <code>Session</code> object. <code>session.begin()</code>, <code>session.commit()</code>, and <code>session.rollback()</code> methods control the transaction lifecycle, as described earlier in the document. Understanding transaction isolation levels and their impact on concurrency is vital for building robust database applications. Proper transaction management is particularly important when handling multiple database operations that must maintain data consistency.</p>
<h2 id="orm-specific-features">ORM-Specific Features</h2>
<h3 id="querying-techniques-for-orms">Querying Techniques for ORMs</h3>
<p>SQLAlchemy’s ORM provides a higher-level querying API compared to its Core layer. The key difference is the use of Python objects and relationships instead of raw SQL. This enables more readable and maintainable code, especially for complex queries involving joins and relationships. The querying API relies heavily on the <code>Query</code> object and its associated methods (<code>filter()</code>, <code>order_by()</code>, <code>join()</code>, <code>limit()</code>, <code>offset()</code>, etc.), as described previously. However, within the ORM context, these methods operate on Python objects representing database tables and their relationships, allowing for more intuitive and Pythonic ways to express database interactions. The use of eager loading options like <code>joinedload</code> significantly impacts query efficiency when working with relationships. Understanding the difference between lazy and eager loading and the implications for your application’s performance is essential.</p>
<h3 id="object-relational-mapping-details">Object-Relational Mapping Details</h3>
<p>The ORM maps Python classes to database tables. Each class attribute maps to a database column. Relationships between classes are mapped to database relationships (foreign keys). SQLAlchemy handles the SQL generation and execution based on these mappings. Understanding the underlying mapping mechanism is important for diagnosing issues, resolving conflicts, and optimizing performance. The <code>inspect</code> utility can help in understanding the current mapping.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> Session</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> inspect</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>inspector <span class="op">=</span> inspect(session.query(User).first())</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inspector.attrs) <span class="co">#shows mapped attributes of the User object</span></span></code></pre></div>
<p>This reveals the attributes, including relationships, that are mapped to the database table for a given object.</p>
<h3 id="orm-relationship-mapping-specifics">ORM Relationship Mapping Specifics</h3>
<p>The ORM’s relationship mapping significantly impacts query efficiency and data consistency. Understanding the nuances of <code>relationship()</code> parameters like <code>backref</code>, <code>lazy</code>, <code>cascade</code>, <code>uselist</code>, and <code>primaryjoin</code> is crucial. Incorrect configuration can lead to inefficient queries, data inconsistencies, or subtle bugs. Choosing appropriate lazy-loading strategies (or opting for eager loading) affects query performance based on the application’s access patterns. Careful selection of the <code>cascade</code> parameter ensures referential integrity is handled correctly, preventing orphaned records or unintended data modifications.</p>
<h3 id="orm-transactions">ORM Transactions</h3>
<p>ORM transactions leverage the underlying database transactions but provide a more Pythonic and object-oriented interface. The <code>Session</code> object manages the transaction lifecycle. The <code>session.begin()</code>, <code>session.commit()</code>, and <code>session.rollback()</code> methods ensure that database operations are atomic, either completely succeeding or completely rolling back in case of errors. The <code>Session</code> also offers built-in features for managing the unit of work and flushing changes to the database at the appropriate times. Proper use of transactions ensures data consistency and reduces the risks of partial updates or data corruption. Furthermore, ORM transactions provide seamless integration with the object lifecycle, ensuring that any updates to objects within the transaction are properly reflected in the database once the transaction commits successfully.</p>
<h2 id="examples-and-use-cases">Examples and Use Cases</h2>
<h3 id="simple-crud-operations">Simple CRUD Operations</h3>
<p>Simple CRUD (Create, Read, Update, Delete) operations demonstrate fundamental SQLAlchemy usage.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine, Column, Integer, String</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker, declarative_base</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>Base <span class="op">=</span> declarative_base()</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> User(Base):</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    __tablename__ <span class="op">=</span> <span class="st">'users'</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> Column(Integer, primary_key<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> Column(String)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">'sqlite:///:memory:'</span>) <span class="co">#in memory db for this example</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>Base.metadata.create_all(engine)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>Session <span class="op">=</span> sessionmaker(bind<span class="op">=</span>engine)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>session <span class="op">=</span> Session()</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>new_user <span class="op">=</span> User(name<span class="op">=</span><span class="st">'John Doe'</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>session.add(new_user)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>session.commit()</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Read</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>retrieved_user <span class="op">=</span> session.query(User).filter_by(name<span class="op">=</span><span class="st">'John Doe'</span>).first()</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(retrieved_user.name)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Update</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>retrieved_user.name <span class="op">=</span> <span class="st">'Jane Doe'</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>session.commit()</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>session.delete(retrieved_user)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>session.commit()</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>session.close()</span></code></pre></div>
<p>This example covers basic CRUD operations using the ORM. Replace <code>sqlite:///:memory:</code> with your database URL for persistent storage.</p>
<h3 id="complex-queries">Complex Queries</h3>
<p>Complex queries involve joins, aggregations, subqueries, and filtering.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming User and Address models with a one-to-many relationship</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>ny_users <span class="op">=</span> session.query(User).join(Address).<span class="bu">filter</span>(Address.city <span class="op">==</span> <span class="st">'New York'</span>).<span class="bu">all</span>()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>num_users <span class="op">=</span> session.query(func.count(User.<span class="bu">id</span>)).scalar()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>average_age <span class="op">=</span> session.query(func.avg(User.age)).scalar() <span class="co">#requires age column in User model</span></span></code></pre></div>
<p>This demonstrates joins and aggregations using the ORM’s query capabilities.</p>
<h3 id="working-with-multiple-tables">Working with Multiple Tables</h3>
<p>Working with multiple tables involves defining relationships between models and using joins in queries. The examples in the “Relationships” section illustrate this effectively. Remember to define relationships between your models using SQLAlchemy’s <code>relationship</code> function. This will allow for efficient and intuitive querying of related data between your tables.</p>
<h3 id="building-a-web-application-with-sqlalchemy">Building a Web Application with SQLAlchemy</h3>
<p>SQLAlchemy integrates well with web frameworks like Flask and Django. A Flask example:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request, jsonify</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sqlalchemy.orm <span class="im">import</span> sessionmaker, scoped_session</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">'postgresql://user:password@host/database'</span>) <span class="co">#replace with your connection string</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>session <span class="op">=</span> scoped_session(sessionmaker(bind<span class="op">=</span>engine))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (define models, routes for CRUD operations, etc.) ...</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">'/users'</span>, methods<span class="op">=</span>[<span class="st">'GET'</span>])</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_users():</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    users <span class="op">=</span> session.query(User).<span class="bu">all</span>()</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jsonify([user.to_dict() <span class="cf">for</span> user <span class="kw">in</span> users])</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ... (more routes)</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    app.run(debug<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>This outlines a basic Flask app structure interacting with a database using SQLAlchemy. Error handling, data validation, and more robust features are essential for production applications.</p>
<h3 id="real-world-application-examples">Real-World Application Examples</h3>
<p>Real-world examples include:</p>
<ul>
<li><strong>E-commerce:</strong> Managing products, orders, customers, inventory.</li>
<li><strong>Social Networks:</strong> Users, posts, comments, friendships.</li>
<li><strong>Content Management Systems:</strong> Articles, users, categories, comments.</li>
<li><strong>Data Analytics:</strong> Storing and querying large datasets for analysis.</li>
</ul>
<p>These applications demonstrate SQLAlchemy’s capabilities in managing complex data models and providing efficient data access for diverse purposes. The specifics of these applications would involve more detailed schema design, complex queries, and considerations for scalability and performance optimization, all of which SQLAlchemy can effectively handle.</p>
<h2 id="appendix-reference">Appendix: Reference</h2>
<h3 id="glossary-of-terms">Glossary of Terms</h3>
<ul>
<li><strong>Engine:</strong> The central component of SQLAlchemy, representing a connection to a specific database. It’s used to create connections, execute SQL, and manage transactions.</li>
<li><strong>Connection:</strong> An active connection to the database. The Engine manages a pool of connections.</li>
<li><strong>Connection Pool:</strong> A mechanism to manage a pool of database connections to reuse them and avoid the overhead of constantly creating and closing connections.</li>
<li><strong>Session:</strong> An ORM-specific object that manages persistent objects, tracks changes, and interacts with the database. It acts as a transactional boundary.</li>
<li><strong>Declarative Mapping:</strong> A technique in SQLAlchemy’s ORM where database tables are defined using Python classes.</li>
<li><strong>Mapped Class:</strong> A Python class that maps to a database table in the ORM.</li>
<li><strong>Table:</strong> A database table.</li>
<li><strong>Column:</strong> A database table column.</li>
<li><strong>Dialect:</strong> A specific database system (e.g., PostgreSQL, MySQL, SQLite). SQLAlchemy supports multiple dialects.</li>
<li><strong>Driver:</strong> A database driver is a piece of software that provides the low level connection to the underlying database system. SQLAlchemy interacts with the database through these drivers.</li>
<li><strong>ORM:</strong> Object-Relational Mapper; an abstraction layer that maps Python objects to database tables.</li>
<li><strong>Hybrid Property:</strong> A property that combines database column values with calculated or dynamically generated values.</li>
<li><strong>Backref:</strong> A convenience attribute added to a related class by <code>relationship()</code> to easily access the related parent object.</li>
<li><strong>Lazy Loading:</strong> Related objects are loaded only when accessed.</li>
<li><strong>Eager Loading:</strong> Related objects are loaded along with the parent object.</li>
<li><strong>Query:</strong> An object used to build and execute database queries in the ORM.</li>
<li><strong>Expression:</strong> A construct in SQLAlchemy used to build SQL expressions programmatically.</li>
<li><strong>func:</strong> The SQLAlchemy module containing database functions (COUNT, SUM, AVG, etc.).</li>
<li><strong>Association Table:</strong> A table used to implement many-to-many relationships.</li>
<li><strong>Cascade:</strong> Specifying how database operations on a parent object propagate to related child objects.</li>
<li><strong>Transaction:</strong> A sequence of database operations treated as a single unit of work; either all succeed or all fail.</li>
<li><strong>Identity Map:</strong> A mechanism to track loaded objects in a session to avoid redundant queries.</li>
</ul>
<h3 id="api-documentation-links">API Documentation Links</h3>
<p>Refer to the official SQLAlchemy documentation for comprehensive API details: <a href="https://docs.sqlalchemy.org/en/20/">https://docs.sqlalchemy.org/en/20/</a> (Replace with the most current version number). This documentation provides detailed information on all classes, functions, and methods within the SQLAlchemy library. The documentation includes examples, explanations, and best practices to guide you through various SQLAlchemy functionalities.</p>
<h3 id="error-messages">Error Messages</h3>
<p>SQLAlchemy provides informative error messages to aid debugging. Common error types include:</p>
<ul>
<li><strong><code>sqlalchemy.exc.OperationalError</code>:</strong> Typically indicates a database-related problem (e.g., connection issues, invalid SQL). Check database connectivity, permissions, and the validity of your SQL queries.</li>
<li><strong><code>sqlalchemy.exc.IntegrityError</code>:</strong> Usually signifies a constraint violation (e.g., unique constraint, foreign key constraint). Inspect the database schema and your data to find the conflict.</li>
<li><strong><code>sqlalchemy.exc.InvalidRequestError</code>:</strong> Occurs due to invalid usage of the ORM or Core. Carefully review your code for errors in model definitions, queries, or session management.</li>
<li><strong><code>sqlalchemy.exc.ArgumentError</code>:</strong> Indicates an incorrect argument passed to a function. Check the function’s documentation for expected parameter types and values.</li>
<li><strong><code>sqlalchemy.exc.NoResultFound</code>:</strong> Raised when a query expecting a single result returns no rows. Double-check your query’s filtering criteria.</li>
<li><strong><code>sqlalchemy.exc.MultipleResultsFound</code>:</strong> Raised when a query expecting a single result returns more than one row. Refine your query for better selectivity.</li>
</ul>
<p>Always examine the full stack trace and error message for clues on how to resolve the issue. Consult the SQLAlchemy documentation or search online forums for solutions to common errors.</p>


<footer>Copyright 2025 - Muthukrishnan</footer>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3609399560636561" crossorigin="anonymous"></script>




</body></html>