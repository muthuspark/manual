<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Muthukrishnan">

<title>functools - Documentation – Technical Manuals</title>
<style>
html {
  color: #1a1a1a;
  background-color: #fdfdfd;
}
body {
  margin: 0 auto;
  max-width: 36em;
  padding-left: 50px;
  padding-right: 50px;
  padding-top: 50px;
  padding-bottom: 50px;
  hyphens: auto;
  overflow-wrap: break-word;
  text-rendering: optimizeLegibility;
  font-kerning: normal;
}
@media (max-width: 600px) {
  body {
    font-size: 0.9em;
    padding: 12px;
  }
  h1 {
    font-size: 1.8em;
  }
}
@media print {
  html {
    background-color: white;
  }
  body {
    background-color: transparent;
    color: black;
    font-size: 12pt;
  }
  p, h2, h3 {
    orphans: 3;
    widows: 3;
  }
  h2, h3, h4 {
    page-break-after: avoid;
  }
}
p {
  margin: 1em 0;
}
a {
  color: #1a1a1a;
}
a:visited {
  color: #1a1a1a;
}
img {
  max-width: 100%;
}
svg {
  height; auto;
  max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
  margin-top: 1.4em;
}
h5, h6 {
  font-size: 1em;
  font-style: italic;
}
h6 {
  font-weight: normal;
}
ol, ul {
  padding-left: 1.7em;
  margin-top: 1em;
}
li > ol, li > ul {
  margin-top: 0;
}
ul > li:not(:has(> p)) > ul,
ol > li:not(:has(> p)) > ul,
ul > li:not(:has(> p)) > ol,
ol > li:not(:has(> p)) > ol {
  margin-bottom: 0;
}
ul > li:not(:has(> p)) > ul > li:has(> p),
ol > li:not(:has(> p)) > ul > li:has(> p),
ul > li:not(:has(> p)) > ol > li:has(> p),
ol > li:not(:has(> p)) > ol > li:has(> p) {
  margin-top: 1rem;
}
blockquote {
  margin: 1em 0 1em 1.7em;
  padding-left: 1em;
  border-left: 2px solid #e6e6e6;
  color: #606060;
}
code {
  font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
  font-size: 85%;
  margin: 0;
  hyphens: manual;
}
pre {
  margin: 1em 0;
  overflow: auto;
}
pre code {
  padding: 0;
  overflow: visible;
  overflow-wrap: normal;
}
.sourceCode {
 background-color: transparent;
 overflow: visible;
}
hr {
  background-color: #1a1a1a;
  border: none;
  height: 1px;
  margin: 1em 0;
}
table {
  margin: 1em 0;
  border-collapse: collapse;
  width: 100%;
  overflow-x: auto;
  display: block;
  font-variant-numeric: lining-nums tabular-nums;
}
table caption {
  margin-bottom: 0.75em;
}
tbody {
  margin-top: 0.5em;
  border-top: 1px solid #1a1a1a;
  border-bottom: 1px solid #1a1a1a;
}
th {
  border-top: 1px solid #1a1a1a;
  padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
  padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
  margin-bottom: 4em;
  text-align: center;
}
#TOC li {
  list-style: none;
}
#TOC ul {
  padding-left: 1.3em;
}
#TOC > ul {
  padding-left: 0;
}
#TOC a:not(:hover) {
  text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<link href="../../favicon.ico" rel="icon">
<script async="" src="https://www.googletagmanager.com/gtag/js?id="></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', '', { 'anonymize_ip': true});
</script>
<link rel="icon" type="image/x-icon" href="../../favicon.ico">
<meta property="og:title" content="functools - Documentation – Technical Manuals">
<meta property="og:site_name" content="Technical Manuals">
</head><body><div class="navigation-header">
    <nav>
        <div>
            <div class="logo">
                <a href="../../" aria-label="Home">
                    <span>Technical Manuals - Home</span>
                </a>
            </div>
            <div class="nav-menu">
                <ul>
                    <li>
                        <a href="../../about.html">
                            <span class="menu-text">About</span>
                        </a>
                    </li>
                    <li> 
                        <a href="https://github.com/muthuspark" target="_blank">
                            <span class="menu-text">Github</span>
                        </a>
                    </li>
                    <li>
                        <a href="https://linkedin.com/in/krimuthu" target="_blank">
                            <span class="menu-text">Linkedin</span>
                        </a>
                    </li>
                    <li>
                        <button onclick="window.print()" class="print-button">
                            <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M6 9V2h12v7"></path>
                              <path d="M6 18H4a2 2 0 01-2-2v-5a2 2 0 012-2h16a2 2 0 012 2v5a2 2 0 01-2 2h-2"></path>
                              <path d="M6 14h12v8H6z"></path>
                            </svg>
                            Print Page
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>


<link rel="stylesheet" href="../../styles.css">





<header id="title-block-header">
<h1 class="title">functools - Documentation</h1>

</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-is-functools" id="toc-what-is-functools">What is functools?</a></li>
  <li><a href="#why-use-functools" id="toc-why-use-functools">Why use functools?</a></li>
  <li><a href="#key-features-and-benefits" id="toc-key-features-and-benefits">Key features and benefits</a></li>
  <li><a href="#target-audience" id="toc-target-audience">Target audience</a></li>
  <li><a href="#partial-functions-partial" id="toc-partial-functions-partial">Partial Functions (<code>partial</code>)</a>
  <ul>
  <li><a href="#creating-partial-functions-with-partial" id="toc-creating-partial-functions-with-partial">Creating partial functions with <code>partial()</code></a></li>
  <li><a href="#understanding-keyword-arguments-in-partial" id="toc-understanding-keyword-arguments-in-partial">Understanding keyword arguments in <code>partial()</code></a></li>
  <li><a href="#example-use-cases-simplifying-function-calls" id="toc-example-use-cases-simplifying-function-calls">Example use cases: simplifying function calls</a></li>
  <li><a href="#advanced-applications-and-considerations" id="toc-advanced-applications-and-considerations">Advanced applications and considerations</a></li>
  </ul></li>
  <li><a href="#higher-order-functions" id="toc-higher-order-functions">Higher-Order Functions</a>
  <ul>
  <li><a href="#defining-higher-order-functions" id="toc-defining-higher-order-functions">Defining higher-order functions</a></li>
  <li><a href="#using-functions-as-arguments" id="toc-using-functions-as-arguments">Using functions as arguments</a></li>
  <li><a href="#returning-functions-from-functions" id="toc-returning-functions-from-functions">Returning functions from functions</a></li>
  </ul></li>
  <li><a href="#reduce-function-reduce" id="toc-reduce-function-reduce">Reduce Function (<code>reduce</code>)</a>
  <ul>
  <li><a href="#understanding-the-reduce-function" id="toc-understanding-the-reduce-function">Understanding the <code>reduce()</code> function</a></li>
  <li><a href="#applying-reduce-to-lists-and-other-iterables" id="toc-applying-reduce-to-lists-and-other-iterables">Applying <code>reduce()</code> to lists and other iterables</a></li>
  <li><a href="#example-use-cases-summing-lists-performing-cumulative-operations" id="toc-example-use-cases-summing-lists-performing-cumulative-operations">Example use cases: summing lists, performing cumulative operations</a></li>
  <li><a href="#comparison-with-other-approaches-loops" id="toc-comparison-with-other-approaches-loops">Comparison with other approaches (loops)</a></li>
  </ul></li>
  <li><a href="#decorators" id="toc-decorators">Decorators</a>
  <ul>
  <li><a href="#concept-of-decorators-in-python" id="toc-concept-of-decorators-in-python">Concept of decorators in Python</a></li>
  <li><a href="#syntax-and-structure-of-decorators" id="toc-syntax-and-structure-of-decorators">Syntax and structure of decorators</a></li>
  <li><a href="#example-decorators-timing-logging-access-control" id="toc-example-decorators-timing-logging-access-control">Example decorators: timing, logging, access control</a></li>
  <li><a href="#nested-decorators" id="toc-nested-decorators">Nested decorators</a></li>
  <li><a href="#decorator-factories" id="toc-decorator-factories">Decorator factories</a></li>
  <li><a href="#class-decorators" id="toc-class-decorators">Class decorators</a></li>
  </ul></li>
  <li><a href="#wrappers-and-preserving-function-metadata-wraps" id="toc-wrappers-and-preserving-function-metadata-wraps">Wrappers and Preserving Function Metadata (<code>wraps</code>)</a>
  <ul>
  <li><a href="#understanding-the-importance-of-preserving-metadata" id="toc-understanding-the-importance-of-preserving-metadata">Understanding the importance of preserving metadata</a></li>
  <li><a href="#using-wraps-to-maintain-function-information" id="toc-using-wraps-to-maintain-function-information">Using <code>wraps</code> to maintain function information</a></li>
  <li><a href="#illustrative-examples-of-metadata-preservation" id="toc-illustrative-examples-of-metadata-preservation">Illustrative examples of metadata preservation</a></li>
  <li><a href="#advanced-usage-of-wraps" id="toc-advanced-usage-of-wraps">Advanced usage of <code>wraps</code></a></li>
  </ul></li>
  <li><a href="#cmp_to_key" id="toc-cmp_to_key"><code>cmp_to_key</code></a>
  <ul>
  <li><a href="#converting-comparison-functions-to-key-functions" id="toc-converting-comparison-functions-to-key-functions">Converting comparison functions to key functions</a></li>
  <li><a href="#use-cases-for-cmp_to_key" id="toc-use-cases-for-cmp_to_key">Use cases for <code>cmp_to_key</code></a></li>
  <li><a href="#example-scenarios-and-code-demonstrations" id="toc-example-scenarios-and-code-demonstrations">Example scenarios and code demonstrations</a></li>
  </ul></li>
  <li><a href="#lru_cache" id="toc-lru_cache"><code>lru_cache</code></a>
  <ul>
  <li><a href="#introduction-to-memoization" id="toc-introduction-to-memoization">Introduction to memoization</a></li>
  <li><a href="#using-lru_cache-for-performance-optimization" id="toc-using-lru_cache-for-performance-optimization">Using <code>lru_cache</code> for performance optimization</a></li>
  <li><a href="#understanding-cache-size-and-parameters" id="toc-understanding-cache-size-and-parameters">Understanding cache size and parameters</a></li>
  <li><a href="#example-use-cases-fibonacci-sequence-recursive-functions" id="toc-example-use-cases-fibonacci-sequence-recursive-functions">Example use cases: Fibonacci sequence, recursive functions</a></li>
  </ul></li>
  <li><a href="#singledispatch" id="toc-singledispatch"><code>singledispatch</code></a>
  <ul>
  <li><a href="#introduction-to-single-dispatch-generic-functions" id="toc-introduction-to-single-dispatch-generic-functions">Introduction to single dispatch generic functions</a></li>
  <li><a href="#defining-generic-functions-with-singledispatch" id="toc-defining-generic-functions-with-singledispatch">Defining generic functions with <code>singledispatch</code></a></li>
  <li><a href="#registering-different-implementations-for-different-types" id="toc-registering-different-implementations-for-different-types">Registering different implementations for different types</a></li>
  <li><a href="#example-use-cases-handling-different-data-types-gracefully" id="toc-example-use-cases-handling-different-data-types-gracefully">Example use cases: handling different data types gracefully</a></li>
  </ul></li>
  <li><a href="#total_ordering" id="toc-total_ordering"><code>total_ordering</code></a>
  <ul>
  <li><a href="#implementing-total-ordering-with-minimal-effort" id="toc-implementing-total-ordering-with-minimal-effort">Implementing total ordering with minimal effort</a></li>
  <li><a href="#understanding-the-implications-of-total-ordering" id="toc-understanding-the-implications-of-total-ordering">Understanding the implications of total ordering</a></li>
  <li><a href="#use-cases-for-total_ordering" id="toc-use-cases-for-total_ordering">Use cases for <code>total_ordering</code></a></li>
  <li><a href="#example-scenarios-and-code-demonstrations-1" id="toc-example-scenarios-and-code-demonstrations-1">Example scenarios and code demonstrations</a></li>
  </ul></li>
  <li><a href="#advanced-techniques-and-best-practices" id="toc-advanced-techniques-and-best-practices">Advanced Techniques and Best Practices</a>
  <ul>
  <li><a href="#combining-multiple-decorators" id="toc-combining-multiple-decorators">Combining multiple decorators</a></li>
  <li><a href="#debugging-and-troubleshooting-decorators" id="toc-debugging-and-troubleshooting-decorators">Debugging and troubleshooting decorators</a></li>
  <li><a href="#performance-considerations" id="toc-performance-considerations">Performance considerations</a></li>
  <li><a href="#choosing-the-right-functools-tool-for-the-job" id="toc-choosing-the-right-functools-tool-for-the-job">Choosing the right <code>functools</code> tool for the job</a></li>
  </ul></li>
  <li><a href="#appendix-additional-resources-and-further-learning" id="toc-appendix-additional-resources-and-further-learning">Appendix: Additional Resources and Further Learning</a>
  <ul>
  <li><a href="#links-to-relevant-documentation-and-tutorials" id="toc-links-to-relevant-documentation-and-tutorials">Links to relevant documentation and tutorials</a></li>
  <li><a href="#suggested-readings-and-books" id="toc-suggested-readings-and-books">Suggested readings and books</a></li>
  <li><a href="#community-forums-and-support-groups" id="toc-community-forums-and-support-groups">Community forums and support groups</a></li>
  </ul></li>
  </ul>
</nav>
<h3 id="what-is-functools">What is functools?</h3>
<p>The <code>functools</code> module in Python provides higher-order functions and operations on callable objects. It’s a collection of tools that allow you to work with functions in a more powerful and expressive way, going beyond basic function calls. These tools enable advanced techniques like function decoration, function composition, and memoization, all aimed at enhancing code readability, reusability, and performance. Essentially, <code>functools</code> equips you with advanced capabilities for manipulating and working with functions as first-class objects.</p>
<h3 id="why-use-functools">Why use functools?</h3>
<p>Using <code>functools</code> offers several compelling advantages:</p>
<ul>
<li><p><strong>Improved Code Readability:</strong> <code>functools</code> provides concise and elegant ways to implement common functional programming patterns, leading to cleaner and easier-to-understand code. This is especially valuable when dealing with complex function transformations or interactions.</p></li>
<li><p><strong>Increased Code Reusability:</strong> The tools in <code>functools</code> encourage the creation of reusable function decorators and other function-manipulating components. This promotes a modular design, reducing code duplication and improving maintainability.</p></li>
<li><p><strong>Enhanced Performance:</strong> Features like memoization (caching function results) significantly improve performance, particularly for computationally expensive functions that are called repeatedly with the same arguments.</p></li>
<li><p><strong>Functional Programming Paradigm:</strong> <code>functools</code> facilitates a more functional programming style in Python, which can lead to more robust and predictable code, especially in situations involving concurrent or parallel processing.</p></li>
</ul>
<h3 id="key-features-and-benefits">Key features and benefits</h3>
<p>Key features of <code>functools</code> include:</p>
<ul>
<li><strong><code>lru_cache</code>:</strong> Implements a least recently used (LRU) cache to memoize function results, boosting performance by avoiding redundant computations.</li>
<li><strong><code>wraps</code>:</strong> A decorator that helps preserve metadata (like docstrings and name) when decorating functions, improving code clarity and debuggability.</li>
<li><strong><code>partial</code>:</strong> Creates partial function applications, allowing you to pre-fill some arguments of a function, generating a new callable object with fewer arguments.</li>
<li><strong><code>reduce</code>:</strong> Applies a function cumulatively to the items of an iterable, reducing it to a single value. (Note: <code>reduce</code> is also available in the <code>functools</code> module, though it’s often considered less Pythonic than list comprehensions or other methods.)</li>
<li><strong><code>singledispatch</code>:</strong> Enables generic function dispatching based on the type of the first argument, promoting code extensibility and reducing conditional branching.</li>
</ul>
<h3 id="target-audience">Target audience</h3>
<p>The <code>functools</code> module is primarily aimed at intermediate and advanced Python developers. While beginners can benefit from some of its simpler features, a good grasp of core Python concepts (including functions as first-class objects, decorators, and functional programming paradigms) is helpful to fully leverage its power. Developers working on projects requiring high performance, code reusability, or a more functional approach will find <code>functools</code> especially valuable.</p>
<h2 id="partial-functions-partial">Partial Functions (<code>partial</code>)</h2>
<h3 id="creating-partial-functions-with-partial">Creating partial functions with <code>partial()</code></h3>
<p>The <code>functools.partial</code> function allows you to create a new callable object that acts as a partially applied version of an existing function. This means you can pre-fill some of the arguments to the original function, leaving the remaining arguments to be provided later when the new partial function is called. The signature is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>functools.partial(func, <span class="op">*</span>args, <span class="op">**</span>keywords)</span></code></pre></div>
<p>where:</p>
<ul>
<li><code>func</code>: The original callable object (function, method, etc.) you want to partially apply.</li>
<li><code>*args</code>: Positional arguments to be pre-filled.</li>
<li><code>**keywords</code>: Keyword arguments to be pre-filled.</li>
</ul>
<p>The <code>partial()</code> function returns a new callable object that, when invoked, will call <code>func</code> with the pre-filled arguments plus any additional arguments passed at the time of invocation.</p>
<h3 id="understanding-keyword-arguments-in-partial">Understanding keyword arguments in <code>partial()</code></h3>
<p>Keyword arguments supplied to <code>partial()</code> are particularly useful for clarifying the intended purpose of the partial function. They provide a way to specify which arguments are being pre-filled, making the code more readable and less prone to errors. For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_function(a, b, c):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>partial_func <span class="op">=</span> partial(my_function, b<span class="op">=</span><span class="dv">5</span>, c<span class="op">=</span><span class="dv">10</span>)  <span class="co"># b and c are pre-filled</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> partial_func(a<span class="op">=</span><span class="dv">2</span>)  <span class="co"># Only a needs to be provided now</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)  <span class="co"># Output: 17</span></span></code></pre></div>
<h3 id="example-use-cases-simplifying-function-calls">Example use cases: simplifying function calls</h3>
<p><code>partial</code> shines when dealing with functions that have many arguments, but in many calls, some arguments remain constant. This reduces the complexity and improves readability. For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create a file with specific permissions</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_file(filename, mode, permissions):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    os.makedirs(os.path.dirname(filename), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(filename, mode) <span class="im">as</span> f:</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">""</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    os.chmod(filename, permissions)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a partial function for creating read-only files</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>create_read_only_file <span class="op">=</span> partial(create_file, mode<span class="op">=</span><span class="st">'w'</span>, permissions<span class="op">=</span><span class="bn">0o444</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, creating a read-only file is much simpler:</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>create_read_only_file(<span class="st">"my_file.txt"</span>)</span></code></pre></div>
<h3 id="advanced-applications-and-considerations">Advanced applications and considerations</h3>
<ul>
<li><p><strong>Currying:</strong> <code>partial</code> can be used to implement currying, a functional programming technique where a function with multiple arguments is transformed into a sequence of functions that take one argument at a time.</p></li>
<li><p><strong>Combining with other <code>functools</code> tools:</strong> <code>partial</code> often works well in conjunction with other <code>functools</code> features like decorators to create powerful and reusable function-building blocks.</p></li>
<li><p><strong>Debugging:</strong> When using <code>partial</code>, ensure you carefully track the order and types of arguments to avoid unexpected behaviour. Clearly named keyword arguments are highly recommended for better debugging and readability.</p></li>
<li><p><strong>Limitations:</strong> <code>partial</code> doesn’t change the underlying function signature; it merely provides a convenient way to call it with predetermined arguments. Error handling within the original function remains unchanged.</p></li>
</ul>
<h2 id="higher-order-functions">Higher-Order Functions</h2>
<h3 id="defining-higher-order-functions">Defining higher-order functions</h3>
<p>A higher-order function is a function that either takes one or more functions as arguments or returns a function as its result (or both). In essence, it treats functions as first-class citizens, allowing them to be passed around and manipulated like any other data type. This capability is fundamental to functional programming and provides powerful mechanisms for code abstraction and reusability. Here’s a simple example of a higher-order function that takes another function as an argument:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_function(func, x):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""Applies a function 'func' to the value 'x'."""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> func(x)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> square(x):</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">*</span> x</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> apply_function(square, <span class="dv">5</span>)  <span class="co"># apply_function is a higher-order function</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)  <span class="co"># Output: 25</span></span></code></pre></div>
<h3 id="using-functions-as-arguments">Using functions as arguments</h3>
<p>The power of higher-order functions comes from their ability to accept functions as arguments. This allows for generic functions to be created that can operate on different data in different ways, based on the provided function argument. Consider a function that applies a transformation to each element in a list:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transform_list(data, func):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""Applies a function 'func' to each element in the list 'data'."""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [func(x) <span class="cf">for</span> x <span class="kw">in</span> data]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>squared_numbers <span class="op">=</span> transform_list(numbers, square) <span class="co"># square is passed as an argument</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(squared_numbers)  <span class="co"># Output: [1, 4, 9, 16, 25]</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> double(x):</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>doubled_numbers <span class="op">=</span> transform_list(numbers, double) <span class="co"># double is passed as an argument</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(doubled_numbers) <span class="co"># Output: [2, 4, 6, 8, 10]</span></span></code></pre></div>
<p>This <code>transform_list</code> function is a higher-order function because it takes the function <code>square</code> or <code>double</code> as an argument, demonstrating flexibility and code reusability.</p>
<h3 id="returning-functions-from-functions">Returning functions from functions</h3>
<p>Higher-order functions can also <em>return</em> functions. This technique is often used to create specialized functions based on specific parameters or conditions. This is frequently implemented with closures, where the inner function “remembers” variables from its enclosing scope even after the outer function has finished executing:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_multiplier(factor):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""Creates a function that multiplies its input by a given factor."""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> multiplier(x):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> factor</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> multiplier</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>double_it <span class="op">=</span> create_multiplier(<span class="dv">2</span>)  <span class="co"># double_it is a function returned by create_multiplier</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>triple_it <span class="op">=</span> create_multiplier(<span class="dv">3</span>)  <span class="co"># triple_it is another function returned by create_multiplier</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(double_it(<span class="dv">5</span>))  <span class="co"># Output: 10</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(triple_it(<span class="dv">5</span>))  <span class="co"># Output: 15</span></span></code></pre></div>
<p><code>create_multiplier</code> is a higher-order function because it returns the inner function <code>multiplier</code>. This pattern enables the creation of specialized functions (like <code>double_it</code> and <code>triple_it</code>) dynamically, based on the <code>factor</code> supplied to <code>create_multiplier</code>. The concept of closures is essential for understanding how this works.</p>
<h2 id="reduce-function-reduce">Reduce Function (<code>reduce</code>)</h2>
<h3 id="understanding-the-reduce-function">Understanding the <code>reduce()</code> function</h3>
<p>The <code>functools.reduce()</code> function applies a given function cumulatively to the items of an iterable, reducing it to a single value. It takes two main arguments:</p>
<ul>
<li><code>function</code>: A function that takes two arguments and returns a single value. This function is applied cumulatively to the items of the iterable.</li>
<li><code>iterable</code>: An iterable (like a list, tuple, or other sequence) whose elements are to be reduced.</li>
</ul>
<p><code>reduce()</code> works by applying the function to the first two elements of the iterable, then taking the result and applying the function again to this result and the next element, and so on, until the entire iterable has been processed. The final result is the single value that remains after this cumulative application. Note that <code>reduce()</code> is imported from <code>functools</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add(x, y):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">+</span> y</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>sum_of_numbers <span class="op">=</span> <span class="bu">reduce</span>(add, numbers)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sum_of_numbers)  <span class="co"># Output: 15</span></span></code></pre></div>
<p>In this example, <code>reduce(add, numbers)</code> first computes <code>add(1, 2) = 3</code>, then <code>add(3, 3) = 6</code>, then <code>add(6, 4) = 10</code>, and finally <code>add(10, 5) = 15</code>.</p>
<h3 id="applying-reduce-to-lists-and-other-iterables">Applying <code>reduce()</code> to lists and other iterables</h3>
<p><code>reduce()</code> can operate on any iterable that can be processed sequentially. This includes lists, tuples, strings, and more. However, the iterable must contain elements suitable for the function being applied. If the iterable is empty, a <code>TypeError</code> will be raised.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiply(x, y):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">*</span> y</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>product_of_numbers <span class="op">=</span> <span class="bu">reduce</span>(multiply, numbers)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(product_of_numbers)  <span class="co"># Output: 120</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Example with a string:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> concatenate(x,y):</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">+</span>y</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>mystring <span class="op">=</span> <span class="bu">reduce</span>(concatenate, [<span class="st">'hello'</span>, <span class="st">' '</span>, <span class="st">'world'</span>])</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mystring) <span class="co">#Output: hello world</span></span></code></pre></div>
<h3 id="example-use-cases-summing-lists-performing-cumulative-operations">Example use cases: summing lists, performing cumulative operations</h3>
<p>Beyond simply summing lists, <code>reduce()</code> is useful for various cumulative operations:</p>
<ul>
<li><strong>Calculating the product of numbers:</strong> As shown in the example above.</li>
<li><strong>Finding the maximum or minimum value in a list:</strong> A custom function comparing two elements could be used.</li>
<li><strong>Concatenating strings:</strong> As shown in the example above.</li>
<li><strong>Performing custom aggregations:</strong> <code>reduce()</code> allows for great flexibility in defining how data is combined.</li>
</ul>
<h3 id="comparison-with-other-approaches-loops">Comparison with other approaches (loops)</h3>
<p>While <code>reduce()</code> provides a concise way to perform cumulative operations, it’s not always the most readable or Pythonic approach. Equivalent functionality can often be achieved using loops (or more idiomatically, list comprehensions):</p>
<p><strong>Using a loop:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sum_of_numbers <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> number <span class="kw">in</span> numbers:</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  sum_of_numbers <span class="op">+=</span> number</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sum_of_numbers)  <span class="co"># Output: 15</span></span></code></pre></div>
<p><strong>Using a list comprehension (for summing, not general reduce operations):</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sum_of_numbers <span class="op">=</span> <span class="bu">sum</span>(numbers) <span class="co"># built-in sum() is usually preferred for this specific task</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sum_of_numbers)  <span class="co"># Output: 15</span></span></code></pre></div>
<p>For simple tasks like summing, <code>sum()</code> is typically preferred over <code>reduce()</code>. However, <code>reduce()</code> is more versatile when the cumulative operation is more complex or can’t be easily expressed with built-in functions. Its conciseness can be beneficial for complex aggregations, but readability should always be prioritized. If the operation is simple, a loop or a dedicated function like <code>sum()</code> often results in clearer code.</p>
<h2 id="decorators">Decorators</h2>
<h3 id="concept-of-decorators-in-python">Concept of decorators in Python</h3>
<p>In Python, a decorator is a powerful and expressive way to modify or enhance functions and methods without directly changing their source code. It’s a form of metaprogramming, allowing you to wrap additional functionality around an existing function. Decorators are implemented using functions that take another function as input and return a modified version of that function. This modified function typically adds extra behavior (like logging, timing, or access control) before, after, or around the original function’s execution.</p>
<h3 id="syntax-and-structure-of-decorators">Syntax and structure of decorators</h3>
<p>The basic syntax involves using the <code>@</code> symbol followed by the decorator function name, placed immediately above the function definition:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="at">@my_decorator</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_function():</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... function code ...</span></span></code></pre></div>
<p>This is equivalent to:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_function():</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... function code ...</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>my_function <span class="op">=</span> my_decorator(my_function)</span></code></pre></div>
<p>A decorator function typically takes the function to be decorated as an argument and returns a new function that wraps the original function’s behavior. The <code>wraps</code> decorator from <code>functools</code> is highly recommended to preserve metadata (like docstrings and function names) of the original function.</p>
<h3 id="example-decorators-timing-logging-access-control">Example decorators: timing, logging, access control</h3>
<p><strong>Timing Decorator:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> timing_decorator(func):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> time.time()</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        end_time <span class="op">=</span> time.time()</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Execution time of </span><span class="sc">{</span>func<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>end_time <span class="op">-</span> start_time<span class="sc">:.4f}</span><span class="ss"> seconds"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="at">@timing_decorator</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_slow_function():</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="dv">1</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>my_slow_function()</span></code></pre></div>
<p><strong>Logging Decorator:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> logging_decorator(func):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Calling function: </span><span class="sc">{</span>func<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> with arguments: </span><span class="sc">{</span>args<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>kwargs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        logging.info(<span class="ss">f"Function </span><span class="sc">{</span>func<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> returned: </span><span class="sc">{</span>result<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Setup basic logging</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="at">@logging_decorator</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_function(a, b):</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>my_function(<span class="dv">5</span>, <span class="dv">3</span>)</span></code></pre></div>
<p><strong>Access Control Decorator (simplified example):</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> access_control(func):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> check_access(): <span class="co"># Replace with actual access check</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Access denied!"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_access(): <span class="co"># Placeholder for a real access check</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span> <span class="co"># replace with actual access check logic</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="at">@access_control</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sensitive_function():</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Sensitive data here!"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>sensitive_function()</span></code></pre></div>
<h3 id="nested-decorators">Nested decorators</h3>
<p>Multiple decorators can be applied to a single function:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="at">@timing_decorator</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">@logging_decorator</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_function():</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... function code ...</span></span></code></pre></div>
<p>The decorators are applied from the innermost to the outermost.</p>
<h3 id="decorator-factories">Decorator factories</h3>
<p>Decorator factories are functions that return decorators. They are useful when you need to create decorators with configurable behavior:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> repeat(num_times):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> decorator(func):</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">@wraps</span>(func)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_times):</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> result</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> wrapper</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> decorator</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="at">@repeat</span>(<span class="dv">3</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greet(name):</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>greet(<span class="st">"World"</span>)</span></code></pre></div>
<h3 id="class-decorators">Class decorators</h3>
<p>Class decorators are less common but provide a way to apply decorator logic to classes. They often modify class methods or attributes:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyDecorator:</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, func):</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.func <span class="op">=</span> func</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, <span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Before calling the method"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="va">self</span>.func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"After calling the method"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="at">@MyDecorator</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyClass:</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> my_method(<span class="va">self</span>):</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Inside the method"</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>my_instance <span class="op">=</span> MyClass()</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>my_instance.my_method()</span></code></pre></div>
<p>Note the use of the <code>__call__</code> method to allow the instance to behave like a callable object.</p>
<h2 id="wrappers-and-preserving-function-metadata-wraps">Wrappers and Preserving Function Metadata (<code>wraps</code>)</h2>
<h3 id="understanding-the-importance-of-preserving-metadata">Understanding the importance of preserving metadata</h3>
<p>When you decorate a function in Python, you’re essentially replacing the original function with a wrapper function. This wrapper often adds functionality (e.g., logging, timing, or input validation) before, after, or around the original function’s execution. However, this replacement can lead to the loss of important metadata associated with the original function, such as its name (<code>__name__</code>), docstring (<code>__doc__</code>), and arguments (<code>__annotations__</code>). Losing this metadata makes debugging, introspection, and documentation more difficult. The original function’s identity is effectively obscured.</p>
<h3 id="using-wraps-to-maintain-function-information">Using <code>wraps</code> to maintain function information</h3>
<p>The <code>functools.wraps</code> decorator is designed to solve this problem. It helps preserve the metadata of the original function when it’s wrapped by another function (typically a decorator). It copies essential attributes from the original function to the wrapper function, making it appear as if the original function hasn’t been changed.</p>
<p>The <code>wraps</code> decorator should be applied to the inner wrapper function within your decorator:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_decorator(func):</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func) <span class="co">#This line is crucial</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add extra functionality here...</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add more extra functionality here...</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span></code></pre></div>
<p>By applying <code>@wraps(func)</code>, the metadata from <code>func</code> (the original function) is transferred to the <code>wrapper</code> function.</p>
<h3 id="illustrative-examples-of-metadata-preservation">Illustrative examples of metadata preservation</h3>
<p>Let’s compare a decorator <em>with</em> and <em>without</em> <code>wraps</code>:</p>
<p><strong>Without <code>wraps</code>:</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_decorator(func):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Before function call"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"After function call"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="at">@my_decorator</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> say_hello(name):</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Greets the person passed in as a parameter."""</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(say_hello.<span class="va">__name__</span>)  <span class="co"># Output: wrapper</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(say_hello.__doc__)  <span class="co"># Output: None</span></span></code></pre></div>
<p>Notice that the name and docstring are lost.</p>
<p><strong>With <code>wraps</code>:</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_decorator(func):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Before function call"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"After function call"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="at">@my_decorator</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> say_hello(name):</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Greets the person passed in as a parameter."""</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(say_hello.<span class="va">__name__</span>)  <span class="co"># Output: say_hello</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(say_hello.__doc__)  <span class="co"># Output: Greets the person passed in as a parameter.</span></span></code></pre></div>
<p>Now the metadata is preserved. This is vital for tools that rely on introspection, such as debuggers, documentation generators, and testing frameworks.</p>
<h3 id="advanced-usage-of-wraps">Advanced usage of <code>wraps</code></h3>
<p>While often used implicitly as shown above, you can also use <code>wraps</code> explicitly and pass it additional arguments if you want to update specific metadata. However, such explicit usage is less common. The default behavior of copying over the core metadata is usually sufficient. The <code>wraps</code> function itself does not change the functionality of your decorator but solely improves its metadata management. Therefore, there isn’t a significant amount of “advanced” usage beyond what’s outlined in the preceding examples. The core value lies in consistently using it within all of your decorators to ensure consistent, predictable behavior.</p>
<h2 id="cmp_to_key"><code>cmp_to_key</code></h2>
<h3 id="converting-comparison-functions-to-key-functions">Converting comparison functions to key functions</h3>
<p>Python’s <code>functools.cmp_to_key</code> function is a utility for adapting older-style comparison functions (which return -1, 0, or 1) to the modern key-function-based approach used by sorting functions like <code>sorted()</code> and the <code>list.sort()</code> method. Before Python 3, sorting functions often accepted a <code>cmp</code> argument which was a comparison function. This comparison function took two arguments and returned:</p>
<ul>
<li>-1: if the first argument is less than the second.</li>
<li>0: if the first argument is equal to the second.</li>
<li>1: if the first argument is greater than the second.</li>
</ul>
<p>Modern Python (3.0+) uses key functions instead. A key function takes a single argument and returns a value used for comparison. The <code>cmp_to_key</code> function bridges the gap between these two approaches, enabling you to use older comparison functions with newer sorting methods.</p>
<h3 id="use-cases-for-cmp_to_key">Use cases for <code>cmp_to_key</code></h3>
<p>The primary use case for <code>cmp_to_key</code> is to modernize legacy code that uses comparison functions (<code>cmp</code>). If you have an existing comparison function, you can use <code>cmp_to_key</code> to adapt it to work with functions like <code>sorted()</code> and <code>list.sort()</code>, which expect key functions. This avoids the need for significant code refactoring.</p>
<h3 id="example-scenarios-and-code-demonstrations">Example scenarios and code demonstrations</h3>
<p><strong>Scenario:</strong> You have an old comparison function that compares objects based on a specific criterion:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_objects(obj1, obj2):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> obj1.value <span class="op">&lt;</span> obj2.value:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> obj1.value <span class="op">&gt;</span> obj2.value:</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyObject:</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value):</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.value <span class="op">=</span> value</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>objects <span class="op">=</span> [MyObject(<span class="dv">3</span>), MyObject(<span class="dv">1</span>), MyObject(<span class="dv">2</span>)]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cmp_to_key</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Use the cmp_to_key function to convert the comparison function to a key function</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>sorted_objects <span class="op">=</span> <span class="bu">sorted</span>(objects, key<span class="op">=</span>cmp_to_key(compare_objects))</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> obj <span class="kw">in</span> sorted_objects:</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(obj.value)  <span class="co"># Output: 1 2 3</span></span></code></pre></div>
<p>In this example, <code>cmp_to_key(compare_objects)</code> transforms the <code>compare_objects</code> function into a key function suitable for <code>sorted()</code>. The objects are now sorted according to their <code>value</code> attribute.</p>
<p>Without <code>cmp_to_key</code>, you would have to rewrite <code>compare_objects</code> as a key function, which would be less efficient and introduce unnecessary code duplication if the comparison function is already well tested. <code>cmp_to_key</code> makes the transition cleaner and avoids rewriting existing, potentially complex, comparison logic. It’s a valuable tool for maintaining backward compatibility when updating codebases that relied on older sorting mechanisms.</p>
<h2 id="lru_cache"><code>lru_cache</code></h2>
<h3 id="introduction-to-memoization">Introduction to memoization</h3>
<p>Memoization is an optimization technique that speeds up computer programs by storing the results of expensive function calls and returning the cached result when the same inputs occur again. It’s particularly effective for functions that are computationally intensive and called repeatedly with the same arguments. Instead of recalculating the result every time, the memoized function checks its cache; if the result is already present, it’s returned immediately, saving significant computation time.</p>
<h3 id="using-lru_cache-for-performance-optimization">Using <code>lru_cache</code> for performance optimization</h3>
<p>Python’s <code>functools.lru_cache</code> decorator provides a simple and efficient way to implement memoization. <code>lru</code> stands for “least recently used,” meaning that the cache is limited in size, and when it’s full, the least recently used items are evicted to make room for new entries. This ensures that the cache doesn’t grow indefinitely, consuming excessive memory.</p>
<p>Applying <code>lru_cache</code> is straightforward:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> lru_cache</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="at">@lru_cache</span>(maxsize<span class="op">=</span><span class="va">None</span>) <span class="co"># maxsize=None means no limit</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expensive_function(arg1, arg2):</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ... computationally expensive operations ...</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result</span></code></pre></div>
<p>The <code>maxsize</code> parameter controls the cache size. <code>maxsize=None</code> indicates an unlimited cache (limited only by available memory). Smaller values of <code>maxsize</code> (e.g., 128 or 256) impose a limit, balancing memory usage and performance.</p>
<h3 id="understanding-cache-size-and-parameters">Understanding cache size and parameters</h3>
<p>The <code>maxsize</code> parameter is crucial for managing memory usage. Choosing an appropriate size depends on your function’s characteristics and available resources. A larger <code>maxsize</code> generally leads to better performance if your function is called with many different arguments. However, setting <code>maxsize</code> too high may lead to excessive memory consumption.</p>
<p>The <code>typed</code> parameter (added in Python 3.8) allows for separate caching based on the data types of the inputs. Setting <code>typed=True</code> means that <code>expensive_function(1, 2)</code> and <code>expensive_function(1.0, 2.0)</code> will be cached separately, even though the values are numerically equivalent. This is useful if the function’s behavior genuinely depends on input type.</p>
<h3 id="example-use-cases-fibonacci-sequence-recursive-functions">Example use cases: Fibonacci sequence, recursive functions</h3>
<p><strong>Fibonacci Sequence:</strong> The Fibonacci sequence is a classic example where memoization significantly improves performance. A naive recursive implementation is extremely slow for larger numbers because it recalculates many values multiple times:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> lru_cache</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">@lru_cache</span>(maxsize<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci(n):</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">&lt;</span> <span class="dv">2</span>:</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> n</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fibonacci(n<span class="op">-</span><span class="dv">1</span>) <span class="op">+</span> fibonacci(n<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fibonacci(<span class="dv">35</span>)) <span class="co"># This will be much faster with lru_cache</span></span></code></pre></div>
<p><strong>Recursive Functions:</strong> Any recursive function that repeatedly calls itself with the same arguments can benefit from memoization. <code>lru_cache</code> can drastically reduce execution time by avoiding redundant recursive calls. You should ensure the recursive function is designed to terminate and handle edge cases correctly, as the <code>lru_cache</code> will not fix inherent issues in algorithm correctness.</p>
<h2 id="singledispatch"><code>singledispatch</code></h2>
<h3 id="introduction-to-single-dispatch-generic-functions">Introduction to single dispatch generic functions</h3>
<p>Single dispatch generic functions allow you to define a function that behaves differently depending on the type of its first argument. This is a powerful technique for creating functions that handle various data types gracefully without resorting to extensive <code>if</code>/<code>elif</code> chains or complex type checking logic. Instead of writing separate functions for each type, you write a single generic function and register specialized implementations for specific types.</p>
<h3 id="defining-generic-functions-with-singledispatch">Defining generic functions with <code>singledispatch</code></h3>
<p>The <code>functools.singledispatch</code> decorator is used to create single dispatch generic functions. You decorate a function to make it the default implementation. Then, you register specialized functions for particular argument types.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> singledispatch</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="at">@singledispatch</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> handle_data(data):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Default implementation for handling data."""</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Handling data of unknown type: </span><span class="sc">{</span><span class="bu">type</span>(data)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="at">@handle_data.register</span>(<span class="bu">int</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _(data):</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Specialized implementation for integers."""</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Handling integer: </span><span class="sc">{</span>data<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="at">@handle_data.register</span>(<span class="bu">str</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _(data):</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Specialized implementation for strings."""</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Handling string: </span><span class="sc">{</span>data<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data.upper()</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(handle_data(<span class="dv">10</span>))      <span class="co"># Output: Handling integer: 10, 20</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(handle_data(<span class="st">"hello"</span>)) <span class="co"># Output: Handling string: hello, HELLO</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(handle_data([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])) <span class="co"># Output: Handling data of unknown type: &lt;class 'list'&gt;, [1, 2, 3]</span></span></code></pre></div>
<h3 id="registering-different-implementations-for-different-types">Registering different implementations for different types</h3>
<p>The <code>register()</code> method of the <code>singledispatch</code>-decorated function is used to add specialized implementations. You pass the type as an argument to <code>register()</code> and provide the specialized function. The <code>_</code> is often used as the name of these specialized functions as they’re usually short and do not require descriptive naming.</p>
<p>You can register implementations for multiple types:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="at">@handle_data.register</span>(<span class="bu">list</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _(data):</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Specialized implementation for lists."""</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Handling list: </span><span class="sc">{</span>data<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [x <span class="op">*</span> <span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> data]</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(handle_data([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))  <span class="co"># Output: Handling list: [1, 2, 3], [2, 4, 6]</span></span></code></pre></div>
<h3 id="example-use-cases-handling-different-data-types-gracefully">Example use cases: handling different data types gracefully</h3>
<p>Single dispatch is ideal when you have a function that needs to operate on various data types, but the operation differs slightly depending on the type. Common scenarios include:</p>
<ul>
<li><strong>Data serialization/deserialization:</strong> Different data structures may require distinct serialization methods.</li>
<li><strong>Data validation:</strong> You may want to apply type-specific validation rules.</li>
<li><strong>Data transformation:</strong> The transformation method could vary based on the data type.</li>
<li><strong>Custom operator overloading:</strong> You can define how a custom class interacts with built-in operators (+, -, *, etc.) based on the type of the other operand.</li>
</ul>
<p>Single dispatch provides a cleaner and more maintainable alternative to using lengthy <code>if</code>/<code>elif</code> blocks or complex <code>isinstance</code> checks, improving code readability and extensibility. It promotes a more functional and type-safe approach to handling diverse data types within a single function.</p>
<h2 id="total_ordering"><code>total_ordering</code></h2>
<h3 id="implementing-total-ordering-with-minimal-effort">Implementing total ordering with minimal effort</h3>
<p>Python’s <code>functools.total_ordering</code> is a class decorator that significantly simplifies the implementation of total ordering for custom classes. Total ordering means that all six comparison operators (<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>) are defined for a class. Without <code>total_ordering</code>, you would have to explicitly define all six comparison methods (<code>__lt__</code>, <code>__le__</code>, <code>__gt__</code>, <code>__ge__</code>, <code>__eq__</code>, <code>__ne__</code>). This can be tedious and error-prone. <code>total_ordering</code> allows you to define only a subset of these methods (at least one of <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, or <code>&gt;=</code> plus <code>__eq__</code> ), and it automatically generates the remaining methods.</p>
<h3 id="understanding-the-implications-of-total-ordering">Understanding the implications of total ordering</h3>
<p>Total ordering is essential for many operations that rely on comparisons, such as sorting (<code>sorted()</code>), using objects in sets, or employing them as keys in dictionaries. If a class lacks total ordering, these operations may not work correctly or raise exceptions. It ensures that comparisons are consistent and transitive (if a &lt; b and b &lt; c, then a &lt; c).</p>
<h3 id="use-cases-for-total_ordering">Use cases for <code>total_ordering</code></h3>
<p><code>total_ordering</code> is particularly useful when creating custom classes that need to be compared. Common scenarios include:</p>
<ul>
<li><strong>Custom data structures:</strong> When you need to sort or compare instances of your custom classes.</li>
<li><strong>Priority queues:</strong> Elements in a priority queue must be comparable.</li>
<li><strong>Sets and dictionaries:</strong> Objects used as keys must have well-defined ordering.</li>
<li><strong>GUI elements:</strong> GUI frameworks often rely on comparison for arranging elements.</li>
</ul>
<h3 id="example-scenarios-and-code-demonstrations-1">Example scenarios and code demonstrations</h3>
<p><strong>Without <code>total_ordering</code>:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyObject:</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.value <span class="op">=</span> value</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">==</span> other.value</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__lt__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;</span> other.value</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__le__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;=</span> other.value</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__gt__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;</span> other.value</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__ge__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;=</span> other.value</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__ne__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">!=</span> other.value</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>objects <span class="op">=</span> [MyObject(<span class="dv">3</span>), MyObject(<span class="dv">1</span>), MyObject(<span class="dv">2</span>)]</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>sorted_objects <span class="op">=</span> <span class="bu">sorted</span>(objects)  <span class="co"># Works correctly but requires all six methods</span></span></code></pre></div>
<p>Notice how defining all six methods is required. This is repetitive and can increase maintenance costs.</p>
<p><strong>With <code>total_ordering</code>:</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> total_ordering</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="at">@total_ordering</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyObject:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.value <span class="op">=</span> value</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">==</span> other.value</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__lt__</span>(<span class="va">self</span>, other):</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;</span> other.value</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>objects <span class="op">=</span> [MyObject(<span class="dv">3</span>), MyObject(<span class="dv">1</span>), MyObject(<span class="dv">2</span>)]</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>sorted_objects <span class="op">=</span> <span class="bu">sorted</span>(objects) <span class="co"># Works correctly with only __eq__ and __lt__ defined</span></span></code></pre></div>
<p>Now, only <code>__eq__</code> and <code>__lt__</code> are explicitly defined; <code>total_ordering</code> automatically generates the remaining comparison methods, reducing code complexity and potential errors. This significantly improves code maintainability and readability, especially for classes with complex comparison logic.</p>
<h2 id="advanced-techniques-and-best-practices">Advanced Techniques and Best Practices</h2>
<h3 id="combining-multiple-decorators">Combining multiple decorators</h3>
<p>Multiple decorators can be applied to a single function by stacking them above the function definition:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> wraps</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_decorator_1(func):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Decorator 1: Before"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Decorator 1: After"</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_decorator_2(func):</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">@wraps</span>(func)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Decorator 2: Before"</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Decorator 2: After"</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrapper</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="at">@my_decorator_1</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="at">@my_decorator_2</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_function():</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Inside my_function"</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>my_function()</span></code></pre></div>
<p>The decorators are executed in the order they are listed (from top to bottom). In this example, <code>my_decorator_2</code> wraps <code>my_function</code>, and then <code>my_decorator_1</code> wraps the result of that.</p>
<h3 id="debugging-and-troubleshooting-decorators">Debugging and troubleshooting decorators</h3>
<p>Debugging decorators can be challenging due to the layered nature of the wrapper functions. Use a debugger (like pdb) to step through the execution flow. Pay close attention to the order of execution and the arguments passed to each wrapper.</p>
<p>Thoroughly test your decorators with various inputs and edge cases. Check that the original function’s metadata is correctly preserved using <code>functools.wraps</code>. If you’re encountering unexpected behavior, logging statements within each wrapper function can help pinpoint the source of the problem. Consider using <code>inspect.signature()</code> to examine the function signatures of your wrapped functions to ensure that parameters are handled as expected.</p>
<h3 id="performance-considerations">Performance considerations</h3>
<p>While decorators enhance functionality, they can introduce performance overhead, especially if the added logic is computationally intensive. For performance-critical sections of code, carefully consider the trade-off between functionality and speed. Profiling tools can help identify performance bottlenecks caused by decorators. Minimize unnecessary operations within your decorator functions and optimize the added logic as much as possible.</p>
<h3 id="choosing-the-right-functools-tool-for-the-job">Choosing the right <code>functools</code> tool for the job</h3>
<p>The <code>functools</code> module offers a range of tools, and selecting the appropriate one depends on the specific task:</p>
<ul>
<li><strong><code>lru_cache</code>:</strong> Use for memoizing expensive function calls.</li>
<li><strong><code>partial</code>:</strong> Use to create partially applied functions, simplifying calls with many arguments.</li>
<li><strong><code>wraps</code>:</strong> Always use with custom decorators to preserve function metadata.</li>
<li><strong><code>singledispatch</code>:</strong> Use for creating generic functions that handle different data types.</li>
<li><strong><code>total_ordering</code>:</strong> Use to simplify the implementation of total ordering for custom classes.</li>
<li><strong><code>reduce</code>:</strong> Use for cumulative operations (though often list comprehensions or <code>sum()</code> are more Pythonic).</li>
<li><strong><code>cmp_to_key</code>:</strong> Use to adapt old-style comparison functions to modern key functions.</li>
</ul>
<p>Understanding the strengths and limitations of each tool will help you write efficient and maintainable code. Favor clear, readable solutions over overly clever or concise code that sacrifices maintainability. Choose the simplest tool that effectively accomplishes your task.</p>
<h2 id="appendix-additional-resources-and-further-learning">Appendix: Additional Resources and Further Learning</h2>
<h3 id="links-to-relevant-documentation-and-tutorials">Links to relevant documentation and tutorials</h3>
<ul>
<li><p><strong>Official Python Documentation:</strong> The official Python documentation provides comprehensive information on the <code>functools</code> module: <a href="https://docs.python.org/3/library/functools.html">https://docs.python.org/3/library/functools.html</a> This is the primary source of truth for understanding the module’s functionality and API.</p></li>
<li><p><strong>Real Python Tutorials:</strong> Real Python offers high-quality tutorials on various Python concepts, including functional programming and decorators, which are relevant to using <code>functools</code> effectively: <a href="https://realpython.com/">https://realpython.com/</a> (Search for relevant tutorials on their site).</p></li>
<li><p><strong>Other Online Tutorials:</strong> Many other websites and blogs offer tutorials and explanations of <code>functools</code> and related functional programming concepts. A web search for “Python functools tutorial” will yield numerous results.</p></li>
</ul>
<h3 id="suggested-readings-and-books">Suggested readings and books</h3>
<ul>
<li><p><strong>Fluent Python by Luciano Ramalho:</strong> This book provides an in-depth exploration of Python’s features, including a substantial section dedicated to functional programming and techniques that leverage <code>functools</code>.</p></li>
<li><p><strong>Python Cookbook by David Beazley and Brian K. Jones:</strong> This cookbook-style resource contains recipes and solutions that often utilize <code>functools</code> for concise and effective implementations.</p></li>
<li><p><strong>Effective Python by Brett Slatkin:</strong> This book focuses on best practices and effective coding styles in Python. Many of the suggestions align with the efficient and readable use of <code>functools</code> tools.</p></li>
</ul>
<h3 id="community-forums-and-support-groups">Community forums and support groups</h3>
<ul>
<li><p><strong>Stack Overflow:</strong> Stack Overflow is a valuable resource for finding answers to specific questions and troubleshooting issues related to <code>functools</code>. Search for relevant keywords (“Python functools,” specific function names like “lru_cache,” etc.).</p></li>
<li><p><strong>Python’s Official Mailing Lists:</strong> Python’s official mailing lists (python-list, python-tutor, etc.) can be helpful for engaging with the broader Python community and seeking assistance with complex problems.</p></li>
<li><p><strong>Python Discord Servers:</strong> Numerous Discord servers dedicated to Python programming offer channels where you can ask questions and get help from other Python developers. Search online for “Python Discord” to find relevant servers.</p></li>
</ul>
<p>Remember to always check the date and relevance of any online resource you find, as Python and its libraries constantly evolve. Prioritize official documentation and reputable sources like Real Python and well-reviewed books when learning about <code>functools</code>.</p>


<footer>Copyright 2025 - Muthukrishnan</footer>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3609399560636561" crossorigin="anonymous"></script>




</body></html>